

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="zh-CN" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="zh-CN" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Nextflow 脚本语言 &mdash; Nextflow-ZH-documentation 0.0.1 文档</title>
  

  
  
  
  

  
  <script type="text/javascript" src="../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script type="text/javascript" src="../_static/jquery.js"></script>
        <script type="text/javascript" src="../_static/underscore.js"></script>
        <script type="text/javascript" src="../_static/doctools.js"></script>
        <script type="text/javascript" src="../_static/language_data.js"></script>
        <script type="text/javascript" src="../_static/translations.js"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="index" title="索引" href="../genindex.html" />
    <link rel="search" title="搜索" href="../search.html" />
    <link rel="next" title="Processes" href="process.html" />
    <link rel="prev" title="基本理念" href="basic.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html" class="icon icon-home"> Nextflow-ZH-documentation
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="getstarted.html">开始</a></li>
<li class="toctree-l1"><a class="reference internal" href="basic.html">基本理念</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Nextflow 脚本语言</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#id1">语言基础知识</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#hello-world">Hello world</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id2">变量</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id3">列表</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id4">映射</a></li>
<li class="toctree-l3"><a class="reference internal" href="#script-multiple-assignment">多重赋值</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id6">条件执行</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id7">字符串</a></li>
<li class="toctree-l3"><a class="reference internal" href="#string-interpolation">字符串插值</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id9">多行字符串</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#script-closure">闭包</a></li>
<li class="toctree-l2"><a class="reference internal" href="#script-regexp">正则表达式</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#id12">字符串替换</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id13">捕获组</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id14">删除字符串的一部分</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#i-o">文件 和 I/O</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#id15">基本的读/写</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id16">逐行读取文件</a></li>
<li class="toctree-l3"><a class="reference internal" href="#advanced-file-reading-operations">Advanced file reading operations</a></li>
<li class="toctree-l3"><a class="reference internal" href="#advanced-file-writing-operations">Advanced file writing operations</a></li>
<li class="toctree-l3"><a class="reference internal" href="#list-directory-content">List directory content</a></li>
<li class="toctree-l3"><a class="reference internal" href="#create-directories">Create directories</a></li>
<li class="toctree-l3"><a class="reference internal" href="#create-links">Create links</a></li>
<li class="toctree-l3"><a class="reference internal" href="#copy-files">Copy files</a></li>
<li class="toctree-l3"><a class="reference internal" href="#move-files">Move files</a></li>
<li class="toctree-l3"><a class="reference internal" href="#rename-files">Rename files</a></li>
<li class="toctree-l3"><a class="reference internal" href="#delete-files">Delete files</a></li>
<li class="toctree-l3"><a class="reference internal" href="#check-file-attributes">Check file attributes</a></li>
<li class="toctree-l3"><a class="reference internal" href="#get-and-modify-file-permissions">Get and modify file permissions</a></li>
<li class="toctree-l3"><a class="reference internal" href="#http-ftp-files">HTTP/FTP files</a></li>
<li class="toctree-l3"><a class="reference internal" href="#counting-records">Counting records</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#countlines">countLines</a></li>
<li class="toctree-l4"><a class="reference internal" href="#countfasta">countFasta</a></li>
<li class="toctree-l4"><a class="reference internal" href="#countfastq">countFastq</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="process.html">Processes</a></li>
<li class="toctree-l1"><a class="reference internal" href="channel.html">Channels</a></li>
<li class="toctree-l1"><a class="reference internal" href="operator.html">Operators</a></li>
<li class="toctree-l1"><a class="reference internal" href="executor.html">Executors</a></li>
<li class="toctree-l1"><a class="reference internal" href="config.html">Configuration</a></li>
<li class="toctree-l1"><a class="reference internal" href="awscloud.html">Amazon Cloud</a></li>
<li class="toctree-l1"><a class="reference internal" href="amazons3.html">Amazon S3 storage</a></li>
<li class="toctree-l1"><a class="reference internal" href="google.html">Google Cloud</a></li>
<li class="toctree-l1"><a class="reference internal" href="conda.html">Conda environments</a></li>
<li class="toctree-l1"><a class="reference internal" href="docker.html">Docker containers</a></li>
<li class="toctree-l1"><a class="reference internal" href="singularity.html">Singularity containers</a></li>
<li class="toctree-l1"><a class="reference internal" href="ignite.html">Apache Ignite</a></li>
<li class="toctree-l1"><a class="reference internal" href="kubernetes.html">Kubernetes</a></li>
<li class="toctree-l1"><a class="reference internal" href="tracing.html">Tracing &amp; visualisation</a></li>
<li class="toctree-l1"><a class="reference internal" href="sharing.html">Pipeline sharing</a></li>
<li class="toctree-l1"><a class="reference internal" href="metadata.html">Workflow introspection</a></li>
<li class="toctree-l1"><a class="reference internal" href="mail.html">Mail &amp; Notifications</a></li>
<li class="toctree-l1"><a class="reference internal" href="example.html">Examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="faq.html">FAQ</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Nextflow-ZH-documentation</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html">Docs</a> &raquo;</li>
        
      <li>Nextflow 脚本语言</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/doc/script.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="nextflow">
<span id="script-page"></span><h1>Nextflow 脚本语言<a class="headerlink" href="#nextflow" title="永久链接至标题">¶</a></h1>
<p>Nextflow脚本语言是Groovy编程语言的扩展. Groovy是一种用于Java虚拟机的强大编程语言. Nextflow语法被专门用于简化以声明方式编写计算管道.</p>
<p>Nextflow可以执行任何一段Groovy代码或使用任何用于JVM平台的库.</p>
<p>有关Groovy编程语言的详细描述，请参考这些链接:</p>
<ul class="simple">
<li><a class="reference external" href="http://groovy-lang.org/documentation.html">Groovy User Guide</a></li>
<li><a class="reference external" href="http://refcardz.dzone.com/refcardz/groovy">Groovy Cheat sheet</a></li>
<li><a class="reference external" href="http://www.manning.com/koenig2/">Groovy in Action</a></li>
</ul>
<p>下面您可以找到Nextflow脚本语言中使用的最重要的语言构造的速成课程.</p>
<div class="admonition warning">
<p class="first admonition-title">警告</p>
<p class="last">Nextflow使用 <code class="docutils literal notranslate"><span class="pre">UTF-8</span></code> 作为源文件和应用程序文件的默认文件字符编码。使用您最喜欢的文本编辑器编辑Nextflow脚本时，请确保使用 <code class="docutils literal notranslate"><span class="pre">UTF-8</span></code> 编码.</p>
</div>
<div class="section" id="id1">
<h2>语言基础知识<a class="headerlink" href="#id1" title="永久链接至标题">¶</a></h2>
<div class="section" id="hello-world">
<h3>Hello world<a class="headerlink" href="#hello-world" title="永久链接至标题">¶</a></h3>
<p>打印一些东西可以简单的使用 <code class="docutils literal notranslate"><span class="pre">print</span></code> 或 <code class="docutils literal notranslate"><span class="pre">println</span></code> 方法之一。</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">println</span> <span class="s2">&quot;Hello, World!&quot;</span>
</pre></div>
</div>
<p>两者之间的唯一区别是println方法隐式地向打印的字符串追加一个`new line` character.</p>
</div>
<div class="section" id="id2">
<h3>变量<a class="headerlink" href="#id2" title="永久链接至标题">¶</a></h3>
<p>要定义一个变量，只需给它赋一个值:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">x</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">println</span> <span class="n">x</span>

<span class="n">x</span> <span class="o">=</span> <span class="n">new</span> <span class="n">java</span><span class="o">.</span><span class="n">util</span><span class="o">.</span><span class="n">Date</span><span class="p">()</span>
<span class="n">println</span> <span class="n">x</span>

<span class="n">x</span> <span class="o">=</span> <span class="o">-</span><span class="mf">3.1499392</span>
<span class="n">println</span> <span class="n">x</span>

<span class="n">x</span> <span class="o">=</span> <span class="n">false</span>
<span class="n">println</span> <span class="n">x</span>

<span class="n">x</span> <span class="o">=</span> <span class="s2">&quot;Hi&quot;</span>
<span class="n">println</span> <span class="n">x</span>
</pre></div>
</div>
</div>
<div class="section" id="id3">
<h3>列表<a class="headerlink" href="#id3" title="永久链接至标题">¶</a></h3>
<p>列表对象可以通过将列表项放在方括号中来定义:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">myList</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1776</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">33</span><span class="p">,</span> <span class="mi">99</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">928734928763</span><span class="p">]</span>
</pre></div>
</div>
<p>您可以使用方括号符号访问列表中的给定项(索引从0开始):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">println</span> <span class="n">myList</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
<p>想要获得列表的长度，可以使用size方法:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">println</span> <span class="n">myList</span><span class="o">.</span><span class="n">size</span><span class="p">()</span>
</pre></div>
</div>
<p>了解更多关于列表的信息:</p>
<ul class="simple">
<li><a class="reference external" href="http://groovy-lang.org/groovy-dev-kit.html#Collections-Lists">Groovy Lists tutorial</a></li>
<li><a class="reference external" href="http://docs.groovy-lang.org/latest/html/groovy-jdk/java/util/List.html">Groovy List SDK</a></li>
<li><a class="reference external" href="http://docs.oracle.com/javase/7/docs/api/java/util/List.html">Java List SDK</a></li>
</ul>
</div>
<div class="section" id="id4">
<h3>映射<a class="headerlink" href="#id4" title="永久链接至标题">¶</a></h3>
<p>映射用于存储关联数组或字典. 它们是异构的、命名的数据的无序集合:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">scores</span> <span class="o">=</span> <span class="p">[</span> <span class="s2">&quot;Brett&quot;</span><span class="p">:</span><span class="mi">100</span><span class="p">,</span> <span class="s2">&quot;Pete&quot;</span><span class="p">:</span><span class="s2">&quot;Did not finish&quot;</span><span class="p">,</span> <span class="s2">&quot;Andrew&quot;</span><span class="p">:</span><span class="mf">86.87934</span> <span class="p">]</span>
</pre></div>
</div>
<dl class="docutils">
<dt>请注意，映射中存储的每个值都可以是不同的类型. <code class="docutils literal notranslate"><span class="pre">Brett</span></code> 是整数, <code class="docutils literal notranslate"><span class="pre">Pete</span></code> 是字符串,而</dt>
<dd><code class="docutils literal notranslate"><span class="pre">Andrew</span></code> 是浮点数.</dd>
</dl>
<p>我们可以通过两种主要方式访问映射中的值:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">println</span> <span class="n">scores</span><span class="p">[</span><span class="s2">&quot;Pete&quot;</span><span class="p">]</span>
<span class="n">println</span> <span class="n">scores</span><span class="o">.</span><span class="n">Pete</span>
</pre></div>
</div>
<p>要向映射添加数据或修改映射，语法类似于向list添加值:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">scores</span><span class="p">[</span><span class="s2">&quot;Pete&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">3</span>
<span class="n">scores</span><span class="p">[</span><span class="s2">&quot;Cedric&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">120</span>
</pre></div>
</div>
<p>了解更多关于映射:</p>
<ul class="simple">
<li><a class="reference external" href="http://groovy-lang.org/groovy-dev-kit.html#Collections-Maps">Groovy Maps tutorial</a></li>
<li><a class="reference external" href="http://docs.groovy-lang.org/latest/html/groovy-jdk/java/util/Map.html">Groovy Map SDK</a></li>
<li><a class="reference external" href="http://docs.oracle.com/javase/7/docs/api/java/util/Map.html">Java Map SDK</a></li>
</ul>
</div>
<div class="section" id="script-multiple-assignment">
<span id="id5"></span><h3>多重赋值<a class="headerlink" href="#script-multiple-assignment" title="永久链接至标题">¶</a></h3>
<p>数组或列表对象可用于一次分配多个变量:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">)</span> <span class="o">=</span> <span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="s1">&#39;foo&#39;</span><span class="p">]</span>
<span class="k">assert</span> <span class="n">a</span> <span class="o">==</span> <span class="mi">10</span> <span class="o">&amp;&amp;</span> <span class="n">b</span> <span class="o">==</span> <span class="mi">20</span> <span class="o">&amp;&amp;</span> <span class="n">c</span> <span class="o">==</span> <span class="s1">&#39;foo&#39;</span>
</pre></div>
</div>
<p>赋值运算符左侧的三个变量由列表中相应的项初始化.</p>
<p>Read more about <a class="reference external" href="http://www.groovy-lang.org/semantics.html#_multiple_assignment">Multiple assignment</a> in the Groovy documentation.</p>
</div>
<div class="section" id="id6">
<h3>条件执行<a class="headerlink" href="#id6" title="永久链接至标题">¶</a></h3>
<p>任何编程语言最重要的特性之一都是能够在不同的条件下执行不同的代码. 最简单的方法是使用if构造:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">x</span> <span class="o">=</span> <span class="n">Math</span><span class="o">.</span><span class="n">random</span><span class="p">()</span>
<span class="k">if</span><span class="p">(</span> <span class="n">x</span> <span class="o">&lt;</span> <span class="mf">0.5</span> <span class="p">)</span> <span class="p">{</span>
    <span class="n">println</span> <span class="s2">&quot;You lost.&quot;</span>
<span class="p">}</span>
<span class="k">else</span> <span class="p">{</span>
    <span class="n">println</span> <span class="s2">&quot;You won!&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="id7">
<h3>字符串<a class="headerlink" href="#id7" title="永久链接至标题">¶</a></h3>
<p>字符串可以定义为用单引号或双引号( <code class="docutils literal notranslate"><span class="pre">'</span></code> 或 <code class="docutils literal notranslate"><span class="pre">&quot;</span></code> 字符)包围的文本:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">println</span> <span class="s2">&quot;he said &#39;cheese&#39; once&quot;</span>
<span class="n">println</span> <span class="s1">&#39;he said &quot;cheese!&quot; again&#39;</span>
</pre></div>
</div>
<p>字符串可以用 <code class="docutils literal notranslate"><span class="pre">+</span></code> 连接:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">a</span> <span class="o">=</span> <span class="s2">&quot;world&quot;</span>
<span class="nb">print</span> <span class="s2">&quot;hello &quot;</span> <span class="o">+</span> <span class="n">a</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span>
</pre></div>
</div>
</div>
<div class="section" id="string-interpolation">
<span id="id8"></span><h3>字符串插值<a class="headerlink" href="#string-interpolation" title="永久链接至标题">¶</a></h3>
<p>单引号和双引号字符串之间有一个重要的区别: 双引号字符串支持变量插值，而单引号字符串不支持.</p>
<p>实际上，双引号字符串可以包含任意变量的值，方法是在其名称前面加上 <code class="docutils literal notranslate"><span class="pre">$</span></code> 字符，或者使用 <code class="docutils literal notranslate"><span class="pre">${expression}</span></code> 语法(类似于Bash/shell脚本)来包含任何表达式的值:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">foxtype</span> <span class="o">=</span> <span class="s1">&#39;quick&#39;</span>
<span class="n">foxcolor</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">,</span> <span class="s1">&#39;n&#39;</span><span class="p">]</span>
<span class="n">println</span> <span class="s2">&quot;The $foxtype ${foxcolor.join()} fox&quot;</span>

<span class="n">x</span> <span class="o">=</span> <span class="s1">&#39;Hello&#39;</span>
<span class="n">println</span> <span class="s1">&#39;$x + $y&#39;</span>
</pre></div>
</div>
<p>这段代码打印:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>The quick brown fox
$x + $y
</pre></div>
</div>
</div>
<div class="section" id="id9">
<h3>多行字符串<a class="headerlink" href="#id9" title="永久链接至标题">¶</a></h3>
<p>可以通过使用三重单引号或双引号来分隔跨越多行的文本块:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">text</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span>
<span class="s2">    hello there James</span>
<span class="s2">    how are you today?</span>
<span class="s2">    &quot;&quot;&quot;</span>
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">注解</p>
<p class="last">像前面一样，双引号内的多行字符串支持变量插值，而单引号内的多行字符串不支持.</p>
</div>
<p>和在Bash/shell脚本中一样，用 <code class="docutils literal notranslate"><span class="pre">\</span></code> 字符在多行字符串中结束一行可以防止新行字符将该行与下面的行分隔开来:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">myLongCmdline</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot; blastp </span><span class="se">\</span>
<span class="s2">                -in $input_query </span><span class="se">\</span>
<span class="s2">                -out $output_file </span><span class="se">\</span>
<span class="s2">                -db $blast_database </span><span class="se">\</span>
<span class="s2">                -html</span>
<span class="s2">                &quot;&quot;&quot;</span>

<span class="n">result</span> <span class="o">=</span> <span class="n">myLongCmdline</span><span class="o">.</span><span class="n">execute</span><span class="p">()</span><span class="o">.</span><span class="n">text</span>
</pre></div>
</div>
<p>在前面的示例中, <code class="docutils literal notranslate"><span class="pre">blastp</span></code> 及其 <code class="docutils literal notranslate"><span class="pre">In</span></code> 、 <code class="docutils literal notranslate"><span class="pre">out</span></code> 、 <code class="docutils literal notranslate"><span class="pre">-db</span></code> 和 <code class="docutils literal notranslate"><span class="pre">-html</span></code> 开关及其参数实际上是一行.</p>
</div>
</div>
<div class="section" id="script-closure">
<span id="id10"></span><h2>闭包<a class="headerlink" href="#script-closure" title="永久链接至标题">¶</a></h2>
<p>简单地说,一个闭包就是一个代码块,可以作为参数传递给一个函数。因此，您可以定义一段代码，然后像传递字符串或整数一样传递它。</p>
<p>更正式地说，您可以创建定义为第一类对象的函数.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">square</span> <span class="o">=</span> <span class="p">{</span> <span class="n">it</span> <span class="o">*</span> <span class="n">it</span> <span class="p">}</span>
</pre></div>
</div>
<p>表达式 <code class="docutils literal notranslate"><span class="pre">it</span> <span class="pre">*</span> <span class="pre">it</span></code> 周围的大括号告诉脚本解释器将该表达式视为代码. <code class="docutils literal notranslate"><span class="pre">it</span></code> 标识符是一个隐式变量，表示在调用函数时传递给函数的值.</p>
<p>一旦编译了函数对象，就会被赋值给变量 <code class="docutils literal notranslate"><span class="pre">square</span></code> ，就像之前的其他变量赋值一样。现在我们可以这样做:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">println</span> <span class="n">square</span><span class="p">(</span><span class="mi">9</span><span class="p">)</span>
</pre></div>
</div>
<p>并得到值81.</p>
<p>这并不十分有趣，直到我们发现可以将函数 <code class="docutils literal notranslate"><span class="pre">square</span></code> 作为参数传递给其他函数或方法. 有一些内建函数就将像这样的函数作为参数. 列表上的 <code class="docutils literal notranslate"><span class="pre">collect</span></code> 方法就是一个例子:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span> <span class="p">]</span><span class="o">.</span><span class="n">collect</span><span class="p">(</span><span class="n">square</span><span class="p">)</span>
</pre></div>
</div>
<p>这个表达式表示:创建一个值为1、2、3和4的数组，然后调用它的 <code class="docutils literal notranslate"><span class="pre">collect</span></code> 方法，传入我们在上面定义的闭包. <code class="docutils literal notranslate"><span class="pre">collect</span></code> 方法遍历数组中的每个项，调用该项的闭包，然后将结果放入一个新数组中，结果为:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">16</span> <span class="p">]</span>
</pre></div>
</div>
<p>有关更多可以调用“闭包”作为参数的方法，请参见 <a class="reference external" href="http://docs.groovy-lang.org/latest/html/groovy-jdk/">Groovy GDK 文档</a>.</p>
<p>默认情况下，闭包接受一个名为 <code class="docutils literal notranslate"><span class="pre">it</span></code> 的参数，但是您也可以使用多个自定义命名的参数创建闭包. 例如， <code class="docutils literal notranslate"><span class="pre">Map.each()</span></code> 方法可以接受一个带有两个参数的闭包，它将键和映射中每个键-值对的关联值绑定到该闭包. 这里，我们在闭包中使用了明显的变量名 <code class="docutils literal notranslate"><span class="pre">key</span></code> 和 <code class="docutils literal notranslate"><span class="pre">value</span></code></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">printMapClosure</span> <span class="o">=</span> <span class="p">{</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="o">-&gt;</span>
    <span class="n">println</span> <span class="s2">&quot;$key = $value&quot;</span>
<span class="p">}</span>

<span class="p">[</span> <span class="s2">&quot;Yue&quot;</span> <span class="p">:</span> <span class="s2">&quot;Wu&quot;</span><span class="p">,</span> <span class="s2">&quot;Mark&quot;</span> <span class="p">:</span> <span class="s2">&quot;Williams&quot;</span><span class="p">,</span> <span class="s2">&quot;Sudha&quot;</span> <span class="p">:</span> <span class="s2">&quot;Kumari&quot;</span> <span class="p">]</span><span class="o">.</span><span class="n">each</span><span class="p">(</span><span class="n">printMapClosure</span><span class="p">)</span>
</pre></div>
</div>
<p>Prints:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Yue</span><span class="o">=</span><span class="n">Wu</span>
<span class="n">Mark</span><span class="o">=</span><span class="n">Williams</span>
<span class="n">Sudha</span><span class="o">=</span><span class="n">Kumari</span>
</pre></div>
</div>
<p>闭包还有另外两个重要的特性。首先，它可以访问定义它的作用域中的变量，以便与它们交互。</p>
<p>其次，可以以匿名的方式定义闭包，这意味着它没有给定名称，而是在需要使用它的地方定义.</p>
<p>作为展示这两个特性的示例，请参见下面的代码片段:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">myMap</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;China&quot;</span><span class="p">:</span> <span class="mi">1</span> <span class="p">,</span> <span class="s2">&quot;India&quot;</span> <span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="s2">&quot;USA&quot;</span> <span class="p">:</span> <span class="mi">3</span><span class="p">]</span>

<span class="n">result</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">myMap</span><span class="o">.</span><span class="n">keySet</span><span class="p">()</span><span class="o">.</span><span class="n">each</span><span class="p">(</span> <span class="p">{</span> <span class="n">result</span><span class="o">+=</span> <span class="n">myMap</span><span class="p">[</span><span class="n">it</span><span class="p">]</span> <span class="p">}</span> <span class="p">)</span>

<span class="n">println</span> <span class="n">result</span>
</pre></div>
</div>
<p>Learn more about closures in the <a class="reference external" href="http://groovy-lang.org/closures.html">Groovy documentation</a></p>
</div>
<div class="section" id="script-regexp">
<span id="id11"></span><h2>正则表达式<a class="headerlink" href="#script-regexp" title="永久链接至标题">¶</a></h2>
<p>正则表达式是文本处理的瑞士军刀。它们为程序员提供了从字符串中匹配和提取模式的能力.</p>
<p>正则表达式可以通过 <code class="docutils literal notranslate"><span class="pre">~/pattern/</span></code> 语法 和  <code class="docutils literal notranslate"><span class="pre">=~</span></code> , <code class="docutils literal notranslate"><span class="pre">==~</span></code> 操作符使用.</p>
<p>用 <code class="docutils literal notranslate"><span class="pre">=~</span></code> 来检查给定的模式是否出现在字符串中:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">assert</span> <span class="s1">&#39;foo&#39;</span> <span class="o">=~</span> <span class="o">/</span><span class="n">foo</span><span class="o">/</span>       <span class="o">//</span> <span class="k">return</span> <span class="n">TRUE</span>
<span class="k">assert</span> <span class="s1">&#39;foobar&#39;</span> <span class="o">=~</span> <span class="o">/</span><span class="n">foo</span><span class="o">/</span>    <span class="o">//</span> <span class="k">return</span> <span class="n">TRUE</span>
</pre></div>
</div>
<p>使用 <code class="docutils literal notranslate"><span class="pre">==~</span></code> 检查字符串是否与给定的正则表达式模式完全匹配.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">assert</span> <span class="s1">&#39;foo&#39;</span> <span class="o">==~</span> <span class="o">/</span><span class="n">foo</span><span class="o">/</span>       <span class="o">//</span> <span class="k">return</span> <span class="n">TRUE</span>
<span class="k">assert</span> <span class="s1">&#39;foobar&#39;</span> <span class="o">==~</span> <span class="o">/</span><span class="n">foo</span><span class="o">/</span>    <span class="o">//</span> <span class="k">return</span> <span class="n">FALSE</span>
</pre></div>
</div>
<p>值得注意的是， <code class="docutils literal notranslate"><span class="pre">~</span></code> 操作符从给定的字符串创建Java <code class="docutils literal notranslate"><span class="pre">Pattern</span></code> 对象，而 <code class="docutils literal notranslate"><span class="pre">=~</span></code> 操作符创建Java <code class="docutils literal notranslate"><span class="pre">Matcher</span></code> 对象.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>x = ~/abc/
println x.class
// prints java.util.regex.Pattern

y = &#39;some string&#39; =~ /abc/
println y.class
// prints java.util.regex.Matcher
</pre></div>
</div>
<p>正则表达式支持是从Java导入的. Java正则表达式语言和API被记录在
<a class="reference external" href="http://download.oracle.com/javase/7/docs/api/java/util/regex/Pattern.html">Pattern Java 文档</a> 中.</p>
<p>你也可能对这篇文章感兴趣: <a class="reference external" href="https://web.archive.org/web/20170621185113/http://www.naleid.com/blog/2008/05/19/dont-fear-the-regexp">Groovy: Don’t Fear the RegExp</a>.</p>
<div class="section" id="id12">
<h3>字符串替换<a class="headerlink" href="#id12" title="永久链接至标题">¶</a></h3>
<p>要替换给定字符串中出现的模式，请使用 <code class="docutils literal notranslate"><span class="pre">replaceFirst</span></code> 和 <code class="docutils literal notranslate"><span class="pre">replaceAll</span></code> 方法:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">x</span> <span class="o">=</span> <span class="s2">&quot;colour&quot;</span><span class="o">.</span><span class="n">replaceFirst</span><span class="p">(</span><span class="o">/</span><span class="n">ou</span><span class="o">/</span><span class="p">,</span> <span class="s2">&quot;o&quot;</span><span class="p">)</span>
<span class="n">println</span> <span class="n">x</span>
<span class="o">//</span> <span class="n">prints</span><span class="p">:</span> <span class="n">color</span>

<span class="n">y</span> <span class="o">=</span> <span class="s2">&quot;cheesecheese&quot;</span><span class="o">.</span><span class="n">replaceAll</span><span class="p">(</span><span class="o">/</span><span class="n">cheese</span><span class="o">/</span><span class="p">,</span> <span class="s2">&quot;nice&quot;</span><span class="p">)</span>
<span class="n">println</span> <span class="n">y</span>
<span class="o">//</span> <span class="n">prints</span><span class="p">:</span> <span class="n">nicenice</span>
</pre></div>
</div>
</div>
<div class="section" id="id13">
<h3>捕获组<a class="headerlink" href="#id13" title="永久链接至标题">¶</a></h3>
<p>您可以匹配包含组的模式. 首先使用 <code class="docutils literal notranslate"><span class="pre">=~</span></code> 运算符创建一个matcher对象。然后，您可以索引matcher对象以查找匹配项: <code class="docutils literal notranslate"><span class="pre">matcher[0]</span></code> 返回一个列表，该列表表示字符串中正则表达式的第一个匹配项。第一个列表元素是匹配整个正则表达式的字符串，其余元素是匹配每个组的字符串。</p>
<p>它是这样工作的:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>programVersion = &#39;2.7.3-beta&#39;
m = programVersion =~ /(\d+)\.(\d+)\.(\d+)-?(.+)/

assert m[0] ==  [&#39;2.7.3-beta&#39;, &#39;2&#39;, &#39;7&#39;, &#39;3&#39;, &#39;beta&#39;]
assert m[0][1] == &#39;2&#39;
assert m[0][2] == &#39;7&#39;
assert m[0][3] == &#39;3&#39;
assert m[0][4] == &#39;beta&#39;
</pre></div>
</div>
<p>应用一些语法糖，你可以在一行代码中做同样的事情:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>programVersion = &#39;2.7.3-beta&#39;
(full, major, minor, patch, flavor) = (programVersion =~ /(\d+)\.(\d+)\.(\d+)-?(.+)/)[0]

println full    // 2.7.3-beta
println major   // 2
println minor   // 7
println patch   // 3
println flavor  // beta
</pre></div>
</div>
</div>
<div class="section" id="id14">
<h3>删除字符串的一部分<a class="headerlink" href="#id14" title="永久链接至标题">¶</a></h3>
<p>可以使用正则表达式模式删除字符串值的一部分。找到的第一个匹配项替换为空字符串:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>// define the regexp pattern
wordStartsWithGr = ~/(?i)\s+Gr\w+/

// apply and verify the result
(&#39;Hello Groovy world!&#39; - wordStartsWithGr) == &#39;Hello world!&#39;
(&#39;Hi Grails users&#39; - wordStartsWithGr) == &#39;Hi users&#39;
</pre></div>
</div>
<p>从字符串中删除第一个5字符的单词:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">assert</span> <span class="p">(</span><span class="s1">&#39;Remove first match of 5 letter word&#39;</span> <span class="o">-</span> <span class="o">~/</span>\<span class="n">b</span>\<span class="n">w</span><span class="p">{</span><span class="mi">5</span><span class="p">}</span>\<span class="n">b</span><span class="o">/</span><span class="p">)</span> <span class="o">==</span> <span class="s1">&#39;Remove  match of 5 letter word&#39;</span>
</pre></div>
</div>
<p>从字符串中删除第一个数字及其后面的空格:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">assert</span> <span class="p">(</span><span class="s1">&#39;Line contains 20 characters&#39;</span> <span class="o">-</span> <span class="o">~/</span>\<span class="n">d</span><span class="o">+</span>\<span class="n">s</span><span class="o">+/</span><span class="p">)</span> <span class="o">==</span> <span class="s1">&#39;Line contains characters&#39;</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="i-o">
<span id="script-file-io"></span><h2>文件 和 I/O<a class="headerlink" href="#i-o" title="永久链接至标题">¶</a></h2>
<p>要访问和处理文件，使用 <code class="docutils literal notranslate"><span class="pre">file</span></code> 方法，返回一个文件系统对象，对象是文件路径字符串:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span> myFile = file(&#39;some/path/to/my_file.file&#39;)


``file`` 方法可以引用文件或者目录，这取决于在文件系统中字符串路径指的是什么。
</pre></div>
</div>
<p>当使用通配符 <code class="docutils literal notranslate"><span class="pre">*</span></code> 、 <code class="docutils literal notranslate"><span class="pre">?</span></code> 、 <code class="docutils literal notranslate"><span class="pre">[]</span></code> 和 <code class="docutils literal notranslate"><span class="pre">{}</span></code> 时，参数被解释为 <a class="reference external" href="http://docs.oracle.com/javase/tutorial/essential/io/fileOps.html#glob">glob</a> 路径匹配器， <code class="docutils literal notranslate"><span class="pre">file</span></code> 方法返回一个列表对象，其中包含名称与指定模式匹配的文件的路径，如果没有找到匹配，则返回一个空列表:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">listOfFiles</span> <span class="o">=</span> <span class="n">file</span><span class="p">(</span><span class="s1">&#39;some/path/*.fa&#39;</span><span class="p">)</span>
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">注解</p>
<p class="last">glob模式中的两个星号( <code class="docutils literal notranslate"><span class="pre">**</span></code> )类似于 <code class="docutils literal notranslate"><span class="pre">*</span></code> ，但是匹配文件系统路径中的任意数量的目录。</p>
</div>
<p>默认情况下，通配符不匹配目录或隐藏文件。例如，如果希望在结果列表中包含隐藏文件，可以添加可选参数 <code class="docutils literal notranslate"><span class="pre">hidden</span></code></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">listWithHidden</span> <span class="o">=</span> <span class="n">file</span><span class="p">(</span><span class="s1">&#39;some/path/*.fa&#39;</span><span class="p">,</span> <span class="n">hidden</span><span class="p">:</span> <span class="n">true</span><span class="p">)</span>
</pre></div>
</div>
<p>以下是文件的可用选项:</p>
<table border="1" class="docutils">
<colgroup>
<col width="9%" />
<col width="91%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Name</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>glob</td>
<td>When <code class="docutils literal notranslate"><span class="pre">true</span></code> interprets characters <code class="docutils literal notranslate"><span class="pre">*</span></code>, <code class="docutils literal notranslate"><span class="pre">?</span></code>, <code class="docutils literal notranslate"><span class="pre">[]</span></code> and <code class="docutils literal notranslate"><span class="pre">{}</span></code> as glob wildcards, otherwise handles them as normal characters (default: <code class="docutils literal notranslate"><span class="pre">true</span></code>)</td>
</tr>
<tr class="row-odd"><td>type</td>
<td>Type of paths returned, either <code class="docutils literal notranslate"><span class="pre">file</span></code>, <code class="docutils literal notranslate"><span class="pre">dir</span></code> or <code class="docutils literal notranslate"><span class="pre">any</span></code> (default: <code class="docutils literal notranslate"><span class="pre">file</span></code>)</td>
</tr>
<tr class="row-even"><td>hidden</td>
<td>When <code class="docutils literal notranslate"><span class="pre">true</span></code> includes hidden files in the resulting paths (default: <code class="docutils literal notranslate"><span class="pre">false</span></code>)</td>
</tr>
<tr class="row-odd"><td>maxDepth</td>
<td>Maximum number of directory levels to visit (default: <cite>no limit</cite>)</td>
</tr>
<tr class="row-even"><td>followLinks</td>
<td>When <code class="docutils literal notranslate"><span class="pre">true</span></code> follows symbolic links during directory tree traversal, otherwise treats them as files (default: <code class="docutils literal notranslate"><span class="pre">true</span></code>)</td>
</tr>
<tr class="row-odd"><td>checkIfExists</td>
<td>When <code class="docutils literal notranslate"><span class="pre">true</span></code> throws an exception of the specified path do not exist in the file system (default: <code class="docutils literal notranslate"><span class="pre">false</span></code>)</td>
</tr>
</tbody>
</table>
<div class="admonition tip">
<p class="first admonition-title">小技巧</p>
<p class="last">如果您是一个Java极客，您可能会有兴趣知道 <code class="docutils literal notranslate"><span class="pre">file</span></code> 方法返回一个`Path &lt;<a class="reference external" href="http://docs.oracle.com/javase/7/docs/api/java/nio/file/Path.html">http://docs.oracle.com/javase/7/docs/api/java/nio/file/Path.html</a>&gt;`_ 对象，它允许您使用Java程序中通常使用的方法。</p>
</div>
<p>See also: <a class="reference internal" href="channel.html#channel-path"><span class="std std-ref">Channel.fromPath</span></a>.</p>
<div class="section" id="id15">
<h3>基本的读/写<a class="headerlink" href="#id15" title="永久链接至标题">¶</a></h3>
<p>给定一个文件变量，使用前面示例中所示的 <code class="docutils literal notranslate"><span class="pre">file</span></code> 方法声明，读取文件可以非常简单的获取文件的 <code class="docutils literal notranslate"><span class="pre">text</span></code> 属性的值，这将返回文件内容作为字符串值:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span> <span class="n">myFile</span><span class="o">.</span><span class="n">text</span>
</pre></div>
</div>
<p>类似地，您可以通过简单地将字符串值赋值给文件的 <code class="docutils literal notranslate"><span class="pre">text</span></code> 属性来将其保存到文件中:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">myFile</span><span class="o">.</span><span class="n">text</span> <span class="o">=</span> <span class="s1">&#39;Hello world!&#39;</span>
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">注解</p>
<p class="last">已存在的文件内容被赋值操作覆盖，该操作还隐式地创建不存在的文件。</p>
</div>
<p>为了在不删除现有内容的情况下向文件追加字符串值，可以使用append方法:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">myFile</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;Add this line</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>或使用 <code class="docutils literal notranslate"><span class="pre">&lt;&lt;</span></code> 运算符, 这是一种更惯用的方法, 将文本内容附加到一个文件:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">myFile</span> <span class="o">&lt;&lt;</span> <span class="s1">&#39;Add a line more</span><span class="se">\n</span><span class="s1">&#39;</span>
</pre></div>
</div>
<p>二进制数据也可以用同样的方式管理，只是使用文件属性 <code class="docutils literal notranslate"><span class="pre">bytes</span></code> 而不是 <code class="docutils literal notranslate"><span class="pre">text</span></code> 。因此，以下示例读取文件并将它的内容作为字节数组返回:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">binaryContent</span> <span class="o">=</span> <span class="n">myFile</span><span class="o">.</span><span class="n">bytes</span>
</pre></div>
</div>
<p>或者你可以将一个字节数组数据缓冲区保存到一个文件中,通过简单地写:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">myFile</span><span class="o">.</span><span class="n">bytes</span> <span class="o">=</span> <span class="n">binaryBuffer</span>
</pre></div>
</div>
<div class="admonition warning">
<p class="first admonition-title">警告</p>
<p class="last">上述方法在单个变量或缓冲器中立即读取和写入所有文件内容。因此，在处理大文件时不建议使用它们，因为大文件需要更多的内存高效的方法，例如逐行读取文件或使用固定大小的缓冲区。</p>
</div>
</div>
<div class="section" id="id16">
<h3>逐行读取文件<a class="headerlink" href="#id16" title="永久链接至标题">¶</a></h3>
<p>In order to read a text file line by line you can use the method <code class="docutils literal notranslate"><span class="pre">readLines()</span></code> provided by the file object, which
returns the file content as a list of strings:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">myFile</span> <span class="o">=</span> <span class="n">file</span><span class="p">(</span><span class="s1">&#39;some/my_file.txt&#39;</span><span class="p">)</span>
<span class="n">allLines</span>  <span class="o">=</span> <span class="n">myFile</span><span class="o">.</span><span class="n">readLines</span><span class="p">()</span>
<span class="k">for</span><span class="p">(</span> <span class="n">line</span> <span class="p">:</span> <span class="n">allLines</span> <span class="p">)</span> <span class="p">{</span>
    <span class="n">println</span> <span class="n">line</span>
<span class="p">}</span>
</pre></div>
</div>
<p>This can also be written in a more idiomatic syntax:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">file</span><span class="p">(</span><span class="s1">&#39;some/my_file.txt&#39;</span><span class="p">)</span>
    <span class="o">.</span><span class="n">readLines</span><span class="p">()</span>
    <span class="o">.</span><span class="n">each</span> <span class="p">{</span> <span class="n">println</span> <span class="n">it</span> <span class="p">}</span>
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">注解</p>
<p class="last">The method <code class="docutils literal notranslate"><span class="pre">readLines()</span></code> reads all the file content at once and returns a list containing all the lines. For
this reason, do not use it to read big files.</p>
</div>
<p>To process a big file, use the method <code class="docutils literal notranslate"><span class="pre">eachLine</span></code>, which reads only a single line at a time into memory:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">count</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">myFile</span><span class="o">.</span><span class="n">eachLine</span> <span class="p">{</span>  <span class="nb">str</span> <span class="o">-&gt;</span>
        <span class="n">println</span> <span class="s2">&quot;line ${count++}: $str&quot;</span>
    <span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="advanced-file-reading-operations">
<h3>Advanced file reading operations<a class="headerlink" href="#advanced-file-reading-operations" title="永久链接至标题">¶</a></h3>
<p>The classes <code class="docutils literal notranslate"><span class="pre">Reader</span></code> and <code class="docutils literal notranslate"><span class="pre">InputStream</span></code> provide fine control for reading text and binary files, respectively._</p>
<p>The method <code class="docutils literal notranslate"><span class="pre">newReader</span></code> creates a <a class="reference external" href="http://docs.oracle.com/javase/7/docs/api/java/io/Reader.html">Reader</a> object
for the given file that allows you to read the content as single characters, lines or arrays of characters:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">myReader</span> <span class="o">=</span> <span class="n">myFile</span><span class="o">.</span><span class="n">newReader</span><span class="p">()</span>
<span class="n">String</span> <span class="n">line</span>
<span class="k">while</span><span class="p">(</span> <span class="n">line</span> <span class="o">=</span> <span class="n">myReader</span><span class="o">.</span><span class="n">readLine</span><span class="p">()</span> <span class="p">)</span> <span class="p">{</span>
    <span class="n">println</span> <span class="n">line</span>
<span class="p">}</span>
<span class="n">myReader</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
<p>The method <code class="docutils literal notranslate"><span class="pre">withReader</span></code> works similarly, but automatically calls the <code class="docutils literal notranslate"><span class="pre">close</span></code> method for you when you have finished
processing the file. So, the previous example can be written more simply as:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">myFile</span><span class="o">.</span><span class="n">withReader</span> <span class="p">{</span>
    <span class="n">String</span> <span class="n">line</span>
    <span class="k">while</span><span class="p">(</span> <span class="n">line</span> <span class="o">=</span> <span class="n">myReader</span><span class="o">.</span><span class="n">readLine</span><span class="p">()</span> <span class="p">)</span> <span class="p">{</span>
        <span class="n">println</span> <span class="n">line</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>The methods <code class="docutils literal notranslate"><span class="pre">newInputStream</span></code> and <code class="docutils literal notranslate"><span class="pre">withInputStream</span></code> work similarly. The main difference is that they create an
<a class="reference external" href="http://docs.oracle.com/javase/7/docs/api/java/io/InputStream.html">InputStream</a> object useful for writing binary
data.</p>
<p>Here are the most important methods for reading from files:</p>
<table border="1" class="docutils">
<colgroup>
<col width="9%" />
<col width="91%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Name</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>getText</td>
<td>Returns the file content as a string value</td>
</tr>
<tr class="row-odd"><td>getBytes</td>
<td>Returns the file content as byte array</td>
</tr>
<tr class="row-even"><td>readLines</td>
<td>Reads the file line by line and returns the content as a list of strings</td>
</tr>
<tr class="row-odd"><td>eachLine</td>
<td>Iterates over the file line by line, applying the specified <a class="reference internal" href="#script-closure"><span class="std std-ref">closure</span></a></td>
</tr>
<tr class="row-even"><td>eachByte</td>
<td>Iterates over the file byte by byte, applying the specified <a class="reference internal" href="#script-closure"><span class="std std-ref">closure</span></a></td>
</tr>
<tr class="row-odd"><td>withReader</td>
<td>Opens a file for reading and lets you access it with a <a class="reference external" href="http://docs.oracle.com/javase/7/docs/api/java/io/Reader.html">Reader</a> object</td>
</tr>
<tr class="row-even"><td>withInputStream</td>
<td>Opens a file for reading and lets you access it with an <a class="reference external" href="http://docs.oracle.com/javase/7/docs/api/java/io/InputStream.html">InputStream</a> object</td>
</tr>
<tr class="row-odd"><td>newReader</td>
<td>Returns a <a class="reference external" href="http://docs.oracle.com/javase/7/docs/api/java/io/Reader.html">Reader</a> object to read a text file</td>
</tr>
<tr class="row-even"><td>newInputStream</td>
<td>Returns an <a class="reference external" href="http://docs.oracle.com/javase/7/docs/api/java/io/InputStream.html">InputStream</a> object to read a binary file</td>
</tr>
</tbody>
</table>
<p>Read the Java documentation for <a class="reference external" href="http://docs.oracle.com/javase/7/docs/api/java/io/Reader.html">Reader</a> and
<a class="reference external" href="http://docs.oracle.com/javase/7/docs/api/java/io/InputStream.html">InputStream</a> classes to learn more about
methods available for reading data from files.</p>
</div>
<div class="section" id="advanced-file-writing-operations">
<h3>Advanced file writing operations<a class="headerlink" href="#advanced-file-writing-operations" title="永久链接至标题">¶</a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">Writer</span></code> and <code class="docutils literal notranslate"><span class="pre">OutputStream</span></code> classes provide fine control for writing text and binary files,
respectively, including low-level operations for single characters or bytes, and support for big files.</p>
<p>For example, given two file objects <code class="docutils literal notranslate"><span class="pre">sourceFile</span></code> and <code class="docutils literal notranslate"><span class="pre">targetFile</span></code>, the following code copies the
first file’s content into the second file, replacing all <code class="docutils literal notranslate"><span class="pre">U</span></code> characters with <code class="docutils literal notranslate"><span class="pre">X</span></code>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sourceFile</span><span class="o">.</span><span class="n">withReader</span> <span class="p">{</span> <span class="n">source</span> <span class="o">-&gt;</span>
    <span class="n">targetFile</span><span class="o">.</span><span class="n">withWriter</span> <span class="p">{</span> <span class="n">target</span> <span class="o">-&gt;</span>
        <span class="n">String</span> <span class="n">line</span>
        <span class="k">while</span><span class="p">(</span> <span class="n">line</span><span class="o">=</span><span class="n">source</span><span class="o">.</span><span class="n">readLine</span><span class="p">()</span> <span class="p">)</span> <span class="p">{</span>
            <span class="n">target</span> <span class="o">&lt;&lt;</span> <span class="n">line</span><span class="o">.</span><span class="n">replaceAll</span><span class="p">(</span><span class="s1">&#39;U&#39;</span><span class="p">,</span><span class="s1">&#39;X&#39;</span><span class="p">)</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Here are the most important methods for writing to files:</p>
<table border="1" class="docutils">
<colgroup>
<col width="11%" />
<col width="89%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Name</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>setText</td>
<td>Writes a string value to a file</td>
</tr>
<tr class="row-odd"><td>setBytes</td>
<td>Writes a byte array to a file</td>
</tr>
<tr class="row-even"><td>write</td>
<td>Writes a string to a file, replacing any existing content</td>
</tr>
<tr class="row-odd"><td>append</td>
<td>Appends a string value to a file without replacing existing content</td>
</tr>
<tr class="row-even"><td>newWriter</td>
<td>Creates a <a class="reference external" href="http://docs.oracle.com/javase/7/docs/api/java/io/Writer.html">Writer</a> object that allows you to save text data to a file</td>
</tr>
<tr class="row-odd"><td>newPrintWriter</td>
<td>Creates a <a class="reference external" href="http://docs.oracle.com/javase/7/docs/api/java/io/PrintWriter.html">PrintWriter</a> object that allows you to write formatted text to a file</td>
</tr>
<tr class="row-even"><td>newOutputStream</td>
<td>Creates an <a class="reference external" href="http://docs.oracle.com/javase/7/docs/api/java/io/OutputStream.html">OutputStream</a> object that allows you to write binary data to a file</td>
</tr>
<tr class="row-odd"><td>withWriter</td>
<td>Applies the specified closure to a <a class="reference external" href="http://docs.oracle.com/javase/7/docs/api/java/io/Writer.html">Writer</a> object, closing it when finished</td>
</tr>
<tr class="row-even"><td>withPrintWriter</td>
<td>Applies the specified closure to a <a class="reference external" href="http://docs.oracle.com/javase/7/docs/api/java/io/PrintWriter.html">PrintWriter</a> object, closing it when finished</td>
</tr>
<tr class="row-odd"><td>withOutputStream</td>
<td>Applies the specified closure to an <a class="reference external" href="http://docs.oracle.com/javase/7/docs/api/java/io/OutputStream.html">OutputStream</a> object, closing it when finished</td>
</tr>
</tbody>
</table>
<p>Read the Java documentation for the <a class="reference external" href="http://docs.oracle.com/javase/7/docs/api/java/io/Writer.html">Writer</a>,
<a class="reference external" href="http://docs.oracle.com/javase/7/docs/api/java/io/PrintWriter.html">PrintWriter</a> and
<a class="reference external" href="http://docs.oracle.com/javase/7/docs/api/java/io/OutputStream.html">OutputStream</a> classes to learn more about
methods available for writing data to files.</p>
</div>
<div class="section" id="list-directory-content">
<h3>List directory content<a class="headerlink" href="#list-directory-content" title="永久链接至标题">¶</a></h3>
<p>Let’s assume that you need to walk through a directory of your choice. You can define the <code class="docutils literal notranslate"><span class="pre">myDir</span></code> variable
that points to it:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">myDir</span> <span class="o">=</span> <span class="n">file</span><span class="p">(</span><span class="s1">&#39;any/path&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>The simplest way to get a directory list is by using the methods <code class="docutils literal notranslate"><span class="pre">list</span></code> or <code class="docutils literal notranslate"><span class="pre">listFiles</span></code>,
which return a collection of first-level elements (files and directories) of a directory:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">allFiles</span> <span class="o">=</span> <span class="n">myDir</span><span class="o">.</span><span class="n">list</span><span class="p">()</span>
<span class="k">for</span><span class="p">(</span> <span class="k">def</span> <span class="nf">file</span> <span class="p">:</span> <span class="n">allFiles</span> <span class="p">)</span> <span class="p">{</span>
    <span class="n">println</span> <span class="n">file</span>
<span class="p">}</span>
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">注解</p>
<p class="last">The only difference between <code class="docutils literal notranslate"><span class="pre">list</span></code> and <code class="docutils literal notranslate"><span class="pre">listFiles</span></code> is that the former returns a list of strings, and the latter a
list of file objects that allow you to access file metadata, e.g. size, last modified time, etc.</p>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">eachFile</span></code> method allows you to iterate through the first-level elements only
(just like <code class="docutils literal notranslate"><span class="pre">listFiles</span></code>). As with other <cite>each-</cite> methods, <code class="docutils literal notranslate"><span class="pre">eachFiles</span></code> takes a closure as a parameter:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">myDir</span><span class="o">.</span><span class="n">eachFile</span> <span class="p">{</span> <span class="n">item</span> <span class="o">-&gt;</span>
    <span class="k">if</span><span class="p">(</span> <span class="n">item</span><span class="o">.</span><span class="n">isFile</span><span class="p">()</span> <span class="p">)</span> <span class="p">{</span>
        <span class="n">println</span> <span class="s2">&quot;${item.getName()} - size: ${item.size()}&quot;</span>
    <span class="p">}</span>
    <span class="k">else</span> <span class="k">if</span><span class="p">(</span> <span class="n">item</span><span class="o">.</span><span class="n">isDirectory</span><span class="p">()</span> <span class="p">)</span> <span class="p">{</span>
        <span class="n">println</span> <span class="s2">&quot;${item.getName()} - DIR&quot;</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Several variants of the above method are available. See the table below for a complete list.</p>
<table border="1" class="docutils">
<colgroup>
<col width="8%" />
<col width="92%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Name</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>eachFile</td>
<td>Iterates through first-level elements (files and directories). <a class="reference external" href="http://docs.groovy-lang.org/latest/html/groovy-jdk/java/io/File.html#eachFile(groovy.io.FileType,%20groovy.lang.Closure)">Read more</a></td>
</tr>
<tr class="row-odd"><td>eachDir</td>
<td>Iterates through first-level directories only. <a class="reference external" href="http://docs.groovy-lang.org/latest/html/groovy-jdk/java/io/File.html#eachDir(groovy.lang.Closure)">Read more</a></td>
</tr>
<tr class="row-even"><td>eachFileMatch</td>
<td>Iterates through files and dirs whose names match the given filter. <a class="reference external" href="http://docs.groovy-lang.org/latest/html/groovy-jdk/java/io/File.html#eachFileMatch(java.lang.Object,%20groovy.lang.Closure)">Read more</a></td>
</tr>
<tr class="row-odd"><td>eachDirMatch</td>
<td>Iterates through directories whose names match the given filter. <a class="reference external" href="http://docs.groovy-lang.org/latest/html/groovy-jdk/java/io/File.html#eachDirMatch(java.lang.Object,%20groovy.lang.Closure)">Read more</a></td>
</tr>
<tr class="row-even"><td>eachFileRecurse</td>
<td>Iterates through directory elements depth-first. <a class="reference external" href="http://docs.groovy-lang.org/latest/html/groovy-jdk/java/io/File.html#eachFileRecurse(groovy.lang.Closure)">Read more</a></td>
</tr>
<tr class="row-odd"><td>eachDirRecurse</td>
<td>Iterates through directories depth-first (regular files are ignored). <a class="reference external" href="http://docs.groovy-lang.org/latest/html/groovy-jdk/java/io/File.html#eachDirRecurse(groovy.lang.Closure)">Read more</a></td>
</tr>
</tbody>
</table>
<p>See also: Channel <a class="reference internal" href="channel.html#channel-path"><span class="std std-ref">fromPath</span></a> method.</p>
</div>
<div class="section" id="create-directories">
<h3>Create directories<a class="headerlink" href="#create-directories" title="永久链接至标题">¶</a></h3>
<p>Given a file variable representing a nonexistent directory, like the following:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">myDir</span> <span class="o">=</span> <span class="n">file</span><span class="p">(</span><span class="s1">&#39;any/path&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>the method <code class="docutils literal notranslate"><span class="pre">mkdir</span></code> creates a directory at the given path, returning <code class="docutils literal notranslate"><span class="pre">true</span></code> if the directory is created
successfully, and <code class="docutils literal notranslate"><span class="pre">false</span></code> otherwise:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>result = myDir.mkdir()
println result ? &quot;OK&quot; : &quot;Cannot create directory: $myDir&quot;
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">注解</p>
<p class="last">If the parent directories do not exist, the above method will fail and return <code class="docutils literal notranslate"><span class="pre">false</span></code>.</p>
</div>
<p>The method <code class="docutils literal notranslate"><span class="pre">mkdirs</span></code> creates the directory named by the file object, including any nonexistent parent directories:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">myDir</span><span class="o">.</span><span class="n">mkdirs</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="section" id="create-links">
<h3>Create links<a class="headerlink" href="#create-links" title="永久链接至标题">¶</a></h3>
<p>Given a file, the method <code class="docutils literal notranslate"><span class="pre">mklink</span></code> creates a <em>file system link</em> for that file using the path specified as a parameter:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">myFile</span> <span class="o">=</span> <span class="n">file</span><span class="p">(</span><span class="s1">&#39;/some/path/file.txt&#39;</span><span class="p">)</span>
<span class="n">myFile</span><span class="o">.</span><span class="n">mklink</span><span class="p">(</span><span class="s1">&#39;/user/name/link-to-file.txt&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>Table of optional parameters:</p>
<table border="1" class="docutils">
<colgroup>
<col width="8%" />
<col width="92%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Name</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>hard</td>
<td>When <code class="docutils literal notranslate"><span class="pre">true</span></code> creates a <em>hard</em> link, otherwise creates a <em>soft</em> (aka <em>symbolic</em>) link. (default: <code class="docutils literal notranslate"><span class="pre">false</span></code>)</td>
</tr>
<tr class="row-odd"><td>overwrite</td>
<td>When <code class="docutils literal notranslate"><span class="pre">true</span></code> overwrites any existing file with the same name, otherwise throws a <a class="reference external" href="http://docs.oracle.com/javase/8/docs/api/java/nio/file/FileAlreadyExistsException.html">FileAlreadyExistsException</a> (default: <code class="docutils literal notranslate"><span class="pre">false</span></code>)</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="copy-files">
<h3>Copy files<a class="headerlink" href="#copy-files" title="永久链接至标题">¶</a></h3>
<p>The method <code class="docutils literal notranslate"><span class="pre">copyTo</span></code> copies a file into a new file or into a directory, or copie a directory to a new
directory:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">myFile</span><span class="o">.</span><span class="n">copyTo</span><span class="p">(</span><span class="s1">&#39;new_name.txt&#39;</span><span class="p">)</span>
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">注解</p>
<p class="last">If the target file already exists, it will be replaced by the new one. Note also that, if the target is
a directory, the source file will be copied into that directory, maintaining the file’s original name.</p>
</div>
<p>When the source file is a directory, all its content is copied to the target directory:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">myDir</span> <span class="o">=</span> <span class="n">file</span><span class="p">(</span><span class="s1">&#39;/some/path&#39;</span><span class="p">)</span>
<span class="n">myDir</span><span class="o">.</span><span class="n">copyTo</span><span class="p">(</span><span class="s1">&#39;/some/new/path&#39;</span><span class="p">)</span>


<span class="n">If</span> <span class="n">the</span> <span class="n">target</span> <span class="n">path</span> <span class="n">does</span> <span class="ow">not</span> <span class="n">exist</span><span class="p">,</span> <span class="n">it</span> <span class="n">will</span> <span class="n">be</span> <span class="n">created</span> <span class="n">automatically</span><span class="o">.</span>
</pre></div>
</div>
<div class="admonition tip">
<p class="first admonition-title">小技巧</p>
<p class="last">The <code class="docutils literal notranslate"><span class="pre">copyTo</span></code> method mimics the semantics of the Linux command <code class="docutils literal notranslate"><span class="pre">cp</span> <span class="pre">-r</span> <span class="pre">&lt;source&gt;</span> <span class="pre">&lt;target&gt;</span></code>, with the
following caveat: While Linux tools often treat paths ending with a slash (e.g. <code class="docutils literal notranslate"><span class="pre">/some/path/name/</span></code>)
as directories, and those not (e.g. <code class="docutils literal notranslate"><span class="pre">/some/path/name</span></code>) as regular files, Nextflow (due to its use of
the Java files API) views both these paths as the same file system object. If the path exists, it is
handled according to its actual type (i.e. as a regular file or as a directory). If the path does not
exist, it is treated as a regular file, with any missing parent directories created automatically.</p>
</div>
</div>
<div class="section" id="move-files">
<h3>Move files<a class="headerlink" href="#move-files" title="永久链接至标题">¶</a></h3>
<p>You can move a file by using the method <code class="docutils literal notranslate"><span class="pre">moveTo</span></code>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">myFile</span> <span class="o">=</span> <span class="n">file</span><span class="p">(</span><span class="s1">&#39;/some/path/file.txt&#39;</span><span class="p">)</span>
<span class="n">myFile</span><span class="o">.</span><span class="n">moveTo</span><span class="p">(</span><span class="s1">&#39;/another/path/new_file.txt&#39;</span><span class="p">)</span>
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">注解</p>
<p class="last">When a file with the same name as the target already exists, it will be replaced by the source. Note
also that, when the target is a directory, the file will be moved to (or within) that directory,
maintaining the file’s original name.</p>
</div>
<p>When the source is a directory, all the directory content is moved to the target directory:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">myDir</span> <span class="o">=</span> <span class="n">file</span><span class="p">(</span><span class="s1">&#39;/any/dir_a&#39;</span><span class="p">)</span>
<span class="n">myDir</span><span class="o">.</span><span class="n">moveTo</span><span class="p">(</span><span class="s1">&#39;/any/dir_b&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>Please note that the result of the above example depends on the existence of the target directory. If the target
directory exists, the source is moved into the target directory, resulting in the path:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">/</span><span class="nb">any</span><span class="o">/</span><span class="n">dir_b</span><span class="o">/</span><span class="n">dir_a</span>
</pre></div>
</div>
<p>If the target directory does not exist, the source is just renamed to the target name, resulting in the path:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">/</span><span class="nb">any</span><span class="o">/</span><span class="n">dir_b</span>
</pre></div>
</div>
<div class="admonition tip">
<p class="first admonition-title">小技巧</p>
<p class="last">The <code class="docutils literal notranslate"><span class="pre">moveTo</span></code> method mimics the semantics of the Linux command <code class="docutils literal notranslate"><span class="pre">mv</span> <span class="pre">&lt;source&gt;</span> <span class="pre">&lt;target&gt;</span></code>, with the
same caveat as that given for <code class="docutils literal notranslate"><span class="pre">copyTo</span></code>, above.</p>
</div>
</div>
<div class="section" id="rename-files">
<h3>Rename files<a class="headerlink" href="#rename-files" title="永久链接至标题">¶</a></h3>
<p>You can rename a file or directory by simply using the <code class="docutils literal notranslate"><span class="pre">renameTo</span></code> file method:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">myFile</span> <span class="o">=</span> <span class="n">file</span><span class="p">(</span><span class="s1">&#39;my_file.txt&#39;</span><span class="p">)</span>
<span class="n">myFile</span><span class="o">.</span><span class="n">renameTo</span><span class="p">(</span><span class="s1">&#39;new_file_name.txt&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="delete-files">
<h3>Delete files<a class="headerlink" href="#delete-files" title="永久链接至标题">¶</a></h3>
<p>The file method <code class="docutils literal notranslate"><span class="pre">delete</span></code> deletes the file or directory at the given path, returning <code class="docutils literal notranslate"><span class="pre">true</span></code> if the
operation succeeds, and <code class="docutils literal notranslate"><span class="pre">false</span></code> otherwise:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>myFile = file(&#39;some/file.txt&#39;)
result = myFile.delete
println result ? &quot;OK&quot; : &quot;Can delete: $myFile&quot;
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">注解</p>
<p class="last">This method deletes a directory ONLY if it does not contain any files or sub-directories. To
delete a directory and ALL its content (i.e. removing all the files and sub-directories it may
contain), use the method <code class="docutils literal notranslate"><span class="pre">deleteDir</span></code>.</p>
</div>
</div>
<div class="section" id="check-file-attributes">
<h3>Check file attributes<a class="headerlink" href="#check-file-attributes" title="永久链接至标题">¶</a></h3>
<p>The following methods can be used on a file variable created by using the <code class="docutils literal notranslate"><span class="pre">file</span></code> method:</p>
<table border="1" class="docutils">
<colgroup>
<col width="17%" />
<col width="83%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Name</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>getName</td>
<td>Gets the file name e.g. <code class="docutils literal notranslate"><span class="pre">/some/path/file.txt</span></code> -&gt; <code class="docutils literal notranslate"><span class="pre">file.txt</span></code></td>
</tr>
<tr class="row-odd"><td>getBaseName</td>
<td>Gets the file name without its extension e.g. <code class="docutils literal notranslate"><span class="pre">/some/path/file.tar.gz</span></code> -&gt; <code class="docutils literal notranslate"><span class="pre">file.tar</span></code></td>
</tr>
<tr class="row-even"><td>getSimpleName</td>
<td>Gets the file name without any extension e.g. <code class="docutils literal notranslate"><span class="pre">/some/path/file.tar.gz</span></code> -&gt; <code class="docutils literal notranslate"><span class="pre">file</span></code></td>
</tr>
<tr class="row-odd"><td>getExtension</td>
<td>Gets the file extension e.g. <code class="docutils literal notranslate"><span class="pre">/some/path/file.txt</span></code> -&gt; <code class="docutils literal notranslate"><span class="pre">txt</span></code></td>
</tr>
<tr class="row-even"><td>getParent</td>
<td>Gets the file parent path e.g. <code class="docutils literal notranslate"><span class="pre">/some/path/file.txt</span></code> -&gt; <code class="docutils literal notranslate"><span class="pre">/some/path</span></code></td>
</tr>
<tr class="row-odd"><td>size</td>
<td>Gets the file size in bytes</td>
</tr>
<tr class="row-even"><td>exists</td>
<td>Returns <code class="docutils literal notranslate"><span class="pre">true</span></code> if the file exists, or <code class="docutils literal notranslate"><span class="pre">false</span></code> otherwise</td>
</tr>
<tr class="row-odd"><td>isEmpty</td>
<td>Returns <code class="docutils literal notranslate"><span class="pre">true</span></code> if the file is zero length or does not exist, <code class="docutils literal notranslate"><span class="pre">false</span></code> otherwise</td>
</tr>
<tr class="row-even"><td>isFile</td>
<td>Returns <code class="docutils literal notranslate"><span class="pre">true</span></code> if it is a regular file e.g. not a directory</td>
</tr>
<tr class="row-odd"><td>isDirectory</td>
<td>Returns <code class="docutils literal notranslate"><span class="pre">true</span></code> if the file is a directory</td>
</tr>
<tr class="row-even"><td>isHidden</td>
<td>Returns <code class="docutils literal notranslate"><span class="pre">true</span></code> if the file is hidden</td>
</tr>
<tr class="row-odd"><td>lastModified</td>
<td>Returns the file last modified timestamp i.e. a long as Linux epoch time</td>
</tr>
</tbody>
</table>
<p>For example, the following line prints a file name and size:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">println</span> <span class="s2">&quot;File ${myFile.getName() size: ${myFile.size()}&quot;</span>
</pre></div>
</div>
</div>
<div class="section" id="get-and-modify-file-permissions">
<h3>Get and modify file permissions<a class="headerlink" href="#get-and-modify-file-permissions" title="永久链接至标题">¶</a></h3>
<p>Given a file variable representing a file (or directory), the method <code class="docutils literal notranslate"><span class="pre">getPermissions</span></code> returns a
9-character string representing the file’s permissions using the
<a class="reference external" href="http://en.wikipedia.org/wiki/File_system_permissions#Symbolic_notation">Linux symbolic notation</a>
e.g. <code class="docutils literal notranslate"><span class="pre">rw-rw-r--</span></code>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">permissions</span> <span class="o">=</span> <span class="n">myFile</span><span class="o">.</span><span class="n">getPermissions</span><span class="p">()</span>
</pre></div>
</div>
<p>Similarly, the method <code class="docutils literal notranslate"><span class="pre">setPermissions</span></code> sets the file’s permissions using the same notation:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">myFile</span><span class="o">.</span><span class="n">setPermissions</span><span class="p">(</span><span class="s1">&#39;rwxr-xr-x&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>A second version of the <code class="docutils literal notranslate"><span class="pre">setPermissions</span></code> method sets a file’s permissions given three digits representing,
respectively, the <cite>owner</cite>, <cite>group</cite> and <cite>other</cite> permissions:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">myFile</span><span class="o">.</span><span class="n">setPermissions</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">5</span><span class="p">)</span>
</pre></div>
</div>
<p>Learn more about <a class="reference external" href="http://en.wikipedia.org/wiki/File_system_permissions#Numeric_notation">File permissions numeric notation</a>.</p>
</div>
<div class="section" id="http-ftp-files">
<h3>HTTP/FTP files<a class="headerlink" href="#http-ftp-files" title="永久链接至标题">¶</a></h3>
<p>Nextflow provides transparent integration of HTTP/S and FTP protocols for handling remote resources
as local file system objects. Simply specify the resource URL as the argument of the <cite>file</cite> object:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">pdb</span> <span class="o">=</span> <span class="n">file</span><span class="p">(</span><span class="s1">&#39;http://files.rcsb.org/header/5FID.pdb&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>Then, you can access it as a local file as described in the previous sections:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">println</span> <span class="n">pdb</span><span class="o">.</span><span class="n">text</span>
</pre></div>
</div>
<p>The above one-liner prints the content of the remote PDB file. Previous sections provide code examples
showing how to stream or copy the content of files.</p>
<div class="admonition note">
<p class="first admonition-title">注解</p>
<p class="last">Write and list operations are not supported for HTTP/S and FTP files.</p>
</div>
</div>
<div class="section" id="counting-records">
<h3>Counting records<a class="headerlink" href="#counting-records" title="永久链接至标题">¶</a></h3>
<div class="section" id="countlines">
<h4>countLines<a class="headerlink" href="#countlines" title="永久链接至标题">¶</a></h4>
<p>The <code class="docutils literal notranslate"><span class="pre">countLines</span></code> methods counts the lines in a text files.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">sample</span> <span class="o">=</span> <span class="n">file</span><span class="p">(</span><span class="s1">&#39;/data/sample.txt&#39;</span><span class="p">)</span>
<span class="n">println</span> <span class="n">sample</span><span class="o">.</span><span class="n">countLines</span><span class="p">()</span>
</pre></div>
</div>
<p>Files whose name ends with the <code class="docutils literal notranslate"><span class="pre">.gz</span></code> suffix are expected to be GZIP compressed and
automatically uncompressed.</p>
</div>
<div class="section" id="countfasta">
<h4>countFasta<a class="headerlink" href="#countfasta" title="永久链接至标题">¶</a></h4>
<p>The <code class="docutils literal notranslate"><span class="pre">countFasta</span></code> method counts the number of records in <a class="reference external" href="https://en.wikipedia.org/wiki/FASTA_format">FASTA</a>
formatted file.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">sample</span> <span class="o">=</span> <span class="n">file</span><span class="p">(</span><span class="s1">&#39;/data/sample.fasta&#39;</span><span class="p">)</span>
<span class="n">println</span> <span class="n">sample</span><span class="o">.</span><span class="n">countFasta</span><span class="p">()</span>
</pre></div>
</div>
<p>Files whose name ends with the <code class="docutils literal notranslate"><span class="pre">.gz</span></code> suffix are expected to be GZIP compressed and
automatically uncompressed.</p>
</div>
<div class="section" id="countfastq">
<h4>countFastq<a class="headerlink" href="#countfastq" title="永久链接至标题">¶</a></h4>
<p>The <code class="docutils literal notranslate"><span class="pre">countFastq</span></code> method counts the number of records in a <a class="reference external" href="https://en.wikipedia.org/wiki/FASTQ_format">FASTQ</a>
formatted file.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">sample</span> <span class="o">=</span> <span class="n">file</span><span class="p">(</span><span class="s1">&#39;/data/sample.fastq&#39;</span><span class="p">)</span>
<span class="n">println</span> <span class="n">sample</span><span class="o">.</span><span class="n">countFastq</span><span class="p">()</span>
</pre></div>
</div>
<p>Files whose name ends with the <code class="docutils literal notranslate"><span class="pre">.gz</span></code> suffix are expected to be GZIP compressed and
automatically uncompressed.</p>
</div>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="process.html" class="btn btn-neutral float-right" title="Processes" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="basic.html" class="btn btn-neutral float-left" title="基本理念" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2019, lidanqing

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>