

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="zh-CN" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="zh-CN" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Operators &mdash; Nextflow-ZH-documentation 0.0.1 文档</title>
  

  
  
  
  

  
  <script type="text/javascript" src="../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script type="text/javascript" src="../_static/jquery.js"></script>
        <script type="text/javascript" src="../_static/underscore.js"></script>
        <script type="text/javascript" src="../_static/doctools.js"></script>
        <script type="text/javascript" src="../_static/language_data.js"></script>
        <script type="text/javascript" src="../_static/translations.js"></script>
        <script async="async" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="index" title="索引" href="../genindex.html" />
    <link rel="search" title="搜索" href="../search.html" />
    <link rel="next" title="Executors" href="executor.html" />
    <link rel="prev" title="Channels" href="channel.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html" class="icon icon-home"> Nextflow-ZH-documentation
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="getstarted.html">开始</a></li>
<li class="toctree-l1"><a class="reference internal" href="basic.html">基本理念</a></li>
<li class="toctree-l1"><a class="reference internal" href="script.html">Nextflow 脚本语言</a></li>
<li class="toctree-l1"><a class="reference internal" href="process.html">Processes</a></li>
<li class="toctree-l1"><a class="reference internal" href="channel.html">Channels</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Operators</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#filtering-operators">Filtering operators</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#filter">filter</a></li>
<li class="toctree-l3"><a class="reference internal" href="#unique">unique</a></li>
<li class="toctree-l3"><a class="reference internal" href="#distinct">distinct</a></li>
<li class="toctree-l3"><a class="reference internal" href="#first">first</a></li>
<li class="toctree-l3"><a class="reference internal" href="#randomsample">randomSample</a></li>
<li class="toctree-l3"><a class="reference internal" href="#take">take</a></li>
<li class="toctree-l3"><a class="reference internal" href="#last">last</a></li>
<li class="toctree-l3"><a class="reference internal" href="#until">until</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#transforming-operators">Transforming operators</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#map">map</a></li>
<li class="toctree-l3"><a class="reference internal" href="#flatmap">flatMap</a></li>
<li class="toctree-l3"><a class="reference internal" href="#reduce">reduce</a></li>
<li class="toctree-l3"><a class="reference internal" href="#groupby">groupBy</a></li>
<li class="toctree-l3"><a class="reference internal" href="#grouptuple">groupTuple</a></li>
<li class="toctree-l3"><a class="reference internal" href="#buffer">buffer</a></li>
<li class="toctree-l3"><a class="reference internal" href="#collate">collate</a></li>
<li class="toctree-l3"><a class="reference internal" href="#collect">collect</a></li>
<li class="toctree-l3"><a class="reference internal" href="#flatten">flatten</a></li>
<li class="toctree-l3"><a class="reference internal" href="#tolist">toList</a></li>
<li class="toctree-l3"><a class="reference internal" href="#tosortedlist">toSortedList</a></li>
<li class="toctree-l3"><a class="reference internal" href="#transpose">transpose</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#splitting-operators">Splitting operators</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#splitcsv">splitCsv</a></li>
<li class="toctree-l3"><a class="reference internal" href="#splitfasta">splitFasta</a></li>
<li class="toctree-l3"><a class="reference internal" href="#splitfastq">splitFastq</a></li>
<li class="toctree-l3"><a class="reference internal" href="#splittext">splitText</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#combining-operators">Combining operators</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#into">into</a></li>
<li class="toctree-l3"><a class="reference internal" href="#tap">tap</a></li>
<li class="toctree-l3"><a class="reference internal" href="#join">join</a></li>
<li class="toctree-l3"><a class="reference internal" href="#merge">merge</a></li>
<li class="toctree-l3"><a class="reference internal" href="#mix">mix</a></li>
<li class="toctree-l3"><a class="reference internal" href="#phase">phase</a></li>
<li class="toctree-l3"><a class="reference internal" href="#cross">cross</a></li>
<li class="toctree-l3"><a class="reference internal" href="#collectfile">collectFile</a></li>
<li class="toctree-l3"><a class="reference internal" href="#combine">combine</a></li>
<li class="toctree-l3"><a class="reference internal" href="#concat">concat</a></li>
<li class="toctree-l3"><a class="reference internal" href="#spread">spread</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#forking-operators">Forking operators</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#choice">choice</a></li>
<li class="toctree-l3"><a class="reference internal" href="#separate">separate</a></li>
<li class="toctree-l3"><a class="reference internal" href="#route">route</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#maths-operators">Maths operators</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#count">count</a></li>
<li class="toctree-l3"><a class="reference internal" href="#countby">countBy</a></li>
<li class="toctree-l3"><a class="reference internal" href="#min">min</a></li>
<li class="toctree-l3"><a class="reference internal" href="#max">max</a></li>
<li class="toctree-l3"><a class="reference internal" href="#sum">sum</a></li>
<li class="toctree-l3"><a class="reference internal" href="#tointeger">toInteger</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#other-operators">Other operators</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#dump">dump</a></li>
<li class="toctree-l3"><a class="reference internal" href="#set">set</a></li>
<li class="toctree-l3"><a class="reference internal" href="#ifempty">ifEmpty</a></li>
<li class="toctree-l3"><a class="reference internal" href="#print">print</a></li>
<li class="toctree-l3"><a class="reference internal" href="#println">println</a></li>
<li class="toctree-l3"><a class="reference internal" href="#view">view</a></li>
<li class="toctree-l3"><a class="reference internal" href="#close">close</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="executor.html">Executors</a></li>
<li class="toctree-l1"><a class="reference internal" href="config.html">Configuration</a></li>
<li class="toctree-l1"><a class="reference internal" href="awscloud.html">Amazon Cloud</a></li>
<li class="toctree-l1"><a class="reference internal" href="amazons3.html">Amazon S3 storage</a></li>
<li class="toctree-l1"><a class="reference internal" href="google.html">Google Cloud</a></li>
<li class="toctree-l1"><a class="reference internal" href="conda.html">Conda environments</a></li>
<li class="toctree-l1"><a class="reference internal" href="docker.html">Docker containers</a></li>
<li class="toctree-l1"><a class="reference internal" href="singularity.html">Singularity containers</a></li>
<li class="toctree-l1"><a class="reference internal" href="ignite.html">Apache Ignite</a></li>
<li class="toctree-l1"><a class="reference internal" href="kubernetes.html">Kubernetes</a></li>
<li class="toctree-l1"><a class="reference internal" href="tracing.html">Tracing &amp; visualisation</a></li>
<li class="toctree-l1"><a class="reference internal" href="sharing.html">Pipeline sharing</a></li>
<li class="toctree-l1"><a class="reference internal" href="metadata.html">Workflow introspection</a></li>
<li class="toctree-l1"><a class="reference internal" href="mail.html">Mail &amp; Notifications</a></li>
<li class="toctree-l1"><a class="reference internal" href="example.html">Examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="faq.html">FAQ</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Nextflow-ZH-documentation</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html">Docs</a> &raquo;</li>
        
      <li>Operators</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/doc/operator.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="operators">
<span id="operator-page"></span><h1>Operators<a class="headerlink" href="#operators" title="永久链接至标题">¶</a></h1>
<p>Nextflow <cite>operators</cite> are methods that allow you to connect channels to each other or to transform values
emitted by a channel applying some user provided rules.</p>
<p>Operators can be separated in to five groups:</p>
<ul class="simple">
<li><a class="reference internal" href="#filtering-operators">Filtering operators</a></li>
<li><a class="reference internal" href="#transforming-operators">Transforming operators</a></li>
<li><a class="reference internal" href="#splitting-operators">Splitting operators</a></li>
<li><a class="reference internal" href="#combining-operators">Combining operators</a></li>
<li><a class="reference internal" href="#forking-operators">Forking operators</a></li>
<li><a class="reference internal" href="#maths-operators">Maths operators</a></li>
<li><a class="reference internal" href="#other-operators">Other operators</a></li>
</ul>
<div class="section" id="filtering-operators">
<h2>Filtering operators<a class="headerlink" href="#filtering-operators" title="永久链接至标题">¶</a></h2>
<p>Given a channel, filtering operators allow you to select only the items that comply with a given rule.</p>
<p>The available filter operators are:</p>
<ul class="simple">
<li><a class="reference internal" href="#distinct">distinct</a></li>
<li><a class="reference internal" href="#filter">filter</a></li>
<li><a class="reference internal" href="#first">first</a></li>
<li><a class="reference internal" href="#last">last</a></li>
<li><a class="reference internal" href="#randomsample">randomSample</a></li>
<li><a class="reference internal" href="#take">take</a></li>
<li><a class="reference internal" href="#unique">unique</a></li>
<li><a class="reference internal" href="#until">until</a></li>
</ul>
<div class="section" id="filter">
<h3>filter<a class="headerlink" href="#filter" title="永久链接至标题">¶</a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">filter</span></code> operator allows you to get only the items emitted by a channel that satisfy a condition and discarding
all the others. The filtering condition can be specified by using either a <a class="reference internal" href="script.html#script-regexp"><span class="std std-ref">regular expression</span></a>,
a literal value, a type <cite>qualifier</cite> (i.e. a Java class) or any boolean <cite>predicate</cite>.</p>
<p>The following example shows how to filter a channel by using a regular expression that returns only string that
begins with <code class="docutils literal notranslate"><span class="pre">a</span></code>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Channel</span>
    <span class="o">.</span><span class="n">from</span><span class="p">(</span> <span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;aa&#39;</span><span class="p">,</span> <span class="s1">&#39;bc&#39;</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mf">4.5</span> <span class="p">)</span>
    <span class="o">.</span><span class="n">filter</span><span class="p">(</span> <span class="o">~/^</span><span class="n">a</span><span class="o">.*/</span> <span class="p">)</span>
    <span class="o">.</span><span class="n">subscribe</span> <span class="p">{</span> <span class="n">println</span> <span class="n">it</span> <span class="p">}</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">a</span>
<span class="n">aa</span>
</pre></div>
</div>
<p>The following example shows how to filter a channel by specifying the type qualifier <code class="docutils literal notranslate"><span class="pre">Number</span></code> so that only numbers
are returned:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Channel</span>
    <span class="o">.</span><span class="n">from</span><span class="p">(</span> <span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;aa&#39;</span><span class="p">,</span> <span class="s1">&#39;bc&#39;</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mf">4.5</span> <span class="p">)</span>
    <span class="o">.</span><span class="n">filter</span><span class="p">(</span> <span class="n">Number</span> <span class="p">)</span>
    <span class="o">.</span><span class="n">subscribe</span> <span class="p">{</span> <span class="n">println</span> <span class="n">it</span> <span class="p">}</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mi">3</span>
<span class="mf">4.5</span>
</pre></div>
</div>
<p>Finally, a filtering condition can be defined by using any a boolean <cite>predicate</cite>. A predicate is expressed by
a <a class="reference internal" href="script.html#script-closure"><span class="std std-ref">closure</span></a> returning a boolean value. For example the following fragment shows how filter
a channel emitting numbers so that the <cite>odd</cite> values are returned:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Channel</span>
    <span class="o">.</span><span class="n">from</span><span class="p">(</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span> <span class="p">)</span>
    <span class="o">.</span><span class="n">filter</span> <span class="p">{</span> <span class="n">it</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">==</span> <span class="mi">1</span> <span class="p">}</span>
    <span class="o">.</span><span class="n">subscribe</span> <span class="p">{</span> <span class="n">println</span> <span class="n">it</span> <span class="p">}</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mi">1</span>
<span class="mi">3</span>
<span class="mi">5</span>
</pre></div>
</div>
<div class="admonition tip">
<p class="first admonition-title">小技巧</p>
<p class="last">In the above example the filter condition is wrapped in curly brackets,
instead of round brackets, since it specifies a <a class="reference internal" href="script.html#script-closure"><span class="std std-ref">closure</span></a> as the operator’s argument.
This just is a language syntax-sugar for <code class="docutils literal notranslate"><span class="pre">filter({</span> <span class="pre">it.toString().size()</span> <span class="pre">==</span> <span class="pre">1</span> <span class="pre">})</span></code></p>
</div>
</div>
<div class="section" id="unique">
<h3>unique<a class="headerlink" href="#unique" title="永久链接至标题">¶</a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">unique</span></code> operator allows you to remove duplicate items from a channel and only emit single items with no repetition.</p>
<p>For example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Channel</span>
    <span class="o">.</span><span class="n">from</span><span class="p">(</span> <span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span> <span class="p">)</span>
    <span class="o">.</span><span class="n">unique</span><span class="p">()</span>
    <span class="o">.</span><span class="n">subscribe</span> <span class="p">{</span> <span class="n">println</span> <span class="n">it</span> <span class="p">}</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mi">1</span>
<span class="mi">5</span>
<span class="mi">7</span>
<span class="mi">3</span>
</pre></div>
</div>
<p>You can also specify an optional <a class="reference internal" href="script.html#script-closure"><span class="std std-ref">closure</span></a> that customizes the way it distinguishes between unique items.
For example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Channel</span>
    <span class="o">.</span><span class="n">from</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">)</span>
    <span class="o">.</span><span class="n">unique</span> <span class="p">{</span> <span class="n">it</span> <span class="o">%</span> <span class="mi">2</span> <span class="p">}</span>
    <span class="o">.</span><span class="n">subscribe</span> <span class="p">{</span> <span class="n">println</span> <span class="n">it</span> <span class="p">}</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mi">1</span>
<span class="mi">4</span>
</pre></div>
</div>
</div>
<div class="section" id="distinct">
<h3>distinct<a class="headerlink" href="#distinct" title="永久链接至标题">¶</a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">distinct</span></code> operator allows you to remove <cite>consecutive</cite> duplicated items from a channel, so that each emitted item
is different from the preceding one. For example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Channel</span>
    <span class="o">.</span><span class="n">from</span><span class="p">(</span> <span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span> <span class="p">)</span>
    <span class="o">.</span><span class="n">distinct</span><span class="p">()</span>
    <span class="o">.</span><span class="n">subscribe</span> <span class="n">onNext</span><span class="p">:</span> <span class="p">{</span> <span class="n">println</span> <span class="n">it</span> <span class="p">},</span> <span class="n">onComplete</span><span class="p">:</span> <span class="p">{</span> <span class="n">println</span> <span class="s1">&#39;Done&#39;</span> <span class="p">}</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mi">1</span>
<span class="mi">2</span>
<span class="mi">3</span>
<span class="mi">1</span>
<span class="mi">2</span>
<span class="mi">3</span>
<span class="n">Done</span>
</pre></div>
</div>
<p>You can also specify an optional <a class="reference internal" href="script.html#script-closure"><span class="std std-ref">closure</span></a> that customizes the way it distinguishes between distinct items.
For example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Channel</span>
    <span class="o">.</span><span class="n">from</span><span class="p">(</span> <span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">6</span> <span class="p">)</span>
    <span class="o">.</span><span class="n">distinct</span> <span class="p">{</span> <span class="n">it</span> <span class="o">%</span> <span class="mi">2</span> <span class="p">}</span>
    <span class="o">.</span><span class="n">subscribe</span> <span class="n">onNext</span><span class="p">:</span> <span class="p">{</span> <span class="n">println</span> <span class="n">it</span> <span class="p">},</span> <span class="n">onComplete</span><span class="p">:</span> <span class="p">{</span> <span class="n">println</span> <span class="s1">&#39;Done&#39;</span> <span class="p">}</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mi">1</span>
<span class="mi">2</span>
<span class="mi">3</span>
<span class="mi">2</span>
<span class="n">Done</span>
</pre></div>
</div>
</div>
<div class="section" id="first">
<span id="operator-first"></span><h3>first<a class="headerlink" href="#first" title="永久链接至标题">¶</a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">first</span></code> operator creates a channel that returns the first item emitted by the source channel, or eventually
the first item that matches an optional condition. The condition can be specified by using a <a class="reference internal" href="script.html#script-regexp"><span class="std std-ref">regular expression</span></a>,
a Java <cite>class</cite> type or any boolean <cite>predicate</cite>. For example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">//</span> <span class="n">no</span> <span class="n">condition</span> <span class="ow">is</span> <span class="n">specified</span><span class="p">,</span> <span class="n">emits</span> <span class="n">the</span> <span class="n">very</span> <span class="n">first</span> <span class="n">item</span><span class="p">:</span> <span class="mi">1</span>
<span class="n">Channel</span>
    <span class="o">.</span><span class="n">from</span><span class="p">(</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span> <span class="p">)</span>
    <span class="o">.</span><span class="n">first</span><span class="p">()</span>
    <span class="o">.</span><span class="n">subscribe</span> <span class="p">{</span> <span class="n">println</span> <span class="n">it</span> <span class="p">}</span>


<span class="o">//</span> <span class="n">emits</span> <span class="n">the</span> <span class="n">first</span> <span class="n">String</span> <span class="n">value</span><span class="p">:</span> <span class="s1">&#39;a&#39;</span>
<span class="n">Channel</span>
    <span class="o">.</span><span class="n">from</span><span class="p">(</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="mi">3</span> <span class="p">)</span>
    <span class="o">.</span><span class="n">first</span><span class="p">(</span> <span class="n">String</span> <span class="p">)</span>
    <span class="o">.</span><span class="n">subscribe</span> <span class="p">{</span> <span class="n">println</span> <span class="n">it</span> <span class="p">}</span>

<span class="o">//</span> <span class="n">emits</span> <span class="n">the</span> <span class="n">first</span> <span class="n">item</span> <span class="n">matching</span> <span class="n">the</span> <span class="n">regular</span> <span class="n">expression</span><span class="p">:</span> <span class="s1">&#39;aa&#39;</span>
<span class="n">Channel</span>
    <span class="o">.</span><span class="n">from</span><span class="p">(</span> <span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;aa&#39;</span><span class="p">,</span> <span class="s1">&#39;aaa&#39;</span> <span class="p">)</span>
    <span class="o">.</span><span class="n">first</span><span class="p">(</span> <span class="o">~/</span><span class="n">aa</span><span class="o">.*/</span> <span class="p">)</span>
    <span class="o">.</span><span class="n">subscribe</span> <span class="p">{</span> <span class="n">println</span> <span class="n">it</span> <span class="p">}</span>

<span class="o">//</span> <span class="n">emits</span> <span class="n">the</span> <span class="n">first</span> <span class="n">item</span> <span class="k">for</span> <span class="n">which</span> <span class="n">the</span> <span class="n">predicate</span> <span class="n">evaluates</span> <span class="n">to</span> <span class="n">true</span><span class="p">:</span> <span class="mi">4</span>
<span class="n">Channel</span>
    <span class="o">.</span><span class="n">from</span><span class="p">(</span> <span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span> <span class="p">)</span>
    <span class="o">.</span><span class="n">first</span> <span class="p">{</span> <span class="n">it</span> <span class="o">&gt;</span> <span class="mi">3</span> <span class="p">}</span>
    <span class="o">.</span><span class="n">subscribe</span> <span class="p">{</span> <span class="n">println</span> <span class="n">it</span> <span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="randomsample">
<h3>randomSample<a class="headerlink" href="#randomsample" title="永久链接至标题">¶</a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">randomSample</span></code> operator allows you to create a channel emitting the specified number of items randomly taken
from the channel to which is applied. For example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Channel</span>
      <span class="o">.</span><span class="n">from</span><span class="p">(</span> <span class="mf">1.</span><span class="o">.</span><span class="mi">100</span> <span class="p">)</span>
      <span class="o">.</span><span class="n">randomSample</span><span class="p">(</span> <span class="mi">10</span> <span class="p">)</span>
      <span class="o">.</span><span class="n">println</span><span class="p">()</span>
</pre></div>
</div>
<p>The above snippet will print 10 numbers in the range from 1 to 100.</p>
<p>The operator supports a second parameter that allows to set the initial <cite>seed</cite> for the random number generator.
By setting it, the <code class="docutils literal notranslate"><span class="pre">randomSample</span></code> operator will always return the same pseudo-random sequence. For example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Channel</span>
      <span class="o">.</span><span class="n">from</span><span class="p">(</span> <span class="mf">1.</span><span class="o">.</span><span class="mi">100</span> <span class="p">)</span>
      <span class="o">.</span><span class="n">randomSample</span><span class="p">(</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">234</span> <span class="p">)</span>
      <span class="o">.</span><span class="n">println</span><span class="p">()</span>
</pre></div>
</div>
<p>The above example will print 10 random numbers in the range between 1 and 100. At each run of the script, the same
sequence will be returned.</p>
</div>
<div class="section" id="take">
<h3>take<a class="headerlink" href="#take" title="永久链接至标题">¶</a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">take</span></code> operator allows you to filter only the first <cite>n</cite> items emitted by a channel. For example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Channel</span>
    <span class="o">.</span><span class="n">from</span><span class="p">(</span> <span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span> <span class="p">)</span>
    <span class="o">.</span><span class="n">take</span><span class="p">(</span> <span class="mi">3</span> <span class="p">)</span>
    <span class="o">.</span><span class="n">subscribe</span> <span class="n">onNext</span><span class="p">:</span> <span class="p">{</span> <span class="n">println</span> <span class="n">it</span> <span class="p">},</span> <span class="n">onComplete</span><span class="p">:</span> <span class="p">{</span> <span class="n">println</span> <span class="s1">&#39;Done&#39;</span> <span class="p">}</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mi">1</span>
<span class="mi">2</span>
<span class="mi">3</span>
<span class="n">Done</span>
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">注解</p>
<p class="last">By specifying the value <code class="docutils literal notranslate"><span class="pre">-1</span></code> the operator takes all values.</p>
</div>
<p>See also <a class="reference internal" href="#until">until</a>.</p>
</div>
<div class="section" id="last">
<span id="operator-last"></span><h3>last<a class="headerlink" href="#last" title="永久链接至标题">¶</a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">last</span></code> operator creates a channel that only returns the last item emitted by the source channel. For example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Channel</span>
    <span class="o">.</span><span class="n">from</span><span class="p">(</span> <span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span> <span class="p">)</span>
    <span class="o">.</span><span class="n">last</span><span class="p">()</span>
    <span class="o">.</span><span class="n">subscribe</span> <span class="p">{</span> <span class="n">println</span> <span class="n">it</span> <span class="p">}</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mi">6</span>
</pre></div>
</div>
</div>
<div class="section" id="until">
<h3>until<a class="headerlink" href="#until" title="永久链接至标题">¶</a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">until</span></code> operator creates a channel that returns the items emitted by the source channel and stop when
the condition specified is verified. For example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Channel</span>
    <span class="o">.</span><span class="n">from</span><span class="p">(</span> <span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">5</span> <span class="p">)</span>
    <span class="o">.</span><span class="n">until</span><span class="p">{</span> <span class="n">it</span><span class="o">==</span><span class="mi">5</span> <span class="p">}</span>
    <span class="o">.</span><span class="n">println</span><span class="p">()</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mi">3</span>
<span class="mi">2</span>
<span class="mi">1</span>
</pre></div>
</div>
<p>See also <a class="reference internal" href="#take">take</a>.</p>
</div>
</div>
<div class="section" id="transforming-operators">
<h2>Transforming operators<a class="headerlink" href="#transforming-operators" title="永久链接至标题">¶</a></h2>
<p>Transforming operators are used to transform the items emitted by a channel to new values.</p>
<p>These operators are:</p>
<ul class="simple">
<li><a class="reference internal" href="#buffer">buffer</a></li>
<li><a class="reference internal" href="#collate">collate</a></li>
<li><a class="reference internal" href="#collect">collect</a></li>
<li><a class="reference internal" href="#flatten">flatten</a></li>
<li><a class="reference internal" href="#flatmap">flatMap</a></li>
<li><a class="reference internal" href="#groupby">groupBy</a></li>
<li><a class="reference internal" href="#grouptuple">groupTuple</a></li>
<li><a class="reference internal" href="#map">map</a></li>
<li><a class="reference internal" href="#reduce">reduce</a></li>
<li><a class="reference internal" href="#tolist">toList</a></li>
<li><a class="reference internal" href="#tosortedlist">toSortedList</a></li>
<li><a class="reference internal" href="#transpose">transpose</a></li>
</ul>
<div class="section" id="map">
<span id="operator-map"></span><h3>map<a class="headerlink" href="#map" title="永久链接至标题">¶</a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">map</span></code> operator applies a function of your choosing to every item emitted by a channel, and
returns the items so obtained as a new channel. The function applied is called the <cite>mapping</cite> function
and is expressed with a <a class="reference internal" href="script.html#script-closure"><span class="std std-ref">closure</span></a> as shown in the example below:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Channel</span>
    <span class="o">.</span><span class="n">from</span><span class="p">(</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span> <span class="p">)</span>
    <span class="o">.</span><span class="n">map</span> <span class="p">{</span> <span class="n">it</span> <span class="o">*</span> <span class="n">it</span> <span class="p">}</span>
    <span class="o">.</span><span class="n">subscribe</span> <span class="n">onNext</span><span class="p">:</span> <span class="p">{</span> <span class="n">println</span> <span class="n">it</span> <span class="p">},</span> <span class="n">onComplete</span><span class="p">:</span> <span class="p">{</span> <span class="n">println</span> <span class="s1">&#39;Done&#39;</span> <span class="p">}</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mi">1</span>
<span class="mi">4</span>
<span class="mi">9</span>
<span class="mi">16</span>
<span class="mi">25</span>
<span class="n">Done</span>
</pre></div>
</div>
</div>
<div class="section" id="flatmap">
<span id="operator-flatmap"></span><h3>flatMap<a class="headerlink" href="#flatmap" title="永久链接至标题">¶</a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">flatMap</span></code> operator applies a function of your choosing to every item emitted by a channel, and
returns the items so obtained as a new channel. Whenever the <cite>mapping</cite> function returns a list of items,
this list is flattened so that each single item is emitted on its own.</p>
<p>For example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">//</span> <span class="n">create</span> <span class="n">a</span> <span class="n">channel</span> <span class="n">of</span> <span class="n">numbers</span>
<span class="n">numbers</span> <span class="o">=</span> <span class="n">Channel</span><span class="o">.</span><span class="n">from</span><span class="p">(</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span> <span class="p">)</span>

<span class="o">//</span> <span class="nb">map</span> <span class="n">each</span> <span class="n">number</span> <span class="n">to</span> <span class="n">a</span> <span class="nb">tuple</span> <span class="p">(</span><span class="n">array</span><span class="p">),</span> <span class="n">which</span> <span class="n">items</span> <span class="n">are</span> <span class="n">emitted</span> <span class="n">separately</span>
<span class="n">results</span> <span class="o">=</span> <span class="n">numbers</span><span class="o">.</span><span class="n">flatMap</span> <span class="p">{</span> <span class="n">n</span> <span class="o">-&gt;</span> <span class="p">[</span> <span class="n">n</span><span class="o">*</span><span class="mi">2</span><span class="p">,</span> <span class="n">n</span><span class="o">*</span><span class="mi">3</span> <span class="p">]</span> <span class="p">}</span>

<span class="o">//</span> <span class="nb">print</span> <span class="n">the</span> <span class="n">final</span> <span class="n">results</span>
<span class="n">results</span><span class="o">.</span><span class="n">subscribe</span> <span class="n">onNext</span><span class="p">:</span> <span class="p">{</span> <span class="n">println</span> <span class="n">it</span> <span class="p">},</span> <span class="n">onComplete</span><span class="p">:</span> <span class="p">{</span> <span class="n">println</span> <span class="s1">&#39;Done&#39;</span> <span class="p">}</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mi">2</span>
<span class="mi">3</span>
<span class="mi">4</span>
<span class="mi">6</span>
<span class="mi">6</span>
<span class="mi">9</span>
<span class="n">Done</span>
</pre></div>
</div>
<p>Associative arrays are handled in the same way, so that each array entry is emitted as a single <cite>key-value</cite> item. For example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Channel</span><span class="o">.</span><span class="kn">from</span> <span class="p">(</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span> <span class="p">)</span>
       <span class="o">.</span><span class="n">flatMap</span> <span class="p">{</span> <span class="n">it</span> <span class="o">-&gt;</span> <span class="p">[</span> <span class="n">number</span><span class="p">:</span> <span class="n">it</span><span class="p">,</span> <span class="n">square</span><span class="p">:</span> <span class="n">it</span><span class="o">*</span><span class="n">it</span> <span class="p">]</span> <span class="p">}</span>
       <span class="o">.</span><span class="n">subscribe</span> <span class="p">{</span> <span class="n">println</span> <span class="n">it</span><span class="o">.</span><span class="n">key</span> <span class="o">+</span> <span class="s1">&#39;: &#39;</span> <span class="o">+</span> <span class="n">it</span><span class="o">.</span><span class="n">value</span> <span class="p">}</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">number</span><span class="p">:</span> <span class="mi">1</span>
<span class="n">square</span><span class="p">:</span> <span class="mi">1</span>
<span class="n">number</span><span class="p">:</span> <span class="mi">2</span>
<span class="n">square</span><span class="p">:</span> <span class="mi">4</span>
<span class="n">number</span><span class="p">:</span> <span class="mi">3</span>
<span class="n">square</span><span class="p">:</span> <span class="mi">9</span>
</pre></div>
</div>
</div>
<div class="section" id="reduce">
<span id="operator-reduce"></span><h3>reduce<a class="headerlink" href="#reduce" title="永久链接至标题">¶</a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">reduce</span></code> operator applies a function of your choosing to every item emitted by a channel.
Each time this function is invoked it takes two parameters: firstly the <cite>i-th</cite> emitted item
and secondly the result of the previous invocation of the function itself. The result is
passed on to the next function call, along with the <cite>i+1 th</cite> item, until all the items are
processed.</p>
<p>Finally, the <code class="docutils literal notranslate"><span class="pre">reduce</span></code> operator emits the result of the last invocation of your function
as the sole output.</p>
<p>For example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Channel</span>
    <span class="o">.</span><span class="n">from</span><span class="p">(</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span> <span class="p">)</span>
    <span class="o">.</span><span class="n">reduce</span> <span class="p">{</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span> <span class="o">-&gt;</span> <span class="n">println</span> <span class="s2">&quot;a: $a b: $b&quot;</span><span class="p">;</span> <span class="k">return</span> <span class="n">a</span><span class="o">+</span><span class="n">b</span> <span class="p">}</span>
    <span class="o">.</span><span class="n">subscribe</span> <span class="p">{</span> <span class="n">println</span> <span class="s2">&quot;result = $it&quot;</span> <span class="p">}</span>
</pre></div>
</div>
<p>It prints the following output:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">a</span><span class="p">:</span> <span class="mi">1</span>    <span class="n">b</span><span class="p">:</span> <span class="mi">2</span>
<span class="n">a</span><span class="p">:</span> <span class="mi">3</span>    <span class="n">b</span><span class="p">:</span> <span class="mi">3</span>
<span class="n">a</span><span class="p">:</span> <span class="mi">6</span>    <span class="n">b</span><span class="p">:</span> <span class="mi">4</span>
<span class="n">a</span><span class="p">:</span> <span class="mi">10</span>   <span class="n">b</span><span class="p">:</span> <span class="mi">5</span>
<span class="n">result</span> <span class="o">=</span> <span class="mi">15</span>
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">注解</p>
<p class="last">In a common usage scenario the first function parameter is used as an <cite>accumulator</cite> and
the second parameter represents the <cite>i-th</cite> item to be processed.</p>
</div>
<p>Optionally you can specify a <cite>seed</cite> value in order to initialise the accumulator parameter
as shown below:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">myChannel</span><span class="o">.</span><span class="n">reduce</span><span class="p">(</span> <span class="n">seedValue</span> <span class="p">)</span> <span class="p">{</span>  <span class="n">a</span><span class="p">,</span> <span class="n">b</span> <span class="o">-&gt;</span> <span class="o">...</span> <span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="groupby">
<h3>groupBy<a class="headerlink" href="#groupby" title="永久链接至标题">¶</a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">groupBy</span></code> operator collects the values emitted by the source channel grouping them together using a <cite>mapping</cite>
function that associates each item with a key. When finished, it emits an associative
array that maps each key to the set of items identified by that key.</p>
<p>For example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Channel</span>
    <span class="o">.</span><span class="n">from</span><span class="p">(</span><span class="s1">&#39;hello&#39;</span><span class="p">,</span><span class="s1">&#39;ciao&#39;</span><span class="p">,</span><span class="s1">&#39;hola&#39;</span><span class="p">,</span> <span class="s1">&#39;hi&#39;</span><span class="p">,</span> <span class="s1">&#39;bonjour&#39;</span><span class="p">)</span>
    <span class="o">.</span><span class="n">groupBy</span> <span class="p">{</span> <span class="n">String</span> <span class="nb">str</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="p">}</span>
    <span class="o">.</span><span class="n">subscribe</span> <span class="p">{</span> <span class="n">println</span> <span class="n">it</span> <span class="p">}</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[</span> <span class="n">b</span><span class="p">:[</span><span class="s1">&#39;bonjour&#39;</span><span class="p">],</span> <span class="n">c</span><span class="p">:[</span><span class="s1">&#39;ciao&#39;</span><span class="p">],</span> <span class="n">h</span><span class="p">:[</span><span class="s1">&#39;hello&#39;</span><span class="p">,</span><span class="s1">&#39;hola&#39;</span><span class="p">,</span><span class="s1">&#39;hi&#39;</span><span class="p">]</span> <span class="p">]</span>
</pre></div>
</div>
<p>The <cite>mapping</cite> function is an optional parameter. When omitted the values are grouped
following these rules:</p>
<ul class="simple">
<li>Any value of type <code class="docutils literal notranslate"><span class="pre">Map</span></code> is associated with the value of its first entry, or <code class="docutils literal notranslate"><span class="pre">null</span></code> when the map itself is empty.</li>
<li>Any value of type <code class="docutils literal notranslate"><span class="pre">Map.Entry</span></code> is associated with the value of its <code class="docutils literal notranslate"><span class="pre">key</span></code> attribute.</li>
<li>Any value of type <code class="docutils literal notranslate"><span class="pre">Collection</span></code> or <code class="docutils literal notranslate"><span class="pre">Array</span></code> is associated with its first entry.</li>
<li>For any other value, the value itself is used as a key.</li>
</ul>
</div>
<div class="section" id="grouptuple">
<h3>groupTuple<a class="headerlink" href="#grouptuple" title="永久链接至标题">¶</a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">groupTuple</span></code> operator collects tuples (or lists) of values emitted by the source channel grouping together the
elements that share the same key. Finally it emits a new tuple object for each distinct key collected.</p>
<p>In other words transform a sequence of tuple like <em>(K, V, W, ..)</em> into a new channel emitting a sequence of
<em>(K, list(V), list(W), ..)</em></p>
<p>For example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Channel</span>
     <span class="o">.</span><span class="n">from</span><span class="p">(</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="s1">&#39;A&#39;</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="s1">&#39;B&#39;</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="s1">&#39;C&#39;</span><span class="p">],</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="s1">&#39;C&#39;</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;A&#39;</span><span class="p">],</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="s1">&#39;D&#39;</span><span class="p">]</span> <span class="p">)</span>
     <span class="o">.</span><span class="n">groupTuple</span><span class="p">()</span>
     <span class="o">.</span><span class="n">subscribe</span> <span class="p">{</span> <span class="n">println</span> <span class="n">it</span> <span class="p">}</span>
</pre></div>
</div>
<p>It prints:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="p">[</span><span class="n">A</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="n">C</span><span class="p">]]</span>
<span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="p">[</span><span class="n">C</span><span class="p">,</span> <span class="n">A</span><span class="p">]]</span>
<span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="p">[</span><span class="n">B</span><span class="p">,</span> <span class="n">D</span><span class="p">]]</span>
</pre></div>
</div>
<p>By default the first entry in the tuple is used a the grouping key. A different key can be chosen by using the
<code class="docutils literal notranslate"><span class="pre">by</span></code> parameter and specifying the index of entry to be used as key (the index is zero-based). For example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Channel</span>
     <span class="o">.</span><span class="n">from</span><span class="p">(</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="s1">&#39;A&#39;</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="s1">&#39;B&#39;</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="s1">&#39;C&#39;</span><span class="p">],</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="s1">&#39;C&#39;</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;A&#39;</span><span class="p">],</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="s1">&#39;D&#39;</span><span class="p">]</span> <span class="p">)</span>
     <span class="o">.</span><span class="n">groupTuple</span><span class="p">(</span><span class="n">by</span><span class="p">:</span> <span class="mi">1</span><span class="p">)</span>
     <span class="o">.</span><span class="n">subscribe</span> <span class="p">{</span> <span class="n">println</span> <span class="n">it</span> <span class="p">}</span>
</pre></div>
</div>
<p>Grouping by the second value in each tuple the result is:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="n">A</span><span class="p">]</span>
<span class="p">[[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="n">B</span><span class="p">]</span>
<span class="p">[[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">C</span><span class="p">]</span>
<span class="p">[[</span><span class="mi">3</span><span class="p">],</span> <span class="n">D</span><span class="p">]</span>
</pre></div>
</div>
<p>Available parameters:</p>
<table border="1" class="docutils">
<colgroup>
<col width="8%" />
<col width="92%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Field</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>by</td>
<td>The index (zero based) of the element to be used as grouping key.
A key composed by multiple elements can be defined specifying a list of indices e.g. <code class="docutils literal notranslate"><span class="pre">by:</span> <span class="pre">[0,2]</span></code></td>
</tr>
<tr class="row-odd"><td>sort</td>
<td>Defines the sorting criteria for the grouped items. See below for available sorting options.</td>
</tr>
<tr class="row-even"><td>size</td>
<td>The number of items the grouped list(s) has to contain. When the specified size is reached, the tuple is emitted.</td>
</tr>
<tr class="row-odd"><td>remainder</td>
<td>When <code class="docutils literal notranslate"><span class="pre">false</span></code> incomplete tuples (i.e. with less than <cite>size</cite> grouped items)
are discarded (default). When <code class="docutils literal notranslate"><span class="pre">true</span></code> incomplete tuples are emitted as the ending emission. Only valid when a <code class="docutils literal notranslate"><span class="pre">size</span></code> parameter
is specified.</td>
</tr>
</tbody>
</table>
<p>Sorting options:</p>
<table border="1" class="docutils">
<colgroup>
<col width="7%" />
<col width="93%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Sort</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>false</td>
<td>No sorting is applied (default).</td>
</tr>
<tr class="row-odd"><td>true</td>
<td>Order the grouped items by the item natural ordering i.e. numerical for number, lexicographic for string, etc. See <a class="reference external" href="http://docs.oracle.com/javase/tutorial/collections/interfaces/order.html">http://docs.oracle.com/javase/tutorial/collections/interfaces/order.html</a></td>
</tr>
<tr class="row-even"><td>hash</td>
<td>Order the grouped items by the hash number associated to each entry.</td>
</tr>
<tr class="row-odd"><td>deep</td>
<td>Similar to the previous, but the hash number is created on actual entries content e.g. when the item is a file the hash is created on the actual file content.</td>
</tr>
<tr class="row-even"><td><cite>custom</cite></td>
<td>A custom sorting criteria can be specified by using either a <a class="reference internal" href="script.html#script-closure"><span class="std std-ref">Closure</span></a> or a <a class="reference external" href="http://docs.oracle.com/javase/7/docs/api/java/util/Comparator.html">Comparator</a> object.</td>
</tr>
</tbody>
</table>
<div class="admonition tip">
<p class="first admonition-title">小技巧</p>
<p class="last">You should always specify the number of expected element in each tuple using the <code class="docutils literal notranslate"><span class="pre">size</span></code> attribute
to allow the <code class="docutils literal notranslate"><span class="pre">groupTuple</span></code> operator to stream the collected values as soon as possible. However there
are use cases in which each tuple has a different size depending grouping key. In this cases use the
built-in function <code class="docutils literal notranslate"><span class="pre">groupKey</span></code> that allows you to create a special grouping key object to which it’s possible
to associate the group size for a given key.</p>
</div>
</div>
<div class="section" id="buffer">
<h3>buffer<a class="headerlink" href="#buffer" title="永久链接至标题">¶</a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">buffer</span></code> operator gathers the items emitted by the source channel into subsets and emits these subsets separately.</p>
<p>There are a number of ways you can regulate how <code class="docutils literal notranslate"><span class="pre">buffer</span></code> gathers the items from
the source channel into subsets:</p>
<ul>
<li><p class="first"><code class="docutils literal notranslate"><span class="pre">buffer(</span> <span class="pre">closingCondition</span> <span class="pre">)</span></code>: starts to collect the items emitted by the channel into
a subset until the <cite>closing condition</cite> is verified. After that the subset is emitted
to the resulting channel and new items are gathered into a new subset. The process is repeated
until the last value in the source channel is sent. The <code class="docutils literal notranslate"><span class="pre">closingCondition</span></code> can be specified
either as a <a class="reference internal" href="script.html#script-regexp"><span class="std std-ref">regular expression</span></a>, a Java class, a literal value, or a <cite>boolean predicate</cite>
that has to be satisfied. For example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Channel</span>
    <span class="o">.</span><span class="n">from</span><span class="p">(</span> <span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span> <span class="p">)</span>
    <span class="o">.</span><span class="n">buffer</span> <span class="p">{</span> <span class="n">it</span> <span class="o">==</span> <span class="mi">2</span> <span class="p">}</span>
    <span class="o">.</span><span class="n">subscribe</span> <span class="p">{</span>  <span class="n">println</span> <span class="n">it</span> <span class="p">}</span>

<span class="o">//</span> <span class="n">emitted</span> <span class="n">values</span>
<span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">]</span>
<span class="p">[</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">]</span>
</pre></div>
</div>
</li>
<li><p class="first"><code class="docutils literal notranslate"><span class="pre">buffer(</span> <span class="pre">openingCondition,</span> <span class="pre">closingCondition</span> <span class="pre">)</span></code>: starts to gather the items emitted by the channel
as soon as one of the them verify the <cite>opening condition</cite> and it continues until there is one item
which verify the <cite>closing condition</cite>. After that the subset is emitted and it continues applying the
described logic until the last channel item is emitted.
Both conditions can be defined either as a <a class="reference internal" href="script.html#script-regexp"><span class="std std-ref">regular expression</span></a>, a literal value,
a Java class, or a <cite>boolean predicate</cite> that need to be satisfied. For example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Channel</span>
    <span class="o">.</span><span class="n">from</span><span class="p">(</span> <span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span> <span class="p">)</span>
    <span class="o">.</span><span class="n">buffer</span><span class="p">(</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">4</span> <span class="p">)</span>
    <span class="o">.</span><span class="n">subscribe</span> <span class="p">{</span>  <span class="n">println</span> <span class="n">it</span> <span class="p">}</span>

<span class="o">//</span> <span class="n">emits</span> <span class="n">bundles</span> <span class="n">starting</span> <span class="k">with</span> <span class="s1">&#39;2&#39;</span> <span class="ow">and</span> <span class="n">ending</span> <span class="k">with</span><span class="s1">&#39;4&#39;</span>
<span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">]</span>
<span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">]</span>
</pre></div>
</div>
</li>
<li><p class="first"><code class="docutils literal notranslate"><span class="pre">buffer(</span> <span class="pre">size:</span> <span class="pre">n</span> <span class="pre">)</span></code>: transform the source channel in such a way that it emits tuples
made up of <code class="docutils literal notranslate"><span class="pre">n</span></code> elements. An incomplete tuple is discarded. For example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Channel</span>
    <span class="o">.</span><span class="n">from</span><span class="p">(</span> <span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span> <span class="p">)</span>
    <span class="o">.</span><span class="n">buffer</span><span class="p">(</span> <span class="n">size</span><span class="p">:</span> <span class="mi">2</span> <span class="p">)</span>
    <span class="o">.</span><span class="n">subscribe</span> <span class="p">{</span>  <span class="n">println</span> <span class="n">it</span> <span class="p">}</span>

<span class="o">//</span> <span class="n">emitted</span> <span class="n">values</span>
<span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span>
<span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
<span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]</span>
</pre></div>
</div>
</li>
</ul>
<p>If you want to emit the last items in a tuple containing less than <code class="docutils literal notranslate"><span class="pre">n</span></code> elements, simply
add the parameter <code class="docutils literal notranslate"><span class="pre">remainder</span></code> specifying <code class="docutils literal notranslate"><span class="pre">true</span></code>, for example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Channel</span>
    <span class="o">.</span><span class="n">from</span><span class="p">(</span> <span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span> <span class="p">)</span>
    <span class="o">.</span><span class="n">buffer</span><span class="p">(</span> <span class="n">size</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="n">remainder</span><span class="p">:</span> <span class="n">true</span> <span class="p">)</span>
    <span class="o">.</span><span class="n">subscribe</span> <span class="p">{</span>  <span class="n">println</span> <span class="n">it</span> <span class="p">}</span>

<span class="o">//</span> <span class="n">emitted</span> <span class="n">values</span>
<span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span>
<span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
<span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]</span>
<span class="p">[</span><span class="mi">1</span><span class="p">]</span>
</pre></div>
</div>
<ul>
<li><p class="first"><code class="docutils literal notranslate"><span class="pre">buffer(</span> <span class="pre">size:</span> <span class="pre">n,</span> <span class="pre">skip:</span> <span class="pre">m</span> <span class="pre">)</span></code>: as in the previous example, it emits tuples containing <code class="docutils literal notranslate"><span class="pre">n</span></code> elements,
but skips <cite>m</cite> values before starting to collect the values for the next tuple (including the first emission). For example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Channel</span>
    <span class="o">.</span><span class="n">from</span><span class="p">(</span> <span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span> <span class="p">)</span>
    <span class="o">.</span><span class="n">buffer</span><span class="p">(</span> <span class="n">size</span><span class="p">:</span><span class="mi">3</span><span class="p">,</span> <span class="n">skip</span><span class="p">:</span><span class="mi">2</span> <span class="p">)</span>
    <span class="o">.</span><span class="n">subscribe</span> <span class="p">{</span>  <span class="n">println</span> <span class="n">it</span> <span class="p">}</span>

<span class="o">//</span> <span class="n">emitted</span> <span class="n">values</span>
<span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">]</span>
<span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">]</span>
</pre></div>
</div>
</li>
</ul>
<p>If you want to emit the remaining items in a tuple containing less than <code class="docutils literal notranslate"><span class="pre">n</span></code> elements, simply
add the parameter <code class="docutils literal notranslate"><span class="pre">remainder</span></code> specifying <code class="docutils literal notranslate"><span class="pre">true</span></code>, as shown in the previous example.</p>
<p>See also: <a class="reference internal" href="#collate">collate</a> operator.</p>
</div>
<div class="section" id="collate">
<h3>collate<a class="headerlink" href="#collate" title="永久链接至标题">¶</a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">collate</span></code> operator transforms a channel in such a way that the emitted values are grouped in tuples containing <cite>n</cite> items. For example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Channel</span>
    <span class="o">.</span><span class="n">from</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
    <span class="o">.</span><span class="n">collate</span><span class="p">(</span> <span class="mi">3</span> <span class="p">)</span>
    <span class="o">.</span><span class="n">subscribe</span> <span class="p">{</span> <span class="n">println</span> <span class="n">it</span> <span class="p">}</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]</span>
<span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]</span>
<span class="p">[</span><span class="mi">1</span><span class="p">]</span>
</pre></div>
</div>
<p>As shown in the above example the last tuple may be incomplete e.g. contain less elements than the specified size.
If you want to avoid this, specify <code class="docutils literal notranslate"><span class="pre">false</span></code> as the second parameter. For example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Channel</span>
    <span class="o">.</span><span class="n">from</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
    <span class="o">.</span><span class="n">collate</span><span class="p">(</span> <span class="mi">3</span><span class="p">,</span> <span class="n">false</span> <span class="p">)</span>
    <span class="o">.</span><span class="n">subscribe</span> <span class="p">{</span> <span class="n">println</span> <span class="n">it</span> <span class="p">}</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]</span>
<span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]</span>
</pre></div>
</div>
<p>A second version of the <code class="docutils literal notranslate"><span class="pre">collate</span></code> operator allows you to specify, after the <cite>size</cite>, the <cite>step</cite> by which elements
are collected in tuples. For example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Channel</span>
  <span class="o">.</span><span class="n">from</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span>
  <span class="o">.</span><span class="n">collate</span><span class="p">(</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span> <span class="p">)</span>
  <span class="o">.</span><span class="n">subscribe</span> <span class="p">{</span> <span class="n">println</span> <span class="n">it</span> <span class="p">}</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]</span>
<span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">]</span>
<span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">]</span>
<span class="p">[</span><span class="mi">4</span><span class="p">]</span>
</pre></div>
</div>
<p>As before, if you don’t want to emit the last items which do not complete a tuple, specify <code class="docutils literal notranslate"><span class="pre">false</span></code> as the third parameter.</p>
<p>See also: <a class="reference internal" href="#buffer">buffer</a> operator.</p>
</div>
<div class="section" id="collect">
<span id="operator-collect"></span><h3>collect<a class="headerlink" href="#collect" title="永久链接至标题">¶</a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">collect</span></code> operator collects all the items emitted by a channel to a <code class="docutils literal notranslate"><span class="pre">List</span></code> and return
the resulting object as a sole emission. For example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Channel</span>
    <span class="o">.</span><span class="n">from</span><span class="p">(</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span> <span class="p">)</span>
    <span class="o">.</span><span class="n">collect</span><span class="p">()</span>
    <span class="o">.</span><span class="n">println</span><span class="p">()</span>

<span class="c1"># outputs</span>
<span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">]</span>
</pre></div>
</div>
<p>An optional <a class="reference internal" href="script.html#script-closure"><span class="std std-ref">closure</span></a> can be specified to transform each item before adding it to the resulting list.
For example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Channel</span>
    <span class="o">.</span><span class="n">from</span><span class="p">(</span> <span class="s1">&#39;hello&#39;</span><span class="p">,</span> <span class="s1">&#39;ciao&#39;</span><span class="p">,</span> <span class="s1">&#39;bonjour&#39;</span> <span class="p">)</span>
    <span class="o">.</span><span class="n">collect</span> <span class="p">{</span> <span class="n">it</span><span class="o">.</span><span class="n">length</span><span class="p">()</span> <span class="p">}</span>
    <span class="o">.</span><span class="n">println</span><span class="p">()</span>

<span class="c1"># outputs</span>
<span class="p">[</span><span class="mi">5</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">7</span><span class="p">]</span>
</pre></div>
</div>
<p>See also: <a class="reference internal" href="#tolist">toList</a> and <a class="reference internal" href="#tosortedlist">toSortedList</a> operator.</p>
</div>
<div class="section" id="flatten">
<h3>flatten<a class="headerlink" href="#flatten" title="永久链接至标题">¶</a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">flatten</span></code> operator transforms a channel in such a way that every item of type <code class="docutils literal notranslate"><span class="pre">Collection</span></code> or <code class="docutils literal notranslate"><span class="pre">Array</span></code>
is flattened so that each single entry is emitted separately by the resulting channel. For example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Channel</span>
    <span class="o">.</span><span class="n">from</span><span class="p">(</span> <span class="p">[</span><span class="mi">1</span><span class="p">,[</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">]],</span> <span class="mi">4</span><span class="p">,</span> <span class="p">[</span><span class="mi">5</span><span class="p">,[</span><span class="mi">6</span><span class="p">]]</span> <span class="p">)</span>
    <span class="o">.</span><span class="n">flatten</span><span class="p">()</span>
    <span class="o">.</span><span class="n">subscribe</span> <span class="p">{</span> <span class="n">println</span> <span class="n">it</span> <span class="p">}</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mi">1</span>
<span class="mi">2</span>
<span class="mi">3</span>
<span class="mi">4</span>
<span class="mi">5</span>
<span class="mi">6</span>
</pre></div>
</div>
<p>See also: <a class="reference internal" href="#flatmap">flatMap</a> operator.</p>
</div>
<div class="section" id="tolist">
<h3>toList<a class="headerlink" href="#tolist" title="永久链接至标题">¶</a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">toList</span></code> operator collects all the items emitted by a channel to a <code class="docutils literal notranslate"><span class="pre">List</span></code> object
and emits the resulting collection as a single item. For example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Channel</span>
    <span class="o">.</span><span class="n">from</span><span class="p">(</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span> <span class="p">)</span>
    <span class="o">.</span><span class="n">toList</span><span class="p">()</span>
    <span class="o">.</span><span class="n">subscribe</span> <span class="n">onNext</span><span class="p">:</span> <span class="p">{</span> <span class="n">println</span> <span class="n">it</span> <span class="p">},</span> <span class="n">onComplete</span><span class="p">:</span> <span class="s1">&#39;Done&#39;</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">]</span>
<span class="n">Done</span>
</pre></div>
</div>
<p>See also: <a class="reference internal" href="#collect">collect</a> operator.</p>
</div>
<div class="section" id="tosortedlist">
<h3>toSortedList<a class="headerlink" href="#tosortedlist" title="永久链接至标题">¶</a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">toSortedList</span></code> operator collects all the items emitted by a channel to a <code class="docutils literal notranslate"><span class="pre">List</span></code> object where they are sorted
and emits the resulting collection as a single item. For example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Channel</span>
    <span class="o">.</span><span class="n">from</span><span class="p">(</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">4</span> <span class="p">)</span>
    <span class="o">.</span><span class="n">toSortedList</span><span class="p">()</span>
    <span class="o">.</span><span class="n">subscribe</span> <span class="n">onNext</span><span class="p">:</span> <span class="p">{</span> <span class="n">println</span> <span class="n">it</span> <span class="p">},</span> <span class="n">onComplete</span><span class="p">:</span> <span class="s1">&#39;Done&#39;</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">]</span>
<span class="n">Done</span>
</pre></div>
</div>
<p>You may also pass a comparator closure as an argument to the <code class="docutils literal notranslate"><span class="pre">toSortedList</span></code> operator to customize the sorting criteria.  For example, to sort by the second element of a tuple in descending order:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Channel</span>
    <span class="o">.</span><span class="n">from</span><span class="p">(</span> <span class="p">[</span><span class="s2">&quot;homer&quot;</span><span class="p">,</span> <span class="mi">5</span><span class="p">],</span> <span class="p">[</span><span class="s2">&quot;bart&quot;</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="s2">&quot;lisa&quot;</span><span class="p">,</span> <span class="mi">10</span><span class="p">],</span> <span class="p">[</span><span class="s2">&quot;marge&quot;</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="s2">&quot;maggie&quot;</span><span class="p">,</span> <span class="mi">7</span><span class="p">])</span>
    <span class="o">.</span><span class="n">toSortedList</span><span class="p">(</span> <span class="p">{</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span> <span class="o">-&gt;</span> <span class="n">b</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">&lt;=&gt;</span> <span class="n">a</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="p">}</span> <span class="p">)</span>
    <span class="o">.</span><span class="n">view</span><span class="p">()</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[[</span><span class="n">lisa</span><span class="p">,</span> <span class="mi">10</span><span class="p">],</span> <span class="p">[</span><span class="n">maggie</span><span class="p">,</span> <span class="mi">7</span><span class="p">],</span> <span class="p">[</span><span class="n">homer</span><span class="p">,</span> <span class="mi">5</span><span class="p">],</span> <span class="p">[</span><span class="n">marge</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="n">bart</span><span class="p">,</span> <span class="mi">2</span><span class="p">]]</span>
</pre></div>
</div>
<p>See also: <a class="reference internal" href="#collect">collect</a> operator.</p>
</div>
<div class="section" id="transpose">
<h3>transpose<a class="headerlink" href="#transpose" title="永久链接至标题">¶</a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">transpose</span></code> operator transforms a channel in such a way that the emitted items are the result of a transposition
of all tuple elements in each item. For example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Channel</span><span class="o">.</span><span class="n">from</span><span class="p">([</span>
   <span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;p&#39;</span><span class="p">,</span> <span class="s1">&#39;q&#39;</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;u&#39;</span><span class="p">,</span><span class="s1">&#39;v&#39;</span><span class="p">]</span> <span class="p">],</span>
   <span class="p">[</span><span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;s&#39;</span><span class="p">,</span> <span class="s1">&#39;t&#39;</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">,</span><span class="s1">&#39;y&#39;</span><span class="p">]</span> <span class="p">]</span>
   <span class="p">])</span>
   <span class="o">.</span><span class="n">transpose</span><span class="p">()</span>
   <span class="o">.</span><span class="n">println</span><span class="p">()</span>
</pre></div>
</div>
<p>The above snippet prints:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="n">a</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">u</span><span class="p">]</span>
<span class="p">[</span><span class="n">a</span><span class="p">,</span> <span class="n">q</span><span class="p">,</span> <span class="n">v</span><span class="p">]</span>
<span class="p">[</span><span class="n">b</span><span class="p">,</span> <span class="n">s</span><span class="p">,</span> <span class="n">x</span><span class="p">]</span>
<span class="p">[</span><span class="n">b</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">y</span><span class="p">]</span>
</pre></div>
</div>
<p>Available parameters:</p>
<table border="1" class="docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Field</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>by</td>
<td>The index (zero based) of the element to be transposed.
Multiple elements can be defined specifying as list of indices e.g. <code class="docutils literal notranslate"><span class="pre">by:</span> <span class="pre">[0,2]</span></code></td>
</tr>
<tr class="row-odd"><td>remainder</td>
<td>When <code class="docutils literal notranslate"><span class="pre">false</span></code> incomplete tuples are discarded (default). When <code class="docutils literal notranslate"><span class="pre">true</span></code> incomplete tuples are emitted
containing a <cite>null</cite> in place of a missing element.</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="section" id="splitting-operators">
<h2>Splitting operators<a class="headerlink" href="#splitting-operators" title="永久链接至标题">¶</a></h2>
<p>These operators are used to split items emitted by channels into chunks that can be processed by downstream
operators or processes.</p>
<p>The available splitting operators are:</p>
<ul class="simple">
<li><a class="reference internal" href="#splitcsv">splitCsv</a></li>
<li><a class="reference internal" href="#splitfasta">splitFasta</a></li>
<li><a class="reference internal" href="#splitfastq">splitFastq</a></li>
<li><a class="reference internal" href="#splittext">splitText</a></li>
</ul>
<div class="section" id="splitcsv">
<h3>splitCsv<a class="headerlink" href="#splitcsv" title="永久链接至标题">¶</a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">splitCsv</span></code> operator allows you to parse text items emitted by a channel, that are formatted using the
<a class="reference external" href="http://en.wikipedia.org/wiki/Comma-separated_values">CSV format</a>, and split them into records or group them into
list of records with a specified length.</p>
<p>In the simplest case just apply the <code class="docutils literal notranslate"><span class="pre">splitCsv</span></code> operator to a channel emitting a CSV formatted text files or
text entries. For example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Channel</span>
    <span class="o">.</span><span class="n">from</span><span class="p">(</span> <span class="s1">&#39;alpha,beta,gamma</span><span class="se">\n</span><span class="s1">10,20,30</span><span class="se">\n</span><span class="s1">70,80,90&#39;</span> <span class="p">)</span>
    <span class="o">.</span><span class="n">splitCsv</span><span class="p">()</span>
    <span class="o">.</span><span class="n">subscribe</span> <span class="p">{</span> <span class="n">row</span> <span class="o">-&gt;</span>
       <span class="n">println</span> <span class="s2">&quot;$</span><span class="si">{row[0]}</span><span class="s2"> - $</span><span class="si">{row[1]}</span><span class="s2"> - $</span><span class="si">{row[2]}</span><span class="s2">&quot;</span>
    <span class="p">}</span>
</pre></div>
</div>
<p>The above example shows hows CSV text is parsed and is split into single rows. Values can be accessed
by its column index in the row object.</p>
<p>When the CVS begins with a header line defining the columns names, you can specify the parameter <code class="docutils literal notranslate"><span class="pre">header:</span> <span class="pre">true</span></code> which
allows you to reference each value by its name, as shown in the following example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Channel</span>
    <span class="o">.</span><span class="n">from</span><span class="p">(</span> <span class="s1">&#39;alpha,beta,gamma</span><span class="se">\n</span><span class="s1">10,20,30</span><span class="se">\n</span><span class="s1">70,80,90&#39;</span> <span class="p">)</span>
    <span class="o">.</span><span class="n">splitCsv</span><span class="p">(</span><span class="n">header</span><span class="p">:</span> <span class="n">true</span><span class="p">)</span>
    <span class="o">.</span><span class="n">subscribe</span> <span class="p">{</span> <span class="n">row</span> <span class="o">-&gt;</span>
       <span class="n">println</span> <span class="s2">&quot;$</span><span class="si">{row.alpha}</span><span class="s2"> - $</span><span class="si">{row.beta}</span><span class="s2"> - $</span><span class="si">{row.gamma}</span><span class="s2">&quot;</span>
    <span class="p">}</span>
</pre></div>
</div>
<p>It will print</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mi">10</span> <span class="o">-</span> <span class="mi">20</span> <span class="o">-</span> <span class="mi">30</span>
<span class="mi">70</span> <span class="o">-</span> <span class="mi">80</span> <span class="o">-</span> <span class="mi">90</span>
</pre></div>
</div>
<p>Alternatively you can provide custom header names by specifying a the list of strings in the <code class="docutils literal notranslate"><span class="pre">header</span></code> parameter
as shown below:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Channel</span>
    <span class="o">.</span><span class="n">from</span><span class="p">(</span> <span class="s1">&#39;alpha,beta,gamma</span><span class="se">\n</span><span class="s1">10,20,30</span><span class="se">\n</span><span class="s1">70,80,90&#39;</span> <span class="p">)</span>
    <span class="o">.</span><span class="n">splitCsv</span><span class="p">(</span><span class="n">header</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;col1&#39;</span><span class="p">,</span> <span class="s1">&#39;col2&#39;</span><span class="p">,</span> <span class="s1">&#39;col3&#39;</span><span class="p">],</span> <span class="n">skip</span><span class="p">:</span> <span class="mi">1</span> <span class="p">)</span>
    <span class="o">.</span><span class="n">subscribe</span> <span class="p">{</span> <span class="n">row</span> <span class="o">-&gt;</span>
       <span class="n">println</span> <span class="s2">&quot;$</span><span class="si">{row.col1}</span><span class="s2"> - $</span><span class="si">{row.col2}</span><span class="s2"> - $</span><span class="si">{row.col3}</span><span class="s2">&quot;</span>
    <span class="p">}</span>
</pre></div>
</div>
<p>Available parameters:</p>
<table border="1" class="docutils">
<colgroup>
<col width="6%" />
<col width="94%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Field</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>by</td>
<td>The number of rows in each <cite>chunk</cite></td>
</tr>
<tr class="row-odd"><td>sep</td>
<td>The character used to separate the values (default: <code class="docutils literal notranslate"><span class="pre">,</span></code>)</td>
</tr>
<tr class="row-even"><td>quote</td>
<td>Values may be quoted by single or double quote characters.</td>
</tr>
<tr class="row-odd"><td>header</td>
<td>When <code class="docutils literal notranslate"><span class="pre">true</span></code> the first line is used as columns names. Alternatively it can be used to provide the list of columns names.</td>
</tr>
<tr class="row-even"><td>charset</td>
<td>Parse the content by using the specified charset e.g. <code class="docutils literal notranslate"><span class="pre">UTF-8</span></code></td>
</tr>
<tr class="row-odd"><td>strip</td>
<td>Removes leading and trailing blanks from values (default: <code class="docutils literal notranslate"><span class="pre">false</span></code>)</td>
</tr>
<tr class="row-even"><td>skip</td>
<td>Number of lines since the file beginning to ignore when parsing the CSV content.</td>
</tr>
<tr class="row-odd"><td>limit</td>
<td>Limits the number of retrieved records for each file to the specified value.</td>
</tr>
<tr class="row-even"><td>decompress</td>
<td>When <code class="docutils literal notranslate"><span class="pre">true</span></code> decompress the content using the GZIP format before processing it (note: files whose name ends with <code class="docutils literal notranslate"><span class="pre">.gz</span></code> extension are decompressed automatically)</td>
</tr>
<tr class="row-odd"><td>elem</td>
<td>The index of the element to split when the operator is applied to a channel emitting list/tuple objects (default: first file object or first element)</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="splitfasta">
<h3>splitFasta<a class="headerlink" href="#splitfasta" title="永久链接至标题">¶</a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">splitFasta</span></code> operator allows you to split the entries emitted by a channel, that are formatted using the
<a class="reference external" href="http://en.wikipedia.org/wiki/FASTA_format">FASTA format</a>. It returns a channel which emits text item
for each sequence in the received FASTA content.</p>
<p>The number of sequences in each text chunk produced by the <code class="docutils literal notranslate"><span class="pre">splitFasta</span></code> operator can be set by using
the <code class="docutils literal notranslate"><span class="pre">by</span></code> parameter. The following example shows how to read a FASTA file and split it into chunks containing 10 sequences
each:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Channel</span>
     <span class="o">.</span><span class="n">fromPath</span><span class="p">(</span><span class="s1">&#39;misc/sample.fa&#39;</span><span class="p">)</span>
     <span class="o">.</span><span class="n">splitFasta</span><span class="p">(</span> <span class="n">by</span><span class="p">:</span> <span class="mi">10</span> <span class="p">)</span>
     <span class="o">.</span><span class="n">subscribe</span> <span class="p">{</span> <span class="nb">print</span> <span class="n">it</span> <span class="p">}</span>
</pre></div>
</div>
<div class="admonition warning">
<p class="first admonition-title">警告</p>
<p class="last">By default chunks are kept in memory. When splitting big files specify the parameter <code class="docutils literal notranslate"><span class="pre">file:</span> <span class="pre">true</span></code> to save the
chunks into files in order to not incur in a <code class="docutils literal notranslate"><span class="pre">OutOfMemoryException</span></code>. See the available parameter table below for details.</p>
</div>
<p>A second version of the <code class="docutils literal notranslate"><span class="pre">splitFasta</span></code> operator allows you to split a FASTA content into record objects, instead
of text chunks. A record object contains a set of fields that let you access and manipulate the FASTA sequence
information with ease.</p>
<p>In order to split a FASTA content into record objects, simply use the <code class="docutils literal notranslate"><span class="pre">record</span></code> parameter specifying the map of
required the fields, as shown in the example below:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Channel</span>
     <span class="o">.</span><span class="n">fromPath</span><span class="p">(</span><span class="s1">&#39;misc/sample.fa&#39;</span><span class="p">)</span>
     <span class="o">.</span><span class="n">splitFasta</span><span class="p">(</span> <span class="n">record</span><span class="p">:</span> <span class="p">[</span><span class="nb">id</span><span class="p">:</span> <span class="n">true</span><span class="p">,</span> <span class="n">seqString</span><span class="p">:</span> <span class="n">true</span> <span class="p">])</span>
     <span class="o">.</span><span class="n">filter</span> <span class="p">{</span> <span class="n">record</span> <span class="o">-&gt;</span> <span class="n">record</span><span class="o">.</span><span class="n">id</span> <span class="o">=~</span> <span class="o">/^</span><span class="n">ENST0</span><span class="o">.*/</span> <span class="p">}</span>
     <span class="o">.</span><span class="n">subscribe</span> <span class="p">{</span> <span class="n">record</span> <span class="o">-&gt;</span> <span class="n">println</span> <span class="n">record</span><span class="o">.</span><span class="n">seqString</span> <span class="p">}</span>
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">注解</p>
<p class="last">In this example, the file <code class="docutils literal notranslate"><span class="pre">misc/sample.fa</span></code> is split into records containing the <code class="docutils literal notranslate"><span class="pre">id</span></code> and the <code class="docutils literal notranslate"><span class="pre">seqString</span></code> fields
(i.e. the sequence id and the sequence data). The following <code class="docutils literal notranslate"><span class="pre">filter</span></code> operator only keeps the sequences which ID
starts with the <code class="docutils literal notranslate"><span class="pre">ENST0</span></code> prefix, finally the sequence content is printed by using the <code class="docutils literal notranslate"><span class="pre">subscribe</span></code> operator.</p>
</div>
<p>Available parameters:</p>
<table border="1" class="docutils">
<colgroup>
<col width="4%" />
<col width="96%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Field</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>by</td>
<td>Defines the number of sequences in each <cite>chunk</cite> (default: <code class="docutils literal notranslate"><span class="pre">1</span></code>)</td>
</tr>
<tr class="row-odd"><td>size</td>
<td>Defines the size in memory units of the expected chunks eg. <cite>1.MB</cite>.</td>
</tr>
<tr class="row-even"><td>limit</td>
<td>Limits the number of retrieved sequences for each file to the specified value.</td>
</tr>
<tr class="row-odd"><td>record</td>
<td>Parse each entry in the FASTA file as record objects (see following table for accepted values)</td>
</tr>
<tr class="row-even"><td>charset</td>
<td>Parse the content by using the specified charset e.g. <code class="docutils literal notranslate"><span class="pre">UTF-8</span></code></td>
</tr>
<tr class="row-odd"><td>compress</td>
<td>When <code class="docutils literal notranslate"><span class="pre">true</span></code> resulting file chunks are GZIP compressed. The <code class="docutils literal notranslate"><span class="pre">.gz</span></code> suffix is automatically added to chunk file names.</td>
</tr>
<tr class="row-even"><td>decompress</td>
<td>When <code class="docutils literal notranslate"><span class="pre">true</span></code>, decompress the content using the GZIP format before processing it (note: files whose name ends with <code class="docutils literal notranslate"><span class="pre">.gz</span></code> extension are decompressed automatically)</td>
</tr>
<tr class="row-odd"><td>file</td>
<td>When <code class="docutils literal notranslate"><span class="pre">true</span></code> saves each split to a file. Use a string instead of <code class="docutils literal notranslate"><span class="pre">true</span></code> value to create split files with a specific name (split index number is automatically added). Finally, set this attribute to an existing directory, in order to save the split files into the specified folder.</td>
</tr>
<tr class="row-even"><td>elem</td>
<td>The index of the element to split when the operator is applied to a channel emitting list/tuple objects (default: first file object or first element)</td>
</tr>
</tbody>
</table>
<p>The following fields are available when using the <code class="docutils literal notranslate"><span class="pre">record</span></code> parameter:</p>
<table border="1" class="docutils">
<colgroup>
<col width="8%" />
<col width="92%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Field</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>id</td>
<td>The FASTA sequence identifier i.e. the word following the <code class="docutils literal notranslate"><span class="pre">&gt;</span></code> symbol up to the first <cite>blank</cite> or <cite>newline</cite> character</td>
</tr>
<tr class="row-odd"><td>header</td>
<td>The first line in a FASTA sequence without the <code class="docutils literal notranslate"><span class="pre">&gt;</span></code> character</td>
</tr>
<tr class="row-even"><td>desc</td>
<td>The text in the FASTA header following the ID value</td>
</tr>
<tr class="row-odd"><td>text</td>
<td>The complete FASTA sequence including the header</td>
</tr>
<tr class="row-even"><td>seqString</td>
<td>The sequence data as a single line string i.e. containing no <cite>newline</cite> characters</td>
</tr>
<tr class="row-odd"><td>sequence</td>
<td>The sequence data as a multi-line string (always ending with a <cite>newline</cite> character)</td>
</tr>
<tr class="row-even"><td>width</td>
<td>Define the length of a single line when the <code class="docutils literal notranslate"><span class="pre">sequence</span></code> field is used, after that the sequence data continues on a new line.</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="splitfastq">
<h3>splitFastq<a class="headerlink" href="#splitfastq" title="永久链接至标题">¶</a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">splitFastq</span></code> operator allows you to split the entries emitted by a channel, that are formatted using the
<a class="reference external" href="http://en.wikipedia.org/wiki/FASTQ_format">FASTQ format</a>. It returns a channel which emits a text chunk
for each sequence in the received item.</p>
<p>The number of sequences in each text chunk produced by the <code class="docutils literal notranslate"><span class="pre">splitFastq</span></code> operator is defined by the
parameter <code class="docutils literal notranslate"><span class="pre">by</span></code>. The following example shows you how to read a FASTQ file and split it into chunks containing 10
sequences each:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Channel</span>
     <span class="o">.</span><span class="n">fromPath</span><span class="p">(</span><span class="s1">&#39;misc/sample.fastq&#39;</span><span class="p">)</span>
     <span class="o">.</span><span class="n">splitFastq</span><span class="p">(</span> <span class="n">by</span><span class="p">:</span> <span class="mi">10</span> <span class="p">)</span>
     <span class="o">.</span><span class="n">println</span><span class="p">()</span>
</pre></div>
</div>
<div class="admonition warning">
<p class="first admonition-title">警告</p>
<p class="last">By default chunks are kept in memory. When splitting big files specify the parameter <code class="docutils literal notranslate"><span class="pre">file:</span> <span class="pre">true</span></code> to save the
chunks into files in order to not incur in a <code class="docutils literal notranslate"><span class="pre">OutOfMemoryException</span></code>. See the available parameter table below for details.</p>
</div>
<p>A second version of the <code class="docutils literal notranslate"><span class="pre">splitFastq</span></code> operator allows you to split a FASTQ formatted content into record objects,
instead of text chunks. A record object contains a set of fields that let you access and manipulate the FASTQ sequence
data with ease.</p>
<p>In order to split FASTQ sequences into record objects simply use the <code class="docutils literal notranslate"><span class="pre">record</span></code> parameter specifying the map of
the required fields, or just specify <code class="docutils literal notranslate"><span class="pre">record:</span> <span class="pre">true</span></code> as in the example shown below:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Channel</span>
     <span class="o">.</span><span class="n">fromPath</span><span class="p">(</span><span class="s1">&#39;misc/sample.fastq&#39;</span><span class="p">)</span>
     <span class="o">.</span><span class="n">splitFastq</span><span class="p">(</span> <span class="n">record</span><span class="p">:</span> <span class="n">true</span> <span class="p">)</span>
     <span class="o">.</span><span class="n">println</span> <span class="p">{</span> <span class="n">record</span> <span class="o">-&gt;</span> <span class="n">record</span><span class="o">.</span><span class="n">readHeader</span> <span class="p">}</span>
</pre></div>
</div>
<p>Finally the <code class="docutils literal notranslate"><span class="pre">splitFastq</span></code> operator is able to split paired-end read pair FASTQ files. It must be applied to a channel
which emits tuples containing at least two elements that are the files to be splitted. For example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Channel</span>
    <span class="o">.</span><span class="n">fromFilePairs</span><span class="p">(</span><span class="s1">&#39;/my/data/SRR*_{1,2}.fastq&#39;</span><span class="p">,</span> <span class="n">flat</span><span class="p">:</span><span class="n">true</span><span class="p">)</span>
    <span class="o">.</span><span class="n">splitFastq</span><span class="p">(</span><span class="n">by</span><span class="p">:</span> <span class="mi">100</span><span class="n">_000</span><span class="p">,</span> <span class="n">pe</span><span class="p">:</span><span class="n">true</span><span class="p">,</span> <span class="n">file</span><span class="p">:</span><span class="n">true</span><span class="p">)</span>
    <span class="o">.</span><span class="n">println</span><span class="p">()</span>
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">注解</p>
<p class="last">The <code class="docutils literal notranslate"><span class="pre">fromFilePairs</span></code> requires the <code class="docutils literal notranslate"><span class="pre">flat:true</span></code> option to have the file pairs as separate elements
in the produced tuples.</p>
</div>
<div class="admonition warning">
<p class="first admonition-title">警告</p>
<p class="last">This operator assumes that the order of the PE reads correspond with each other and both files contain
the same number of reads.</p>
</div>
<p>Available parameters:</p>
<table border="1" class="docutils">
<colgroup>
<col width="4%" />
<col width="96%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Field</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>by</td>
<td>Defines the number of <em>reads</em> in each <cite>chunk</cite> (default: <code class="docutils literal notranslate"><span class="pre">1</span></code>)</td>
</tr>
<tr class="row-odd"><td>pe</td>
<td>When <code class="docutils literal notranslate"><span class="pre">true</span></code> splits paired-end read files, therefore items emitted by the source channel must be tuples in which at least two elements are the read-pair files to be splitted.</td>
</tr>
<tr class="row-even"><td>limit</td>
<td>Limits the number of retrieved <em>reads</em> for each file to the specified value.</td>
</tr>
<tr class="row-odd"><td>record</td>
<td>Parse each entry in the FASTQ file as record objects (see following table for accepted values)</td>
</tr>
<tr class="row-even"><td>charset</td>
<td>Parse the content by using the specified charset e.g. <code class="docutils literal notranslate"><span class="pre">UTF-8</span></code></td>
</tr>
<tr class="row-odd"><td>compress</td>
<td>When <code class="docutils literal notranslate"><span class="pre">true</span></code> resulting file chunks are GZIP compressed. The <code class="docutils literal notranslate"><span class="pre">.gz</span></code> suffix is automatically added to chunk file names.</td>
</tr>
<tr class="row-even"><td>decompress</td>
<td>When <code class="docutils literal notranslate"><span class="pre">true</span></code> decompress the content using the GZIP format before processing it (note: files whose name ends with <code class="docutils literal notranslate"><span class="pre">.gz</span></code> extension are decompressed automatically)</td>
</tr>
<tr class="row-odd"><td>file</td>
<td>When <code class="docutils literal notranslate"><span class="pre">true</span></code> saves each split to a file. Use a string instead of <code class="docutils literal notranslate"><span class="pre">true</span></code> value to create split files with a specific name (split index number is automatically added). Finally, set this attribute to an existing directory, in order to save the split files into the specified folder.</td>
</tr>
<tr class="row-even"><td>elem</td>
<td>The index of the element to split when the operator is applied to a channel emitting list/tuple objects (default: first file object or first element)</td>
</tr>
</tbody>
</table>
<p>The following fields are available when using the <code class="docutils literal notranslate"><span class="pre">record</span></code> parameter:</p>
<table border="1" class="docutils">
<colgroup>
<col width="26%" />
<col width="74%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Field</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>readHeader</td>
<td>Sequence header (without the <code class="docutils literal notranslate"><span class="pre">&#64;</span></code> prefix)</td>
</tr>
<tr class="row-odd"><td>readString</td>
<td>The raw sequence data</td>
</tr>
<tr class="row-even"><td>qualityHeader</td>
<td>Base quality header (it may be empty)</td>
</tr>
<tr class="row-odd"><td>qualityString</td>
<td>Quality values for the sequence</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="splittext">
<h3>splitText<a class="headerlink" href="#splittext" title="永久链接至标题">¶</a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">splitText</span></code> operator allows you to split multi-line strings or text file items, emitted by a source channel
into chunks containing <cite>n</cite> lines, which will be emitted by the resulting channel.</p>
<p>For example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Channel</span>
     <span class="o">.</span><span class="n">fromPath</span><span class="p">(</span><span class="s1">&#39;/some/path/*.txt&#39;</span><span class="p">)</span>
     <span class="o">.</span><span class="n">splitText</span><span class="p">()</span>
     <span class="o">.</span><span class="n">subscribe</span> <span class="p">{</span> <span class="nb">print</span> <span class="n">it</span> <span class="p">}</span>
</pre></div>
</div>
<p>It splits the content of the files with suffix <code class="docutils literal notranslate"><span class="pre">.txt</span></code>, and prints it line by line.</p>
<p>By default the <code class="docutils literal notranslate"><span class="pre">splitText</span></code> operator splits each item into chunks of one line. You can define the number of lines in each chunk by using
the parameter <code class="docutils literal notranslate"><span class="pre">by</span></code>, as shown in the following example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Channel</span>
     <span class="o">.</span><span class="n">fromPath</span><span class="p">(</span><span class="s1">&#39;/some/path/*.txt&#39;</span><span class="p">)</span>
     <span class="o">.</span><span class="n">splitText</span><span class="p">(</span> <span class="n">by</span><span class="p">:</span> <span class="mi">10</span> <span class="p">)</span>
     <span class="o">.</span><span class="n">subscribe</span> <span class="p">{</span>
         <span class="nb">print</span> <span class="n">it</span><span class="p">;</span>
         <span class="nb">print</span> <span class="s2">&quot;--- end of the chunk ---</span><span class="se">\n</span><span class="s2">&quot;</span>
     <span class="p">}</span>
</pre></div>
</div>
<p>An optional <a class="reference internal" href="script.html#script-closure"><span class="std std-ref">closure</span></a> can be specified in order to <cite>transform</cite> the text chunks produced by the operator.
The following example shows how to split text files into chunks of 10 lines and transform them to capital letters:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Channel</span>
   <span class="o">.</span><span class="n">fromPath</span><span class="p">(</span><span class="s1">&#39;/some/path/*.txt&#39;</span><span class="p">)</span>
   <span class="o">.</span><span class="n">splitText</span><span class="p">(</span> <span class="n">by</span><span class="p">:</span> <span class="mi">10</span> <span class="p">)</span> <span class="p">{</span> <span class="n">it</span><span class="o">.</span><span class="n">toUpperCase</span><span class="p">()</span> <span class="p">}</span>
   <span class="o">.</span><span class="n">subscribe</span> <span class="p">{</span> <span class="nb">print</span> <span class="n">it</span> <span class="p">}</span>
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">注解</p>
<p class="last">Text chunks returned by the operator <code class="docutils literal notranslate"><span class="pre">splitText</span></code> are always terminated by a <code class="docutils literal notranslate"><span class="pre">newline</span></code> character.</p>
</div>
<p>Available parameters:</p>
<table border="1" class="docutils">
<colgroup>
<col width="4%" />
<col width="96%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Field</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>by</td>
<td>Defines the number of lines in each <cite>chunk</cite> (default: <code class="docutils literal notranslate"><span class="pre">1</span></code>).</td>
</tr>
<tr class="row-odd"><td>limit</td>
<td>Limits the number of retrieved lines for each file to the specified value.</td>
</tr>
<tr class="row-even"><td>charset</td>
<td>Parse the content by using the specified charset e.g. <code class="docutils literal notranslate"><span class="pre">UTF-8</span></code>.</td>
</tr>
<tr class="row-odd"><td>compress</td>
<td>When <code class="docutils literal notranslate"><span class="pre">true</span></code> resulting file chunks are GZIP compressed. The <code class="docutils literal notranslate"><span class="pre">.gz</span></code> suffix is automatically added to chunk file names.</td>
</tr>
<tr class="row-even"><td>decompress</td>
<td>When <code class="docutils literal notranslate"><span class="pre">true</span></code>, decompress the content using the GZIP format before processing it (note: files whose name ends with <code class="docutils literal notranslate"><span class="pre">.gz</span></code> extension are decompressed automatically).</td>
</tr>
<tr class="row-odd"><td>file</td>
<td>When <code class="docutils literal notranslate"><span class="pre">true</span></code> saves each split to a file. Use a string instead of <code class="docutils literal notranslate"><span class="pre">true</span></code> value to create split files with a specific name (split index number is automatically added). Finally, set this attribute to an existing directory, in oder to save the split files into the specified folder.</td>
</tr>
<tr class="row-even"><td>elem</td>
<td>The index of the element to split when the operator is applied to a channel emitting list/tuple objects (default: first file object or first element).</td>
</tr>
<tr class="row-odd"><td>keepHeader</td>
<td>Parses the first line as header and prepends it to each emitted chunk.</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="section" id="combining-operators">
<h2>Combining operators<a class="headerlink" href="#combining-operators" title="永久链接至标题">¶</a></h2>
<p>The combining operators are:</p>
<ul class="simple">
<li><a class="reference internal" href="#cross">cross</a></li>
<li><a class="reference internal" href="#collectfile">collectFile</a></li>
<li><a class="reference internal" href="#combine">combine</a></li>
<li><a class="reference internal" href="#concat">concat</a></li>
<li><a class="reference internal" href="#into">into</a></li>
<li><a class="reference internal" href="#join">join</a></li>
<li><a class="reference internal" href="#merge">merge</a></li>
<li><a class="reference internal" href="#mix">mix</a></li>
<li><a class="reference internal" href="#phase">phase</a></li>
<li><a class="reference internal" href="#spread">spread</a></li>
<li><a class="reference internal" href="#tap">tap</a></li>
</ul>
<div class="section" id="into">
<span id="operator-into"></span><h3>into<a class="headerlink" href="#into" title="永久链接至标题">¶</a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">into</span></code> operator connects a source channel to two or more target channels in such a way the values emitted by
the source channel are copied to the target channels. For example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Channel</span>
     <span class="o">.</span><span class="n">from</span><span class="p">(</span> <span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span> <span class="p">)</span>
     <span class="o">.</span><span class="n">into</span><span class="p">{</span> <span class="n">foo</span><span class="p">;</span> <span class="n">bar</span> <span class="p">}</span>

 <span class="n">foo</span><span class="o">.</span><span class="n">println</span><span class="p">{</span> <span class="s2">&quot;Foo emit: &quot;</span> <span class="o">+</span> <span class="n">it</span> <span class="p">}</span>
 <span class="n">bar</span><span class="o">.</span><span class="n">println</span><span class="p">{</span> <span class="s2">&quot;Bar emit: &quot;</span> <span class="o">+</span> <span class="n">it</span> <span class="p">}</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Foo</span> <span class="n">emit</span><span class="p">:</span> <span class="n">a</span>
<span class="n">Foo</span> <span class="n">emit</span><span class="p">:</span> <span class="n">b</span>
<span class="n">Foo</span> <span class="n">emit</span><span class="p">:</span> <span class="n">c</span>
<span class="n">Bar</span> <span class="n">emit</span><span class="p">:</span> <span class="n">a</span>
<span class="n">Bar</span> <span class="n">emit</span><span class="p">:</span> <span class="n">b</span>
<span class="n">Bar</span> <span class="n">emit</span><span class="p">:</span> <span class="n">c</span>
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">注解</p>
<p class="last">Note the use in this example of curly brackets and the <code class="docutils literal notranslate"><span class="pre">;</span></code> as channel names separator. This is needed
because the actual parameter of <code class="docutils literal notranslate"><span class="pre">into</span></code> is a <a class="reference internal" href="script.html#script-closure"><span class="std std-ref">closure</span></a> which defines the target channels
to which the source one is connected.</p>
</div>
<p>A second version of the <code class="docutils literal notranslate"><span class="pre">into</span></code> operator takes an integer <cite>n</cite> as an argument and returns
a list of <cite>n</cite> channels, each of which emits a copy of the items that were emitted by the
source channel. For example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="n">foo</span><span class="p">,</span> <span class="n">bar</span><span class="p">)</span> <span class="o">=</span> <span class="n">Channel</span><span class="o">.</span><span class="n">from</span><span class="p">(</span> <span class="s1">&#39;a&#39;</span><span class="p">,</span><span class="s1">&#39;b&#39;</span><span class="p">,</span><span class="s1">&#39;c&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">into</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="n">foo</span><span class="o">.</span><span class="n">println</span><span class="p">{</span> <span class="s2">&quot;Foo emit: &quot;</span> <span class="o">+</span> <span class="n">it</span> <span class="p">}</span>
<span class="n">bar</span><span class="o">.</span><span class="n">println</span><span class="p">{</span> <span class="s2">&quot;Bar emit: &quot;</span> <span class="o">+</span> <span class="n">it</span> <span class="p">}</span>
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">注解</p>
<p class="last">The above example takes advantage of the <a class="reference internal" href="script.html#script-multiple-assignment"><span class="std std-ref">multiple assignment</span></a> syntax
in order to assign two variables at once using the list of channels returned by the <code class="docutils literal notranslate"><span class="pre">into</span></code> operator.</p>
</div>
<p>See also <a class="reference internal" href="#tap">tap</a> and <a class="reference internal" href="#separate">separate</a> operators.</p>
</div>
<div class="section" id="tap">
<h3>tap<a class="headerlink" href="#tap" title="永久链接至标题">¶</a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">tap</span></code> operator combines the functions of <a class="reference internal" href="#into">into</a> and <a class="reference internal" href="#separate">separate</a> operators in such a way that
it connects two channels, copying the values from the source into the <cite>tapped</cite> channel. At the same
time it splits the source channel into a newly created channel that is returned by the operator itself.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">tap</span></code> can be useful in certain scenarios where you may be required to concatenate multiple operations,
as in the following example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">log1</span> <span class="o">=</span> <span class="n">Channel</span><span class="o">.</span><span class="n">create</span><span class="p">()</span><span class="o">.</span><span class="n">subscribe</span> <span class="p">{</span> <span class="n">println</span> <span class="s2">&quot;Log 1: $it&quot;</span> <span class="p">}</span>
<span class="n">log2</span> <span class="o">=</span> <span class="n">Channel</span><span class="o">.</span><span class="n">create</span><span class="p">()</span><span class="o">.</span><span class="n">subscribe</span> <span class="p">{</span> <span class="n">println</span> <span class="s2">&quot;Log 2: $it&quot;</span> <span class="p">}</span>

<span class="n">Channel</span>
    <span class="o">.</span><span class="kn">from</span> <span class="p">(</span> <span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span> <span class="p">)</span>
        <span class="o">.</span><span class="n">tap</span><span class="p">(</span> <span class="n">log1</span> <span class="p">)</span>
        <span class="o">.</span><span class="n">map</span> <span class="p">{</span> <span class="n">it</span> <span class="o">*</span> <span class="mi">2</span> <span class="p">}</span>
        <span class="o">.</span><span class="n">tap</span><span class="p">(</span> <span class="n">log2</span> <span class="p">)</span>
        <span class="o">.</span><span class="n">subscribe</span> <span class="p">{</span> <span class="n">println</span> <span class="s2">&quot;Result: $it&quot;</span> <span class="p">}</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Log</span> <span class="mi">1</span><span class="p">:</span> <span class="n">a</span>
<span class="n">Log</span> <span class="mi">1</span><span class="p">:</span> <span class="n">b</span>
<span class="n">Log</span> <span class="mi">1</span><span class="p">:</span> <span class="n">c</span>

<span class="n">Log</span> <span class="mi">2</span><span class="p">:</span> <span class="n">aa</span>
<span class="n">Log</span> <span class="mi">2</span><span class="p">:</span> <span class="n">bb</span>
<span class="n">Log</span> <span class="mi">2</span><span class="p">:</span> <span class="n">cc</span>

<span class="n">Result</span><span class="p">:</span> <span class="n">aa</span>
<span class="n">Result</span><span class="p">:</span> <span class="n">bb</span>
<span class="n">Result</span><span class="p">:</span> <span class="n">cc</span>
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">tap</span></code> operator also allows the target channel to be specified by using a closure. The advantage of this syntax
is that you won’t need to previously create the target channel, because it is created implicitly by the operator itself.</p>
<p>Using the closure syntax the above example can be rewritten as shown below:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Channel</span>
    <span class="o">.</span><span class="kn">from</span> <span class="p">(</span> <span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span> <span class="p">)</span>
        <span class="o">.</span><span class="n">tap</span> <span class="p">{</span> <span class="n">log1</span> <span class="p">}</span>
        <span class="o">.</span><span class="n">map</span> <span class="p">{</span> <span class="n">it</span> <span class="o">*</span> <span class="mi">2</span> <span class="p">}</span>
        <span class="o">.</span><span class="n">tap</span> <span class="p">{</span> <span class="n">log2</span> <span class="p">}</span>
        <span class="o">.</span><span class="n">subscribe</span> <span class="p">{</span> <span class="n">println</span> <span class="s2">&quot;Result: $it&quot;</span> <span class="p">}</span>


<span class="n">log1</span><span class="o">.</span><span class="n">subscribe</span> <span class="p">{</span> <span class="n">println</span> <span class="s2">&quot;Log 1: $it&quot;</span> <span class="p">}</span>
<span class="n">log2</span><span class="o">.</span><span class="n">subscribe</span> <span class="p">{</span> <span class="n">println</span> <span class="s2">&quot;Log 2: $it&quot;</span> <span class="p">}</span>
</pre></div>
</div>
<p>See also <a class="reference internal" href="#into">into</a> and <a class="reference internal" href="#separate">separate</a> operators.</p>
</div>
<div class="section" id="join">
<span id="operator-join"></span><h3>join<a class="headerlink" href="#join" title="永久链接至标题">¶</a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">join</span></code> operator creates a channel that joins together the items emitted by two channels for which exits
a matching key. The key is defined, by default, as the first element in each item emitted.</p>
<p>For example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">left</span> <span class="o">=</span> <span class="n">Channel</span><span class="o">.</span><span class="n">from</span><span class="p">([</span><span class="s1">&#39;X&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;Y&#39;</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;Z&#39;</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;P&#39;</span><span class="p">,</span> <span class="mi">7</span><span class="p">])</span>
<span class="n">right</span><span class="o">=</span> <span class="n">Channel</span><span class="o">.</span><span class="n">from</span><span class="p">([</span><span class="s1">&#39;Z&#39;</span><span class="p">,</span> <span class="mi">6</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;Y&#39;</span><span class="p">,</span> <span class="mi">5</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;X&#39;</span><span class="p">,</span> <span class="mi">4</span><span class="p">])</span>
<span class="n">left</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">right</span><span class="p">)</span><span class="o">.</span><span class="n">println</span><span class="p">()</span>
</pre></div>
</div>
<p>The resulting channel emits:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="n">Z</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">6</span><span class="p">]</span>
<span class="p">[</span><span class="n">Y</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">5</span><span class="p">]</span>
<span class="p">[</span><span class="n">X</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">]</span>
</pre></div>
</div>
<p>The <cite>index</cite> of a different matching element can be specified by using the <code class="docutils literal notranslate"><span class="pre">by</span></code> parameter.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">join</span></code> operator can emit all the pairs that are incomplete, i.e. the items for which a matching element
is missing, by specifying the optional parameter <code class="docutils literal notranslate"><span class="pre">remainder</span></code> as shown below:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">left</span> <span class="o">=</span> <span class="n">Channel</span><span class="o">.</span><span class="n">from</span><span class="p">([</span><span class="s1">&#39;X&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;Y&#39;</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;Z&#39;</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;P&#39;</span><span class="p">,</span> <span class="mi">7</span><span class="p">])</span>
<span class="n">right</span><span class="o">=</span> <span class="n">Channel</span><span class="o">.</span><span class="n">from</span><span class="p">([</span><span class="s1">&#39;Z&#39;</span><span class="p">,</span> <span class="mi">6</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;Y&#39;</span><span class="p">,</span> <span class="mi">5</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;X&#39;</span><span class="p">,</span> <span class="mi">4</span><span class="p">])</span>
<span class="n">left</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">right</span><span class="p">,</span> <span class="n">remainder</span><span class="p">:</span> <span class="n">true</span><span class="p">)</span><span class="o">.</span><span class="n">println</span><span class="p">()</span>
</pre></div>
</div>
<p>The above example prints:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="n">Y</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">5</span><span class="p">]</span>
<span class="p">[</span><span class="n">Z</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">6</span><span class="p">]</span>
<span class="p">[</span><span class="n">X</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">]</span>
<span class="p">[</span><span class="n">P</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="n">null</span><span class="p">]</span>
</pre></div>
</div>
<p>The following parameters can be used with the <code class="docutils literal notranslate"><span class="pre">join</span></code> operator:</p>
<table border="1" class="docutils">
<colgroup>
<col width="13%" />
<col width="87%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Name</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>by</td>
<td>The index (zero based) of the element to be used as grouping key.
A key composed by multiple elements can be defined specifying a list of indices e.g. <code class="docutils literal notranslate"><span class="pre">by:</span> <span class="pre">[0,2]</span></code></td>
</tr>
<tr class="row-odd"><td>remainder</td>
<td>When <code class="docutils literal notranslate"><span class="pre">false</span></code> incomplete tuples (i.e. with less than <cite>size</cite> grouped items)
are discarded (default). When <code class="docutils literal notranslate"><span class="pre">true</span></code> incomplete tuples are emitted as the ending emission.</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="merge">
<span id="operator-merge"></span><h3>merge<a class="headerlink" href="#merge" title="永久链接至标题">¶</a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">merge</span></code> operator lets you join items emitted by two (or more) channels into a new channel.</p>
<p>For example the following code merges two channels together, one which emits a series of odd integers
and the other which emits a series of even integers:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">odds</span>  <span class="o">=</span> <span class="n">Channel</span><span class="o">.</span><span class="n">from</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">9</span><span class="p">]);</span>
<span class="n">evens</span> <span class="o">=</span> <span class="n">Channel</span><span class="o">.</span><span class="n">from</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">6</span><span class="p">]);</span>

<span class="n">odds</span>
    <span class="o">.</span><span class="n">merge</span><span class="p">(</span> <span class="n">evens</span> <span class="p">)</span>
    <span class="o">.</span><span class="n">println</span><span class="p">()</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span>
<span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">]</span>
<span class="p">[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">]</span>
</pre></div>
</div>
<p>An option closure can be provide to customise the items emitted by the resulting merged channel. For example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">odds</span>  <span class="o">=</span> <span class="n">Channel</span><span class="o">.</span><span class="n">from</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">9</span><span class="p">]);</span>
<span class="n">evens</span> <span class="o">=</span> <span class="n">Channel</span><span class="o">.</span><span class="n">from</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">6</span><span class="p">]);</span>

<span class="n">odds</span>
    <span class="o">.</span><span class="n">merge</span><span class="p">(</span> <span class="n">evens</span> <span class="p">)</span> <span class="p">{</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">b</span><span class="o">*</span><span class="n">b</span><span class="p">,</span> <span class="n">a</span><span class="p">)</span> <span class="p">}</span>
    <span class="o">.</span><span class="n">println</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="section" id="mix">
<h3>mix<a class="headerlink" href="#mix" title="永久链接至标题">¶</a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">mix</span></code> operator combines the items emitted by two (or more) channels into a single channel.</p>
<p>For example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">c1</span> <span class="o">=</span> <span class="n">Channel</span><span class="o">.</span><span class="n">from</span><span class="p">(</span> <span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span> <span class="p">)</span>
<span class="n">c2</span> <span class="o">=</span> <span class="n">Channel</span><span class="o">.</span><span class="n">from</span><span class="p">(</span> <span class="s1">&#39;a&#39;</span><span class="p">,</span><span class="s1">&#39;b&#39;</span> <span class="p">)</span>
<span class="n">c3</span> <span class="o">=</span> <span class="n">Channel</span><span class="o">.</span><span class="n">from</span><span class="p">(</span> <span class="s1">&#39;z&#39;</span> <span class="p">)</span>

<span class="n">c1</span> <span class="o">.</span><span class="n">mix</span><span class="p">(</span><span class="n">c2</span><span class="p">,</span><span class="n">c3</span><span class="p">)</span>
   <span class="o">.</span><span class="n">subscribe</span> <span class="n">onNext</span><span class="p">:</span> <span class="p">{</span> <span class="n">println</span> <span class="n">it</span> <span class="p">},</span> <span class="n">onComplete</span><span class="p">:</span> <span class="p">{</span> <span class="n">println</span> <span class="s1">&#39;Done&#39;</span> <span class="p">}</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mi">1</span>
<span class="mi">2</span>
<span class="mi">3</span>
<span class="s1">&#39;a&#39;</span>
<span class="s1">&#39;b&#39;</span>
<span class="s1">&#39;z&#39;</span>
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">注解</p>
<p class="last">The items emitted by the resulting mixed channel may appear in any order,
regardless of which source channel they came from. Thus, the following example
it could be a possible result of the above example as well.</p>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="s1">&#39;z&#39;</span>
<span class="mi">1</span>
<span class="s1">&#39;a&#39;</span>
<span class="mi">2</span>
<span class="s1">&#39;b&#39;</span>
<span class="mi">3</span>
</pre></div>
</div>
</div>
<div class="section" id="phase">
<span id="operator-phase"></span><h3>phase<a class="headerlink" href="#phase" title="永久链接至标题">¶</a></h3>
<div class="admonition warning">
<p class="first admonition-title">警告</p>
<p class="last">This operator is deprecated. Use the <a class="reference internal" href="#join">join</a> operator instead.</p>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">phase</span></code> operator creates a channel that synchronizes the values emitted by two other channels,
in such a way that it emits pairs of items that have a matching key.</p>
<p>The key is defined, by default, as the first entry in an array, a list or map object,
or the value itself for any other data type.</p>
<p>For example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ch1</span> <span class="o">=</span> <span class="n">Channel</span><span class="o">.</span><span class="n">from</span><span class="p">(</span> <span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span> <span class="p">)</span>
<span class="n">ch2</span> <span class="o">=</span> <span class="n">Channel</span><span class="o">.</span><span class="n">from</span><span class="p">(</span> <span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="mi">8</span><span class="p">,</span><span class="mi">9</span><span class="p">,</span><span class="mi">3</span> <span class="p">)</span>
<span class="n">ch1</span> <span class="o">.</span><span class="n">phase</span><span class="p">(</span><span class="n">ch2</span><span class="p">)</span> <span class="o">.</span><span class="n">subscribe</span> <span class="p">{</span> <span class="n">println</span> <span class="n">it</span> <span class="p">}</span>
</pre></div>
</div>
<p>It prints:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span>
<span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">]</span>
<span class="p">[</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">]</span>
</pre></div>
</div>
<p>Optionally, a mapping function can be specified in order to provide a custom rule to associate an item to a key,
as shown in the following example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ch1</span> <span class="o">=</span> <span class="n">Channel</span><span class="o">.</span><span class="n">from</span><span class="p">(</span> <span class="p">[</span><span class="n">sequence</span><span class="p">:</span> <span class="s1">&#39;aaaaaa&#39;</span><span class="p">,</span> <span class="nb">id</span><span class="p">:</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="n">sequence</span><span class="p">:</span> <span class="s1">&#39;bbbbbb&#39;</span><span class="p">,</span> <span class="nb">id</span><span class="p">:</span> <span class="mi">2</span><span class="p">]</span> <span class="p">)</span>
<span class="n">ch2</span> <span class="o">=</span> <span class="n">Channel</span><span class="o">.</span><span class="n">from</span><span class="p">(</span> <span class="p">[</span><span class="n">val</span><span class="p">:</span> <span class="s1">&#39;zzzz&#39;</span><span class="p">,</span> <span class="nb">id</span><span class="p">:</span> <span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="n">val</span><span class="p">:</span> <span class="s1">&#39;xxxxx&#39;</span><span class="p">,</span> <span class="nb">id</span><span class="p">:</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="n">val</span><span class="p">:</span> <span class="s1">&#39;yyyyy&#39;</span><span class="p">,</span> <span class="nb">id</span><span class="p">:</span> <span class="mi">2</span><span class="p">])</span>
<span class="n">ch1</span> <span class="o">.</span><span class="n">phase</span><span class="p">(</span><span class="n">ch2</span><span class="p">)</span> <span class="p">{</span> <span class="n">it</span> <span class="o">-&gt;</span> <span class="n">it</span><span class="o">.</span><span class="n">id</span> <span class="p">}</span> <span class="o">.</span><span class="n">subscribe</span> <span class="p">{</span> <span class="n">println</span> <span class="n">it</span> <span class="p">}</span>
</pre></div>
</div>
<p>It prints:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[[</span><span class="n">sequence</span><span class="p">:</span><span class="n">aaaaaa</span><span class="p">,</span> <span class="nb">id</span><span class="p">:</span><span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="n">val</span><span class="p">:</span><span class="n">xxxxx</span><span class="p">,</span> <span class="nb">id</span><span class="p">:</span><span class="mi">1</span><span class="p">]]</span>
<span class="p">[[</span><span class="n">sequence</span><span class="p">:</span><span class="n">bbbbbb</span><span class="p">,</span> <span class="nb">id</span><span class="p">:</span><span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="n">val</span><span class="p">:</span><span class="n">yyyyy</span><span class="p">,</span> <span class="nb">id</span><span class="p">:</span><span class="mi">2</span><span class="p">]]</span>
</pre></div>
</div>
<p>Finally, the <code class="docutils literal notranslate"><span class="pre">phase</span></code> operator can emit all the pairs that are incomplete, i.e. the items for which a matching element
is missing, by specifying the optional parameter <code class="docutils literal notranslate"><span class="pre">remainder</span></code> as shown below:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ch1</span> <span class="o">=</span> <span class="n">Channel</span><span class="o">.</span><span class="n">from</span><span class="p">(</span> <span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">3</span> <span class="p">)</span>
<span class="n">ch2</span> <span class="o">=</span> <span class="n">Channel</span><span class="o">.</span><span class="n">from</span><span class="p">(</span> <span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span> <span class="p">)</span>
<span class="n">ch1</span> <span class="o">.</span><span class="n">phase</span><span class="p">(</span><span class="n">ch2</span><span class="p">,</span> <span class="n">remainder</span><span class="p">:</span> <span class="n">true</span><span class="p">)</span> <span class="o">.</span><span class="n">subscribe</span> <span class="p">{</span> <span class="n">println</span> <span class="n">it</span> <span class="p">}</span>
</pre></div>
</div>
<p>It prints:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
<span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span>
<span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">]</span>
<span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="n">null</span><span class="p">]</span>
<span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="n">null</span><span class="p">]</span>
<span class="p">[</span><span class="mi">5</span><span class="p">,</span> <span class="n">null</span><span class="p">]</span>
<span class="p">[</span><span class="n">null</span><span class="p">,</span> <span class="mi">4</span><span class="p">]</span>
</pre></div>
</div>
<p>See also <a class="reference internal" href="#join">join</a> operator.</p>
</div>
<div class="section" id="cross">
<span id="operator-cross"></span><h3>cross<a class="headerlink" href="#cross" title="永久链接至标题">¶</a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">cross</span></code> operators allows you to combine the items of two channels in such a way that
the items of the source channel are emitted along with the items emitted by the target channel
for which they have a matching key.</p>
<p>The key is defined, by default, as the first entry in an array, a list or map object,
or the value itself for any other data type. For example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">source</span> <span class="o">=</span> <span class="n">Channel</span><span class="o">.</span><span class="n">from</span><span class="p">(</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;alpha&#39;</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;beta&#39;</span><span class="p">]</span> <span class="p">)</span>
<span class="n">target</span> <span class="o">=</span> <span class="n">Channel</span><span class="o">.</span><span class="n">from</span><span class="p">(</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;x&#39;</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;y&#39;</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;z&#39;</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="s1">&#39;p&#39;</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="s1">&#39;q&#39;</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="s1">&#39;t&#39;</span><span class="p">]</span> <span class="p">)</span>

<span class="n">source</span><span class="o">.</span><span class="n">cross</span><span class="p">(</span><span class="n">target</span><span class="p">)</span><span class="o">.</span><span class="n">subscribe</span> <span class="p">{</span> <span class="n">println</span> <span class="n">it</span> <span class="p">}</span>
</pre></div>
</div>
<p>It will output:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="n">alpha</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="n">x</span><span class="p">]</span> <span class="p">]</span>
<span class="p">[</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="n">alpha</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="n">y</span><span class="p">]</span> <span class="p">]</span>
<span class="p">[</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="n">alpha</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="n">z</span><span class="p">]</span> <span class="p">]</span>
<span class="p">[</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="n">beta</span><span class="p">],</span>  <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="n">p</span><span class="p">]</span> <span class="p">]</span>
<span class="p">[</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="n">beta</span><span class="p">],</span>  <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="n">q</span><span class="p">]</span> <span class="p">]</span>
<span class="p">[</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="n">beta</span><span class="p">],</span>  <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="n">t</span><span class="p">]</span> <span class="p">]</span>
</pre></div>
</div>
<p>The above example shows how the items emitted by the source channels are associated to the ones
emitted by the target channel (on the right) having the same key.</p>
<p>There are two important caveats when using the <code class="docutils literal notranslate"><span class="pre">cross</span></code> operator:</p>
<blockquote>
<div><ol class="arabic simple">
<li>The operator is not <cite>reflexive</cite>, i.e. the result of <code class="docutils literal notranslate"><span class="pre">a.cross(b)</span></code> is different from <code class="docutils literal notranslate"><span class="pre">b.cross(a)</span></code></li>
<li>The source channel should emits items for which there’s no key repetition i.e. the emitted
items have an unique key identifier.</li>
</ol>
</div></blockquote>
<p>Optionally, a mapping function can be specified in order to provide a custom rule to associate an item to a key,
in a similar manner as shown for the <a class="reference internal" href="#phase">phase</a> operator.</p>
</div>
<div class="section" id="collectfile">
<h3>collectFile<a class="headerlink" href="#collectfile" title="永久链接至标题">¶</a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">collectFile</span></code> operator allows you to gather the items emitted by a channel and save them to one or more files.
The operator returns a new channel that emits the collected file(s).</p>
<p>In the simplest case, just specify the name of a file where the entries have to be stored. For example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Channel</span>
    <span class="o">.</span><span class="n">from</span><span class="p">(</span><span class="s1">&#39;alpha&#39;</span><span class="p">,</span> <span class="s1">&#39;beta&#39;</span><span class="p">,</span> <span class="s1">&#39;gamma&#39;</span><span class="p">)</span>
    <span class="o">.</span><span class="n">collectFile</span><span class="p">(</span><span class="n">name</span><span class="p">:</span> <span class="s1">&#39;sample.txt&#39;</span><span class="p">,</span> <span class="n">newLine</span><span class="p">:</span> <span class="n">true</span><span class="p">)</span>
    <span class="o">.</span><span class="n">subscribe</span> <span class="p">{</span>
        <span class="n">println</span> <span class="s2">&quot;Entries are saved to file: $it&quot;</span>
        <span class="n">println</span> <span class="s2">&quot;File content is: $</span><span class="si">{it.text}</span><span class="s2">&quot;</span>
    <span class="p">}</span>
</pre></div>
</div>
<p>A second version of the <code class="docutils literal notranslate"><span class="pre">collectFile</span></code> operator allows you to gather the items emitted by a channel and group them together
into files whose name can be defined by a dynamic criteria. The grouping criteria is specified by a <a class="reference internal" href="script.html#script-closure"><span class="std std-ref">closure</span></a>
that must return a pair in which the first element defines the file name for the group and the second element the actual
value to be appended to that file. For example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Channel</span>
   <span class="o">.</span><span class="n">from</span><span class="p">(</span><span class="s1">&#39;Hola&#39;</span><span class="p">,</span> <span class="s1">&#39;Ciao&#39;</span><span class="p">,</span> <span class="s1">&#39;Hello&#39;</span><span class="p">,</span> <span class="s1">&#39;Bonjour&#39;</span><span class="p">,</span> <span class="s1">&#39;Halo&#39;</span><span class="p">)</span>
   <span class="o">.</span><span class="n">collectFile</span><span class="p">()</span> <span class="p">{</span> <span class="n">item</span> <span class="o">-&gt;</span>
       <span class="p">[</span> <span class="s2">&quot;$</span><span class="si">{item[0]}</span><span class="s2">.txt&quot;</span><span class="p">,</span> <span class="n">item</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="p">]</span>
   <span class="p">}</span>
   <span class="o">.</span><span class="n">subscribe</span> <span class="p">{</span>
       <span class="n">println</span> <span class="s2">&quot;File $</span><span class="si">{it.name}</span><span class="s2"> contains:&quot;</span>
       <span class="n">println</span> <span class="n">it</span><span class="o">.</span><span class="n">text</span>
   <span class="p">}</span>
</pre></div>
</div>
<p>It will print:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">File</span> <span class="s1">&#39;B.txt&#39;</span> <span class="n">contains</span><span class="p">:</span>
<span class="n">Bonjour</span>

<span class="n">File</span> <span class="s1">&#39;C.txt&#39;</span> <span class="n">contains</span><span class="p">:</span>
<span class="n">Ciao</span>

<span class="n">File</span> <span class="s1">&#39;H.txt&#39;</span> <span class="n">contains</span><span class="p">:</span>
<span class="n">Halo</span>
<span class="n">Hola</span>
<span class="n">Hello</span>
</pre></div>
</div>
<div class="admonition tip">
<p class="first admonition-title">小技巧</p>
<p class="last">When the items emitted by the source channel are files, the grouping criteria can be omitted. In this case
the items content will be grouped in file(s) having the same name as the source items.</p>
</div>
<p>The following parameters can be used with the <code class="docutils literal notranslate"><span class="pre">collectFile</span></code> operator:</p>
<table border="1" class="docutils">
<colgroup>
<col width="8%" />
<col width="92%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Name</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>keepHeader</td>
<td>Prepend the resulting file with the header fetched in the first collected file. The header size (ie. lines) can be specified by using the <code class="docutils literal notranslate"><span class="pre">size</span></code> parameter (default: <code class="docutils literal notranslate"><span class="pre">false</span></code>).</td>
</tr>
<tr class="row-odd"><td>name</td>
<td>Name of the file where all received values are stored.</td>
</tr>
<tr class="row-even"><td>newLine</td>
<td>Appends a <code class="docutils literal notranslate"><span class="pre">newline</span></code> character automatically after each entry (default: <code class="docutils literal notranslate"><span class="pre">false</span></code>).</td>
</tr>
<tr class="row-odd"><td>seed</td>
<td>A value or a map of values used to initialise the files content.</td>
</tr>
<tr class="row-even"><td>skip</td>
<td>Skip the first <cite>n</cite> lines eg. <code class="docutils literal notranslate"><span class="pre">skip:</span> <span class="pre">1</span></code>.</td>
</tr>
<tr class="row-odd"><td>sort</td>
<td>Defines sorting criteria of content in resulting file(s). See below for sorting options.</td>
</tr>
<tr class="row-even"><td>storeDir</td>
<td>Folder where the resulting file(s) are be stored.</td>
</tr>
<tr class="row-odd"><td>tempDir</td>
<td>Folder where temporary files, used by the collecting process, are stored.</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">注解</p>
<p class="last">The file content is sorted in such a way that it does not depend on the order on which
entries have been added to it, this guarantees that it is consistent (i.e. do not change) across different executions
with the same data.</p>
</div>
<p>The ordering of file’s content can be defined by using the <code class="docutils literal notranslate"><span class="pre">sort</span></code> parameter. The following criteria
can be specified:</p>
<table border="1" class="docutils">
<colgroup>
<col width="7%" />
<col width="93%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Sort</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>false</td>
<td>Disable content sorting. Entries are appended as they are produced.</td>
</tr>
<tr class="row-odd"><td>true</td>
<td>Order the content by the entries natural ordering i.e. numerical for number, lexicographic for string, etc. See <a class="reference external" href="http://docs.oracle.com/javase/tutorial/collections/interfaces/order.html">http://docs.oracle.com/javase/tutorial/collections/interfaces/order.html</a></td>
</tr>
<tr class="row-even"><td>index</td>
<td>Order the content by the incremental index number assigned to each entry while they are collected.</td>
</tr>
<tr class="row-odd"><td>hash</td>
<td>Order the content by the hash number associated to each entry (default)</td>
</tr>
<tr class="row-even"><td>deep</td>
<td>Similar to the previous, but the hash number is created on actual entries content e.g. when the entry is a file the hash is created on the actual file content.</td>
</tr>
<tr class="row-odd"><td><cite>custom</cite></td>
<td>A custom sorting criteria can be specified by using either a <a class="reference internal" href="script.html#script-closure"><span class="std std-ref">Closure</span></a> or a <a class="reference external" href="http://docs.oracle.com/javase/7/docs/api/java/util/Comparator.html">Comparator</a> object.</td>
</tr>
</tbody>
</table>
<p>For example the following snippet shows how sort the content of the result file alphabetically:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Channel</span>
   <span class="o">.</span><span class="n">from</span><span class="p">(</span><span class="s1">&#39;Z&#39;</span><span class="o">..</span><span class="s1">&#39;A&#39;</span><span class="p">)</span>
   <span class="o">.</span><span class="n">collectFile</span><span class="p">(</span><span class="n">name</span><span class="p">:</span><span class="s1">&#39;result&#39;</span><span class="p">,</span> <span class="n">sort</span><span class="p">:</span> <span class="n">true</span><span class="p">,</span> <span class="n">newLine</span><span class="p">:</span> <span class="n">true</span><span class="p">)</span>
   <span class="o">.</span><span class="n">subscribe</span> <span class="p">{</span>
       <span class="n">println</span> <span class="n">it</span><span class="o">.</span><span class="n">text</span>
   <span class="p">}</span>
</pre></div>
</div>
<p>It will print:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">A</span>
<span class="n">B</span>
<span class="n">C</span>
<span class="p">:</span>
<span class="n">Z</span>
</pre></div>
</div>
<p>The following example shows how use a <cite>closure</cite> to collect and sort all sequences in a FASTA file from shortest to longest:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Channel</span>
     <span class="o">.</span><span class="n">fromPath</span><span class="p">(</span><span class="s1">&#39;/data/sequences.fa&#39;</span><span class="p">)</span>
     <span class="o">.</span><span class="n">splitFasta</span><span class="p">(</span> <span class="n">record</span><span class="p">:</span> <span class="p">[</span><span class="nb">id</span><span class="p">:</span> <span class="n">true</span><span class="p">,</span> <span class="n">sequence</span><span class="p">:</span> <span class="n">true</span><span class="p">]</span> <span class="p">)</span>
     <span class="o">.</span><span class="n">collectFile</span><span class="p">(</span> <span class="n">name</span><span class="p">:</span><span class="s1">&#39;result.fa&#39;</span><span class="p">,</span> <span class="n">sort</span><span class="p">:</span> <span class="p">{</span> <span class="n">it</span><span class="o">.</span><span class="n">size</span><span class="p">()</span> <span class="p">}</span> <span class="p">)</span>  <span class="p">{</span>
        <span class="n">it</span><span class="o">.</span><span class="n">sequence</span>
      <span class="p">}</span>
     <span class="o">.</span><span class="n">subscribe</span> <span class="p">{</span> <span class="n">println</span> <span class="n">it</span><span class="o">.</span><span class="n">text</span> <span class="p">}</span>
</pre></div>
</div>
<div class="admonition warning">
<p class="first admonition-title">警告</p>
<p class="last">The <code class="docutils literal notranslate"><span class="pre">collectFile</span></code> operator to carry out its function need to store in a temporary folder that is
automatically deleted on job completion. For performance reason this folder is allocated in the machine local storage,
and it will require as much free space as are the data you are collecting. Optionally, an alternative temporary data
folder can be specified by using the <code class="docutils literal notranslate"><span class="pre">tempDir</span></code> parameter.</p>
</div>
</div>
<div class="section" id="combine">
<span id="operator-combine"></span><h3>combine<a class="headerlink" href="#combine" title="永久链接至标题">¶</a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">combine</span></code> operator combines (cartesian product) the items emitted by two channels or by a channel and a <code class="docutils literal notranslate"><span class="pre">Collection</span></code>
object (as right operand). For example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">numbers</span> <span class="o">=</span> <span class="n">Channel</span><span class="o">.</span><span class="n">from</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
<span class="n">words</span> <span class="o">=</span> <span class="n">Channel</span><span class="o">.</span><span class="n">from</span><span class="p">(</span><span class="s1">&#39;hello&#39;</span><span class="p">,</span> <span class="s1">&#39;ciao&#39;</span><span class="p">)</span>
<span class="n">numbers</span>
    <span class="o">.</span><span class="n">combine</span><span class="p">(</span><span class="n">words</span><span class="p">)</span>
    <span class="o">.</span><span class="n">println</span><span class="p">()</span>

<span class="c1"># outputs</span>
<span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="n">hello</span><span class="p">]</span>
<span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="n">hello</span><span class="p">]</span>
<span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="n">hello</span><span class="p">]</span>
<span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="n">ciao</span><span class="p">]</span>
<span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="n">ciao</span><span class="p">]</span>
<span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="n">ciao</span><span class="p">]</span>
</pre></div>
</div>
<p>A second version of the <code class="docutils literal notranslate"><span class="pre">combine</span></code> operator allows you to combine between them those items that share a common
matching key. The index of the key element is specified by using the <code class="docutils literal notranslate"><span class="pre">by</span></code> parameter (the index is zero-based,
multiple indexes can be specified with list a integers).
For example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">left</span> <span class="o">=</span> <span class="n">Channel</span><span class="o">.</span><span class="n">from</span><span class="p">([</span><span class="s1">&#39;A&#39;</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;B&#39;</span><span class="p">,</span><span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;A&#39;</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>
<span class="n">right</span> <span class="o">=</span> <span class="n">Channel</span><span class="o">.</span><span class="n">from</span><span class="p">([</span><span class="s1">&#39;B&#39;</span><span class="p">,</span><span class="s1">&#39;x&#39;</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;B&#39;</span><span class="p">,</span><span class="s1">&#39;y&#39;</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;A&#39;</span><span class="p">,</span><span class="s1">&#39;z&#39;</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">])</span>

<span class="n">left</span>
    <span class="o">.</span><span class="n">combine</span><span class="p">(</span><span class="n">right</span><span class="p">,</span> <span class="n">by</span><span class="p">:</span> <span class="mi">0</span><span class="p">)</span>
    <span class="o">.</span><span class="n">println</span><span class="p">()</span>

<span class="c1"># outputs</span>
<span class="p">[</span><span class="n">A</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">z</span><span class="p">]</span>
<span class="p">[</span><span class="n">A</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">z</span><span class="p">]</span>
<span class="p">[</span><span class="n">A</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">w</span><span class="p">]</span>
<span class="p">[</span><span class="n">A</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">w</span><span class="p">]</span>
<span class="p">[</span><span class="n">B</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">x</span><span class="p">]</span>
<span class="p">[</span><span class="n">B</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">y</span><span class="p">]</span>
</pre></div>
</div>
<p>See also <a class="reference internal" href="#cross">cross</a>, <a class="reference internal" href="#spread">spread</a> and <a class="reference internal" href="#phase">phase</a>.</p>
</div>
<div class="section" id="concat">
<span id="operator-concat"></span><h3>concat<a class="headerlink" href="#concat" title="永久链接至标题">¶</a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">concat</span></code> operator allows you to <cite>concatenate</cite> the items emitted by two or more channels to a new channel, in such
a way that the items emitted by the resulting channel are in same order as they were when specified as operator arguments.</p>
<p>In other words it guarantees that given any <cite>n</cite> channels, the concatenation channel emits the items proceeding from the channel <cite>i+1 th</cite>
only after <cite>all</cite> the items proceeding from the channel <cite>i th</cite> were emitted.</p>
<p>For example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">a</span> <span class="o">=</span> <span class="n">Channel</span><span class="o">.</span><span class="n">from</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">,</span><span class="s1">&#39;b&#39;</span><span class="p">,</span><span class="s1">&#39;c&#39;</span><span class="p">)</span>
<span class="n">b</span> <span class="o">=</span> <span class="n">Channel</span><span class="o">.</span><span class="n">from</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
<span class="n">c</span> <span class="o">=</span> <span class="n">Channel</span><span class="o">.</span><span class="n">from</span><span class="p">(</span><span class="s1">&#39;p&#39;</span><span class="p">,</span><span class="s1">&#39;q&#39;</span><span class="p">)</span>

<span class="n">c</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span> <span class="n">b</span><span class="p">,</span> <span class="n">a</span> <span class="p">)</span><span class="o">.</span><span class="n">subscribe</span> <span class="p">{</span> <span class="n">println</span> <span class="n">it</span> <span class="p">}</span>
</pre></div>
</div>
<p>It will output:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">p</span>
<span class="n">q</span>
<span class="mi">1</span>
<span class="mi">2</span>
<span class="mi">3</span>
<span class="n">a</span>
<span class="n">b</span>
<span class="n">c</span>
</pre></div>
</div>
</div>
<div class="section" id="spread">
<span id="operator-spread"></span><h3>spread<a class="headerlink" href="#spread" title="永久链接至标题">¶</a></h3>
<div class="admonition warning">
<p class="first admonition-title">警告</p>
<p class="last">This operator is deprecated. See <a class="reference internal" href="#combine">combine</a> instead.</p>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">spread</span></code> operator combines the items emitted by the source channel with all the values in an array
or a <code class="docutils literal notranslate"><span class="pre">Collection</span></code> object specified as the operator argument. For example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Channel</span>
    <span class="o">.</span><span class="n">from</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
    <span class="o">.</span><span class="n">spread</span><span class="p">([</span><span class="s1">&#39;a&#39;</span><span class="p">,</span><span class="s1">&#39;b&#39;</span><span class="p">])</span>
    <span class="o">.</span><span class="n">subscribe</span> <span class="n">onNext</span><span class="p">:</span> <span class="p">{</span> <span class="n">println</span> <span class="n">it</span> <span class="p">},</span> <span class="n">onComplete</span><span class="p">:</span> <span class="p">{</span> <span class="n">println</span> <span class="s1">&#39;Done&#39;</span> <span class="p">}</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;a&#39;</span><span class="p">]</span>
<span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">]</span>
<span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;a&#39;</span><span class="p">]</span>
<span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">]</span>
<span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="s1">&#39;a&#39;</span><span class="p">]</span>
<span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">]</span>
<span class="n">Done</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="forking-operators">
<h2>Forking operators<a class="headerlink" href="#forking-operators" title="永久链接至标题">¶</a></h2>
<p>The forking operators are:</p>
<ul class="simple">
<li><a class="reference internal" href="#choice">choice</a></li>
<li><a class="reference internal" href="#separate">separate</a></li>
<li><a class="reference internal" href="#route">route</a></li>
</ul>
<div class="section" id="choice">
<h3>choice<a class="headerlink" href="#choice" title="永久链接至标题">¶</a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">choice</span></code> operator allows you to forward the items emitted by a source channel to two
(or more) output channels, <cite>choosing</cite> one out of them at a time.</p>
<p>The destination channel is selected by using a <a class="reference internal" href="script.html#script-closure"><span class="std std-ref">closure</span></a> that must return the <cite>index</cite> number of the channel
where the item has to be sent. The first channel is identified by the index <code class="docutils literal notranslate"><span class="pre">0</span></code>, the second as <code class="docutils literal notranslate"><span class="pre">1</span></code> and so on.</p>
<p>The following example sends all string items beginning with <code class="docutils literal notranslate"><span class="pre">Hello</span></code> into <code class="docutils literal notranslate"><span class="pre">queue1</span></code>,
the others into <code class="docutils literal notranslate"><span class="pre">queue2</span></code></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>source = Channel.from &#39;Hello world&#39;, &#39;Hola&#39;, &#39;Hello John&#39;
queue1 = Channel.create()
queue2 = Channel.create()

source.choice( queue1, queue2 ) { a -&gt; a =~ /^Hello.*/ ? 0 : 1 }

queue1.subscribe { println it }
</pre></div>
</div>
</div>
<div class="section" id="separate">
<h3>separate<a class="headerlink" href="#separate" title="永久链接至标题">¶</a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">separate</span></code> operator lets you copy the items emitted by the source channel into multiple
channels, which each of these can receive a <cite>separate</cite> version of the same item.</p>
<p>The operator applies a <cite>mapping function</cite> of your choosing to every item emitted by the source channel.
This function must return a list of as many values as there are output channels. Each entry in the result
list will be assigned to the output channel with the corresponding position index. For example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">queue1</span> <span class="o">=</span> <span class="n">Channel</span><span class="o">.</span><span class="n">create</span><span class="p">()</span>
<span class="n">queue2</span> <span class="o">=</span> <span class="n">Channel</span><span class="o">.</span><span class="n">create</span><span class="p">()</span>

<span class="n">Channel</span>
    <span class="o">.</span><span class="kn">from</span> <span class="p">(</span> <span class="mi">2</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">8</span> <span class="p">)</span>
    <span class="o">.</span><span class="n">separate</span><span class="p">(</span> <span class="n">queue1</span><span class="p">,</span> <span class="n">queue2</span> <span class="p">)</span> <span class="p">{</span> <span class="n">a</span> <span class="o">-&gt;</span> <span class="p">[</span><span class="n">a</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">a</span><span class="o">*</span><span class="n">a</span><span class="p">]</span> <span class="p">}</span>

<span class="n">queue1</span><span class="o">.</span><span class="n">subscribe</span> <span class="p">{</span> <span class="n">println</span> <span class="s2">&quot;Channel 1: $it&quot;</span> <span class="p">}</span>
<span class="n">queue2</span><span class="o">.</span><span class="n">subscribe</span> <span class="p">{</span> <span class="n">println</span> <span class="s2">&quot;Channel 2: $it&quot;</span> <span class="p">}</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Channel</span> <span class="mi">1</span><span class="p">:</span> <span class="mi">3</span>
<span class="n">Channel</span> <span class="mi">2</span><span class="p">:</span> <span class="mi">4</span>
<span class="n">Channel</span> <span class="mi">1</span><span class="p">:</span> <span class="mi">5</span>
<span class="n">Channel</span> <span class="mi">2</span><span class="p">:</span> <span class="mi">16</span>
<span class="n">Channel</span> <span class="mi">2</span><span class="p">:</span> <span class="mi">64</span>
<span class="n">Channel</span> <span class="mi">1</span><span class="p">:</span> <span class="mi">9</span>
</pre></div>
</div>
<p>When the <cite>mapping function</cite> is omitted, the source channel must emit tuples of values. In this case the operator <code class="docutils literal notranslate"><span class="pre">separate</span></code>
splits the tuple in such a way that the value <cite>i-th</cite> in a tuple is assigned to the target channel with the corresponding position index.
For example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">alpha</span> <span class="o">=</span> <span class="n">Channel</span><span class="o">.</span><span class="n">create</span><span class="p">()</span>
<span class="n">delta</span> <span class="o">=</span> <span class="n">Channel</span><span class="o">.</span><span class="n">create</span><span class="p">()</span>

<span class="n">Channel</span>
   <span class="o">.</span><span class="n">from</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">,</span><span class="s1">&#39;b&#39;</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;p&#39;</span><span class="p">,</span><span class="s1">&#39;q&#39;</span><span class="p">])</span>
   <span class="o">.</span><span class="n">separate</span><span class="p">(</span> <span class="n">alpha</span><span class="p">,</span> <span class="n">delta</span> <span class="p">)</span>

<span class="n">alpha</span><span class="o">.</span><span class="n">subscribe</span> <span class="p">{</span> <span class="n">println</span> <span class="s2">&quot;first : $it&quot;</span> <span class="p">}</span>
<span class="n">delta</span><span class="o">.</span><span class="n">subscribe</span> <span class="p">{</span> <span class="n">println</span> <span class="s2">&quot;second: $it&quot;</span> <span class="p">}</span>
</pre></div>
</div>
<p>It will output:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">first</span> <span class="p">:</span> <span class="mi">1</span>
<span class="n">first</span> <span class="p">:</span> <span class="n">a</span>
<span class="n">first</span> <span class="p">:</span> <span class="n">p</span>
<span class="n">second</span><span class="p">:</span> <span class="mi">2</span>
<span class="n">second</span><span class="p">:</span> <span class="n">b</span>
<span class="n">second</span><span class="p">:</span> <span class="n">q</span>
</pre></div>
</div>
<p>A second version of the <code class="docutils literal notranslate"><span class="pre">separate</span></code> operator takes an integer <cite>n</cite> as an argument and returns a list of <cite>n</cite> channels,
each of which gets a value from the corresponding element in the list returned by the closure as explained above.
For example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">source</span> <span class="o">=</span> <span class="n">Channel</span><span class="o">.</span><span class="n">from</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
<span class="p">(</span><span class="n">queue1</span><span class="p">,</span> <span class="n">queue2</span><span class="p">,</span> <span class="n">queue3</span><span class="p">)</span> <span class="o">=</span> <span class="n">source</span><span class="o">.</span><span class="n">separate</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="p">{</span> <span class="n">a</span> <span class="o">-&gt;</span> <span class="p">[</span><span class="n">a</span><span class="p">,</span> <span class="n">a</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">a</span><span class="o">*</span><span class="n">a</span><span class="p">]</span> <span class="p">}</span>

<span class="n">queue1</span><span class="o">.</span><span class="n">subscribe</span> <span class="p">{</span> <span class="n">println</span> <span class="s2">&quot;Queue 1 &gt; $it&quot;</span> <span class="p">}</span>
<span class="n">queue2</span><span class="o">.</span><span class="n">subscribe</span> <span class="p">{</span> <span class="n">println</span> <span class="s2">&quot;Queue 2 &gt; $it&quot;</span> <span class="p">}</span>
<span class="n">queue3</span><span class="o">.</span><span class="n">subscribe</span> <span class="p">{</span> <span class="n">println</span> <span class="s2">&quot;Queue 3 &gt; $it&quot;</span> <span class="p">}</span>
</pre></div>
</div>
<p>The output will look like the following fragment:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Queue</span> <span class="mi">1</span> <span class="o">&gt;</span> <span class="mi">1</span>
<span class="n">Queue</span> <span class="mi">1</span> <span class="o">&gt;</span> <span class="mi">2</span>
<span class="n">Queue</span> <span class="mi">1</span> <span class="o">&gt;</span> <span class="mi">3</span>
<span class="n">Queue</span> <span class="mi">2</span> <span class="o">&gt;</span> <span class="mi">2</span>
<span class="n">Queue</span> <span class="mi">2</span> <span class="o">&gt;</span> <span class="mi">3</span>
<span class="n">Queue</span> <span class="mi">2</span> <span class="o">&gt;</span> <span class="mi">4</span>
<span class="n">Queue</span> <span class="mi">3</span> <span class="o">&gt;</span> <span class="mi">1</span>
<span class="n">Queue</span> <span class="mi">3</span> <span class="o">&gt;</span> <span class="mi">4</span>
<span class="n">Queue</span> <span class="mi">3</span> <span class="o">&gt;</span> <span class="mi">9</span>
</pre></div>
</div>
<div class="admonition warning">
<p class="first admonition-title">警告</p>
<p class="last">In the above example, please note that since the <code class="docutils literal notranslate"><span class="pre">subscribe</span></code> operator is asynchronous,
the output of <code class="docutils literal notranslate"><span class="pre">channel2</span></code> and <code class="docutils literal notranslate"><span class="pre">channel3</span></code> can be printed before the content of <code class="docutils literal notranslate"><span class="pre">channel1</span></code>.</p>
</div>
<div class="admonition note">
<p class="first admonition-title">注解</p>
<p class="last">The above example takes advantage of the <a class="reference internal" href="script.html#script-multiple-assignment"><span class="std std-ref">multiple assignment</span></a> syntax
in order to assign two variables at once using the list of channels returned by the <code class="docutils literal notranslate"><span class="pre">separate</span></code> operator.</p>
</div>
<p>See also: <a class="reference internal" href="#into">into</a>, <a class="reference internal" href="#choice">choice</a> and <a class="reference internal" href="#map">map</a> operators.</p>
</div>
<div class="section" id="route">
<h3>route<a class="headerlink" href="#route" title="永久链接至标题">¶</a></h3>
<div class="admonition warning">
<p class="first admonition-title">警告</p>
<p class="last">This operator is deprecated. It will be removed in a future release.</p>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">route</span></code> operator allows you to forward the items emitted by the source channel
to a channel which is associated with the item’s key.</p>
<p>The channel’s keys are specified by using a map parameter as the operator argument,
that associates each channel with a key identifier.</p>
<p>The item’s key is defined, by default, as the first entry in an array, a list or map object,
or the value itself for any other data type.</p>
<p>Optionally, a mapping function can be specified as a parameter in order to provide a custom
rule to associate an item with a key, as shown in the example below:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">r1</span> <span class="o">=</span> <span class="n">Channel</span><span class="o">.</span><span class="n">create</span><span class="p">()</span>
<span class="n">r2</span> <span class="o">=</span> <span class="n">Channel</span><span class="o">.</span><span class="n">create</span><span class="p">()</span>
<span class="n">r3</span> <span class="o">=</span> <span class="n">Channel</span><span class="o">.</span><span class="n">create</span><span class="p">()</span>

<span class="n">Channel</span>
    <span class="o">.</span><span class="n">from</span><span class="p">(</span><span class="s1">&#39;hello&#39;</span><span class="p">,</span><span class="s1">&#39;ciao&#39;</span><span class="p">,</span><span class="s1">&#39;hola&#39;</span><span class="p">,</span> <span class="s1">&#39;hi&#39;</span><span class="p">,</span> <span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="s1">&#39;bonjour&#39;</span><span class="p">)</span>
    <span class="o">.</span><span class="n">route</span> <span class="p">(</span> <span class="n">b</span><span class="p">:</span> <span class="n">r1</span><span class="p">,</span> <span class="n">c</span><span class="p">:</span> <span class="n">r2</span><span class="p">,</span> <span class="n">h</span><span class="p">:</span> <span class="n">r3</span> <span class="p">)</span> <span class="p">{</span> <span class="n">it</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="p">}</span>

    <span class="n">r3</span><span class="o">.</span><span class="n">subscribe</span> <span class="p">{</span> <span class="n">println</span> <span class="n">it</span> <span class="p">}</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">hello</span>
<span class="n">hola</span>
<span class="n">hi</span>
</pre></div>
</div>
<p>In the above example all the string items starting with the letter <code class="docutils literal notranslate"><span class="pre">b</span></code> are copied to the
channel <code class="docutils literal notranslate"><span class="pre">r1</span></code>, the items that begin with <code class="docutils literal notranslate"><span class="pre">c</span></code> to the channel <code class="docutils literal notranslate"><span class="pre">r2</span></code> and the ones beginning
with <code class="docutils literal notranslate"><span class="pre">h</span></code> are copied to the channel <code class="docutils literal notranslate"><span class="pre">r3</span></code>. Other items eventually existing are discarded.</p>
<p>See also: <a class="reference internal" href="#into">into</a>, <a class="reference internal" href="#choice">choice</a>  and <a class="reference internal" href="#separate">separate</a> operators.</p>
</div>
</div>
<div class="section" id="maths-operators">
<h2>Maths operators<a class="headerlink" href="#maths-operators" title="永久链接至标题">¶</a></h2>
<p>This section talks about operators that performs maths operations on channels.</p>
<p>The maths operators are:</p>
<ul class="simple">
<li><a class="reference internal" href="#count">count</a></li>
<li><a class="reference internal" href="#countby">countBy</a></li>
<li><a class="reference internal" href="#min">min</a></li>
<li><a class="reference internal" href="#max">max</a></li>
<li><a class="reference internal" href="#sum">sum</a></li>
<li><a class="reference internal" href="#tointeger">toInteger</a></li>
</ul>
<div class="section" id="count">
<span id="operator-count"></span><h3>count<a class="headerlink" href="#count" title="永久链接至标题">¶</a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">count</span></code> operator creates a channel that emits a single item: a number that represents the total number of
items emitted by the source channel. For example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Channel</span>
    <span class="o">.</span><span class="n">from</span><span class="p">(</span><span class="mi">9</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="mi">5</span><span class="p">)</span>
    <span class="o">.</span><span class="n">count</span><span class="p">()</span>
    <span class="o">.</span><span class="n">subscribe</span> <span class="p">{</span> <span class="n">println</span> <span class="n">it</span> <span class="p">}</span>
<span class="o">//</span> <span class="o">-&gt;</span> <span class="mi">4</span>
</pre></div>
</div>
<p>An optional parameter can be provided in order to select which items are to be counted.
The selection criteria can be specified either as a <a class="reference internal" href="script.html#script-regexp"><span class="std std-ref">regular expression</span></a>,
a literal value, a Java class, or a <cite>boolean predicate</cite> that needs to be satisfied. For example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Channel</span>
    <span class="o">.</span><span class="n">from</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
    <span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
    <span class="o">.</span><span class="n">subscribe</span> <span class="p">{</span> <span class="n">println</span> <span class="n">it</span> <span class="p">}</span>
 <span class="o">//</span> <span class="o">-&gt;</span> <span class="mi">3</span>

<span class="n">Channel</span>
    <span class="o">.</span><span class="n">from</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">,</span><span class="s1">&#39;c&#39;</span><span class="p">,</span><span class="s1">&#39;c&#39;</span><span class="p">,</span><span class="s1">&#39;q&#39;</span><span class="p">,</span><span class="s1">&#39;b&#39;</span><span class="p">)</span>
    <span class="o">.</span><span class="n">count</span> <span class="p">(</span> <span class="o">~/</span><span class="n">c</span><span class="o">/</span> <span class="p">)</span>
    <span class="o">.</span><span class="n">subscribe</span> <span class="p">{</span> <span class="n">println</span> <span class="n">it</span> <span class="p">}</span>
<span class="o">//</span> <span class="o">-&gt;</span> <span class="mi">2</span>

<span class="n">Channel</span>
    <span class="o">.</span><span class="n">from</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">,</span><span class="s1">&#39;c&#39;</span><span class="p">,</span><span class="s1">&#39;c&#39;</span><span class="p">,</span><span class="s1">&#39;q&#39;</span><span class="p">,</span><span class="s1">&#39;b&#39;</span><span class="p">)</span>
    <span class="o">.</span><span class="n">count</span> <span class="p">{</span> <span class="n">it</span> <span class="o">&lt;=</span> <span class="s1">&#39;c&#39;</span> <span class="p">}</span>
    <span class="o">.</span><span class="n">subscribe</span> <span class="p">{</span> <span class="n">println</span> <span class="n">it</span> <span class="p">}</span>
<span class="o">//</span> <span class="o">-&gt;</span> <span class="mi">4</span>
</pre></div>
</div>
</div>
<div class="section" id="countby">
<h3>countBy<a class="headerlink" href="#countby" title="永久链接至标题">¶</a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">countBy</span></code> operator creates a channel which emits an associative array (i.e. <code class="docutils literal notranslate"><span class="pre">Map</span></code> object)
that counts the occurrences of the emitted items in the source channel having the same key.
For example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Channel</span>
    <span class="o">.</span><span class="n">from</span><span class="p">(</span> <span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="s1">&#39;z&#39;</span><span class="p">,</span> <span class="s1">&#39;y&#39;</span> <span class="p">)</span>
    <span class="o">.</span><span class="n">countBy</span><span class="p">()</span>
    <span class="o">.</span><span class="n">subscribe</span> <span class="p">{</span> <span class="n">println</span> <span class="n">it</span> <span class="p">}</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="n">x</span><span class="p">:</span><span class="mi">3</span><span class="p">,</span> <span class="n">y</span><span class="p">:</span><span class="mi">2</span><span class="p">,</span> <span class="n">z</span><span class="p">:</span><span class="mi">1</span><span class="p">]</span>
</pre></div>
</div>
<p>An optional grouping criteria can be specified by using a <a class="reference internal" href="script.html#script-closure"><span class="std std-ref">closure</span></a>
that associates each item with the grouping key. For example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Channel</span>
    <span class="o">.</span><span class="n">from</span><span class="p">(</span> <span class="s1">&#39;hola&#39;</span><span class="p">,</span> <span class="s1">&#39;hello&#39;</span><span class="p">,</span> <span class="s1">&#39;ciao&#39;</span><span class="p">,</span> <span class="s1">&#39;bonjour&#39;</span><span class="p">,</span> <span class="s1">&#39;halo&#39;</span> <span class="p">)</span>
    <span class="o">.</span><span class="n">countBy</span> <span class="p">{</span> <span class="n">it</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="p">}</span>
    <span class="o">.</span><span class="n">subscribe</span> <span class="p">{</span> <span class="n">println</span> <span class="n">it</span> <span class="p">}</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="n">h</span><span class="p">:</span><span class="mi">3</span><span class="p">,</span> <span class="n">c</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span> <span class="n">b</span><span class="p">:</span><span class="mi">1</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="section" id="min">
<span id="operator-min"></span><h3>min<a class="headerlink" href="#min" title="永久链接至标题">¶</a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">min</span></code> operator waits until the source channel completes, and then emits the item that has the lowest value.
For example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Channel</span>
    <span class="o">.</span><span class="n">from</span><span class="p">(</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">5</span> <span class="p">)</span>
    <span class="o">.</span><span class="n">min</span><span class="p">()</span>
    <span class="o">.</span><span class="n">subscribe</span> <span class="p">{</span> <span class="n">println</span> <span class="s2">&quot;Min value is $it&quot;</span> <span class="p">}</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Min</span> <span class="n">value</span> <span class="ow">is</span> <span class="mi">2</span>
</pre></div>
</div>
<p>An optional <a class="reference internal" href="script.html#script-closure"><span class="std std-ref">closure</span></a> parameter can be specified in order to provide
a function that returns the value to be compared. The example below shows how to find the string
item that has the minimum length:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Channel</span>
    <span class="o">.</span><span class="n">from</span><span class="p">(</span><span class="s2">&quot;hello&quot;</span><span class="p">,</span><span class="s2">&quot;hi&quot;</span><span class="p">,</span><span class="s2">&quot;hey&quot;</span><span class="p">)</span>
    <span class="o">.</span><span class="n">min</span> <span class="p">{</span> <span class="n">it</span><span class="o">.</span><span class="n">size</span><span class="p">()</span> <span class="p">}</span>
    <span class="o">.</span><span class="n">subscribe</span> <span class="p">{</span>  <span class="n">println</span> <span class="n">it</span> <span class="p">}</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="s2">&quot;hi&quot;</span>
</pre></div>
</div>
<p>Alternatively it is possible to specify a comparator function i.e. a <a class="reference internal" href="script.html#script-closure"><span class="std std-ref">closure</span></a>
taking two parameters that represent two emitted items to be compared. For example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Channel</span>
    <span class="o">.</span><span class="n">from</span><span class="p">(</span><span class="s2">&quot;hello&quot;</span><span class="p">,</span><span class="s2">&quot;hi&quot;</span><span class="p">,</span><span class="s2">&quot;hey&quot;</span><span class="p">)</span>
    <span class="o">.</span><span class="n">min</span> <span class="p">{</span> <span class="n">a</span><span class="p">,</span><span class="n">b</span> <span class="o">-&gt;</span> <span class="n">a</span><span class="o">.</span><span class="n">size</span><span class="p">()</span> <span class="o">&lt;=&gt;</span> <span class="n">b</span><span class="o">.</span><span class="n">size</span><span class="p">()</span> <span class="p">}</span>
    <span class="o">.</span><span class="n">subscribe</span> <span class="p">{</span>  <span class="n">println</span> <span class="n">it</span> <span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="max">
<span id="operator-max"></span><h3>max<a class="headerlink" href="#max" title="永久链接至标题">¶</a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">max</span></code> operator waits until the source channel completes, and then emits the item that has the greatest value.
For example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Channel</span>
    <span class="o">.</span><span class="n">from</span><span class="p">(</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">5</span> <span class="p">)</span>
    <span class="o">.</span><span class="n">min</span><span class="p">()</span>
    <span class="o">.</span><span class="n">subscribe</span> <span class="p">{</span> <span class="n">println</span> <span class="s2">&quot;Max value is $it&quot;</span> <span class="p">}</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Max</span> <span class="n">value</span> <span class="ow">is</span> <span class="mi">8</span>
</pre></div>
</div>
<p>An optional <a class="reference internal" href="script.html#script-closure"><span class="std std-ref">closure</span></a> parameter can be specified in order to provide
a function that returns the value to be compared. The example below shows how to find the string
item that has the maximum length:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Channel</span>
    <span class="o">.</span><span class="n">from</span><span class="p">(</span><span class="s2">&quot;hello&quot;</span><span class="p">,</span><span class="s2">&quot;hi&quot;</span><span class="p">,</span><span class="s2">&quot;hey&quot;</span><span class="p">)</span>
    <span class="o">.</span><span class="n">max</span> <span class="p">{</span> <span class="n">it</span><span class="o">.</span><span class="n">size</span><span class="p">()</span> <span class="p">}</span>
    <span class="o">.</span><span class="n">subscribe</span> <span class="p">{</span>  <span class="n">println</span> <span class="n">it</span> <span class="p">}</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="s2">&quot;hello&quot;</span>
</pre></div>
</div>
<p>Alternatively it is possible to specify a comparator function i.e. a <a class="reference internal" href="script.html#script-closure"><span class="std std-ref">closure</span></a>
taking two parameters that represent two emitted items to be compared. For example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Channel</span>
    <span class="o">.</span><span class="n">from</span><span class="p">(</span><span class="s2">&quot;hello&quot;</span><span class="p">,</span><span class="s2">&quot;hi&quot;</span><span class="p">,</span><span class="s2">&quot;hey&quot;</span><span class="p">)</span>
    <span class="o">.</span><span class="n">max</span> <span class="p">{</span> <span class="n">a</span><span class="p">,</span><span class="n">b</span> <span class="o">-&gt;</span> <span class="n">a</span><span class="o">.</span><span class="n">size</span><span class="p">()</span> <span class="o">&lt;=&gt;</span> <span class="n">b</span><span class="o">.</span><span class="n">size</span><span class="p">()</span> <span class="p">}</span>
    <span class="o">.</span><span class="n">subscribe</span> <span class="p">{</span>  <span class="n">println</span> <span class="n">it</span> <span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="sum">
<span id="operator-sum"></span><h3>sum<a class="headerlink" href="#sum" title="永久链接至标题">¶</a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">sum</span></code> operator creates a channel that emits the sum of all the items emitted by the channel itself.
For example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Channel</span>
    <span class="o">.</span><span class="n">from</span><span class="p">(</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">5</span> <span class="p">)</span>
    <span class="o">.</span><span class="n">sum</span><span class="p">()</span>
    <span class="o">.</span><span class="n">subscribe</span> <span class="p">{</span> <span class="n">println</span> <span class="s2">&quot;The sum is $it&quot;</span> <span class="p">}</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">The</span> <span class="nb">sum</span> <span class="ow">is</span> <span class="mi">21</span>
</pre></div>
</div>
<p>An optional <a class="reference internal" href="script.html#script-closure"><span class="std std-ref">closure</span></a> parameter can be specified in order to provide
a function that, given an item, returns the value to be summed. For example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Channel</span>
        <span class="o">.</span><span class="n">from</span><span class="p">(</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">5</span> <span class="p">)</span>
        <span class="o">.</span><span class="n">sum</span> <span class="p">{</span> <span class="n">it</span> <span class="o">*</span> <span class="n">it</span> <span class="p">}</span>
        <span class="o">.</span><span class="n">subscribe</span> <span class="p">{</span>  <span class="n">println</span> <span class="s2">&quot;Square: $it&quot;</span> <span class="p">}</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Square</span><span class="p">:</span> <span class="mi">91</span>
</pre></div>
</div>
</div>
<div class="section" id="tointeger">
<h3>toInteger<a class="headerlink" href="#tointeger" title="永久链接至标题">¶</a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">toInteger</span></code> operator allows you to convert the string values emitted by a channel to <code class="docutils literal notranslate"><span class="pre">Integer</span></code> values. For
example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Channel</span>
    <span class="o">.</span><span class="n">from</span><span class="p">(</span> <span class="s1">&#39;1&#39;</span><span class="p">,</span> <span class="s1">&#39;7&#39;</span><span class="p">,</span> <span class="s1">&#39;12&#39;</span> <span class="p">)</span>
    <span class="o">.</span><span class="n">toInteger</span><span class="p">()</span>
    <span class="o">.</span><span class="n">sum</span><span class="p">()</span>
    <span class="o">.</span><span class="n">println</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="other-operators">
<h2>Other operators<a class="headerlink" href="#other-operators" title="永久链接至标题">¶</a></h2>
<ul class="simple">
<li><a class="reference internal" href="#close">close</a></li>
<li><a class="reference internal" href="#dump">dump</a></li>
<li><a class="reference internal" href="#ifempty">ifEmpty</a></li>
<li><a class="reference internal" href="#print">print</a></li>
<li><a class="reference internal" href="#println">println</a></li>
<li><a class="reference internal" href="#set">set</a></li>
<li><a class="reference internal" href="#view">view</a></li>
</ul>
<div class="section" id="dump">
<span id="operator-dump"></span><h3>dump<a class="headerlink" href="#dump" title="永久链接至标题">¶</a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">dump</span></code> operator prints the items emitted by the channel to which is applied only when the option
<code class="docutils literal notranslate"><span class="pre">-dump-channels</span></code> is specified on the <code class="docutils literal notranslate"><span class="pre">run</span></code> command line, otherwise it is ignored.</p>
<p>This is useful to enable the debugging of one or more channel content on-demand by using a command line option
instead of modifying your script code.</p>
<p>An optional <code class="docutils literal notranslate"><span class="pre">tag</span></code> parameter allows you to select which channel to dump. For example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Channel</span>
    <span class="o">.</span><span class="n">from</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
    <span class="o">.</span><span class="n">map</span> <span class="p">{</span> <span class="n">it</span><span class="o">+</span><span class="mi">1</span> <span class="p">}</span>
    <span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="n">tag</span><span class="p">:</span><span class="s1">&#39;foo&#39;</span><span class="p">)</span>

<span class="n">Channel</span>
    <span class="o">.</span><span class="n">from</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
    <span class="o">.</span><span class="n">map</span> <span class="p">{</span> <span class="n">it</span><span class="o">^</span><span class="mi">2</span> <span class="p">}</span>
    <span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="n">tag</span><span class="p">:</span> <span class="s1">&#39;bar&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>Then you will be able to specify the tag <code class="docutils literal notranslate"><span class="pre">foo</span></code> or <code class="docutils literal notranslate"><span class="pre">bar</span></code> as an argument of the <code class="docutils literal notranslate"><span class="pre">-dump-channels</span></code> option to print
either the content of the first or the second channel. Multiple tag names can be specified separating them with a <code class="docutils literal notranslate"><span class="pre">,</span></code>
character.</p>
</div>
<div class="section" id="set">
<span id="operator-set"></span><h3>set<a class="headerlink" href="#set" title="永久链接至标题">¶</a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">set</span></code> operator assigns the channel to a variable whose name is specified as a closure parameter.
For example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Channel</span><span class="o">.</span><span class="n">from</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">20</span><span class="p">,</span><span class="mi">30</span><span class="p">)</span><span class="o">.</span><span class="n">set</span> <span class="p">{</span> <span class="n">my_channel</span> <span class="p">}</span>
</pre></div>
</div>
<p>This is semantically equivalent to the following assignment:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">my_channel</span> <span class="o">=</span> <span class="n">Channel</span><span class="o">.</span><span class="n">from</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">20</span><span class="p">,</span><span class="mi">30</span><span class="p">)</span>
</pre></div>
</div>
<p>However the <code class="docutils literal notranslate"><span class="pre">set</span></code> operator is more idiomatic in Nextflow scripting, since it can be used at the end
of a chain of operator transformations, thus resulting in a more fluent and readable operation.</p>
</div>
<div class="section" id="ifempty">
<span id="operator-ifempty"></span><h3>ifEmpty<a class="headerlink" href="#ifempty" title="永久链接至标题">¶</a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">ifEmpty</span></code> operator creates a channel which emits a default value, specified as the operator parameter, when the channel to which
is applied is <em>empty</em> i.e. doesn’t emit any value. Otherwise it will emit the same sequence of entries as the original channel.</p>
<p>Thus, the following example prints:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Channel</span> <span class="o">.</span><span class="n">from</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span> <span class="o">.</span><span class="n">ifEmpty</span><span class="p">(</span><span class="s1">&#39;Hello&#39;</span><span class="p">)</span> <span class="o">.</span><span class="n">println</span><span class="p">()</span>

<span class="mi">1</span>
<span class="mi">2</span>
<span class="mi">3</span>
</pre></div>
</div>
<p>Instead, this one prints:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Channel</span><span class="o">.</span><span class="n">empty</span><span class="p">()</span><span class="o">.</span><span class="n">ifEmpty</span><span class="p">(</span><span class="s1">&#39;Hello&#39;</span><span class="p">)</span> <span class="o">.</span><span class="n">println</span><span class="p">()</span>

<span class="n">Hello</span>
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">ifEmpty</span></code> value parameter can be defined with a <a class="reference internal" href="script.html#script-closure"><span class="std std-ref">closure</span></a>. In this case the result value of the closure evaluation
will be emitted when the empty condition is satisfied.</p>
<p>See also: <a class="reference internal" href="channel.html#channel-empty"><span class="std std-ref">empty</span></a> method.</p>
</div>
<div class="section" id="print">
<span id="operator-print"></span><h3>print<a class="headerlink" href="#print" title="永久链接至标题">¶</a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">print</span></code> operator prints the items emitted by a channel to the standard output.
An optional <a class="reference internal" href="script.html#script-closure"><span class="std std-ref">closure</span></a> parameter can be specified to customise how items are printed.
For example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Channel</span>
      <span class="o">.</span><span class="n">from</span><span class="p">(</span><span class="s1">&#39;foo&#39;</span><span class="p">,</span> <span class="s1">&#39;bar&#39;</span><span class="p">,</span> <span class="s1">&#39;baz&#39;</span><span class="p">,</span> <span class="s1">&#39;qux&#39;</span><span class="p">)</span>
      <span class="o">.</span><span class="n">print</span> <span class="p">{</span> <span class="n">it</span><span class="o">.</span><span class="n">toUpperCase</span><span class="p">()</span> <span class="o">+</span> <span class="s1">&#39; &#39;</span> <span class="p">}</span>
</pre></div>
</div>
<p>It prints:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">FOO</span> <span class="n">BAR</span> <span class="n">BAZ</span> <span class="n">QUX</span>
</pre></div>
</div>
<p>See also: <a class="reference internal" href="#println">println</a> and <a class="reference internal" href="#view">view</a>.</p>
</div>
<div class="section" id="println">
<span id="operator-println"></span><h3>println<a class="headerlink" href="#println" title="永久链接至标题">¶</a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">println</span></code> operator prints the items emitted by a channel to the console standard output appending
a <em>new line</em> character to each of them. For example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Channel</span>
      <span class="o">.</span><span class="n">from</span><span class="p">(</span><span class="s1">&#39;foo&#39;</span><span class="p">,</span> <span class="s1">&#39;bar&#39;</span><span class="p">,</span> <span class="s1">&#39;baz&#39;</span><span class="p">,</span> <span class="s1">&#39;qux&#39;</span><span class="p">)</span>
      <span class="o">.</span><span class="n">println</span><span class="p">()</span>
</pre></div>
</div>
<p>It prints:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">foo</span>
<span class="n">bar</span>
<span class="n">baz</span>
<span class="n">qux</span>
</pre></div>
</div>
<p>An optional closure parameter can be specified to customise how items are printed. For example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Channel</span>
      <span class="o">.</span><span class="n">from</span><span class="p">(</span><span class="s1">&#39;foo&#39;</span><span class="p">,</span> <span class="s1">&#39;bar&#39;</span><span class="p">,</span> <span class="s1">&#39;baz&#39;</span><span class="p">,</span> <span class="s1">&#39;qux&#39;</span><span class="p">)</span>
      <span class="o">.</span><span class="n">println</span> <span class="p">{</span> <span class="s2">&quot;~ $it&quot;</span> <span class="p">}</span>
</pre></div>
</div>
<p>It prints:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">~</span> <span class="n">foo</span>
<span class="o">~</span> <span class="n">bar</span>
<span class="o">~</span> <span class="n">baz</span>
<span class="o">~</span> <span class="n">qux</span>
</pre></div>
</div>
<p>See also: <a class="reference internal" href="#print">print</a> and <a class="reference internal" href="#view">view</a>.</p>
</div>
<div class="section" id="view">
<span id="operator-view"></span><h3>view<a class="headerlink" href="#view" title="永久链接至标题">¶</a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">view</span></code> operator prints the items emitted by a channel to the console standard output. For example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Channel</span><span class="o">.</span><span class="n">from</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span><span class="o">.</span><span class="n">view</span><span class="p">()</span>

<span class="mi">1</span>
<span class="mi">2</span>
<span class="mi">3</span>
</pre></div>
</div>
<p>Each item is printed on a separate line unless otherwise specified by using the <code class="docutils literal notranslate"><span class="pre">newLine:</span> <span class="pre">false</span></code> optional parameter.</p>
<p>How the channel items are printed can be controlled by using an optional closure parameter. The closure it must return
the actual value of the item being to be printed:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Channel</span><span class="o">.</span><span class="n">from</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
        <span class="o">.</span><span class="n">map</span> <span class="p">{</span> <span class="n">it</span> <span class="o">-&gt;</span> <span class="p">[</span><span class="n">it</span><span class="p">,</span> <span class="n">it</span><span class="o">*</span><span class="n">it</span><span class="p">]</span> <span class="p">}</span>
        <span class="o">.</span><span class="n">view</span> <span class="p">{</span> <span class="n">num</span><span class="p">,</span> <span class="n">sqr</span> <span class="o">-&gt;</span> <span class="s2">&quot;Square of: $num is $sqr&quot;</span> <span class="p">}</span>
</pre></div>
</div>
<p>It prints:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Square</span> <span class="n">of</span><span class="p">:</span> <span class="mi">1</span> <span class="ow">is</span> <span class="mi">1</span>
<span class="n">Square</span> <span class="n">of</span><span class="p">:</span> <span class="mi">2</span> <span class="ow">is</span> <span class="mi">4</span>
<span class="n">Square</span> <span class="n">of</span><span class="p">:</span> <span class="mi">3</span> <span class="ow">is</span> <span class="mi">9</span>
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">注解</p>
<p class="last">Both the <em>view</em> and <a class="reference internal" href="#print">print</a> (or <a class="reference internal" href="#println">println</a>) operators consume them items emitted by the source channel to which they
are applied. However, the main difference between them is that the former returns a newly create channel whose content
is identical to the source one. This allows the <em>view</em> operator to be chained like other operators.</p>
</div>
</div>
<div class="section" id="close">
<span id="operator-close"></span><h3>close<a class="headerlink" href="#close" title="永久链接至标题">¶</a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">close</span></code> operator sends a termination signal over the channel, causing downstream processes or operators to stop.
In a common usage scenario channels are closed automatically by Nextflow, so you won’t need to use this operator explicitly.</p>
<p>See also: <a class="reference internal" href="channel.html#channel-empty"><span class="std std-ref">empty</span></a> factory method.</p>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="executor.html" class="btn btn-neutral float-right" title="Executors" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="channel.html" class="btn btn-neutral float-left" title="Channels" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2019, lidanqing

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>